#Dragons (!)
namespace = dragon

# wroth : harder to tame, +duel skill
# patient (obedient) : easier to tame, +duel skill
# slothful (lazy): -martial growth
# gluttonous (ravenous): -duel skill +martial growth
# content (playful): somewhat easier to tame, +dragon egg chance, -duel skill
# lunatic: harder to tame, +duel skill
# trusting (affectionate): easier to tame
# shy: hard to find
# strong: +martial growth, martial +4
# nimble: +duel skill
# fertile: +dragon egg chance

#Events/Decisions to do
##Sickly dragon healing, get maester/healer to help?
##Maester conspiracy to kill dragons
#tie in with above event
#possibly tie in with a new maester society

###Dragon Egg Events###  			dragon.1-
#dragon.599 - Dragon is born maintenance NOTE: (new dragons should always have this event triggered)
###Dragon Rearing Events###			dragon.8-
#dragon.8 - yearly dragon maintenance
###Dragon Lair/Province Events### 	dragon.22-
###Encountered wild escaped dragon###  dragon.26-
###Field of Fire###					dragon.31-
###Siege of fire###					dragon.38-
###Dragon Duels###				dragon.43-
###INTEL###						dragon.60-
###Dragon Conquest CB###			dragon.67-
###Feed to Dragon on execution?###	dragon.71-
###Show me the dragons###			dragon.73-
###AI dragon rider takes to the field###	dragon.74-
###Age of dragons begins###			dragon.76-
###Shadowlands Dragons###			dragon.78
###Storming of Dragon Pit###			dragon.79
###Ruler Designer Dragons###			dragon.82
###Gluttonous Events###		dragon.83
###Dragon nicknames###			dragon.90
###Wounding/maiming###	dragon.91
###Vermax###	dragon.95
###Dany's eggs###  dragon.97


#Canon dragons - game start maintenance
character_event = {
	id = dragon.0

	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		remove_trait = dragon #This ensures the dragon is 'immortal/incapable'
		add_trait = dragon
		if = {
			limit = {
				is_ruler = no
				liege = {
					NOR = {
						graphical_culture = dragongfx
						trait = dragon
					}
				}
			}
			add_trait = incapable_dragon
		}
		else = {
			remove_trait = incapable_dragon
		}
		set_character_flag = no_court_invites
		set_immune_to_pruning = yes
		
		remove_trait = lustful
		remove_trait = chaste
		remove_trait = gluttonous
		remove_trait = temperate
		remove_trait = greedy
		remove_trait = charitable
		remove_trait = slothful
		remove_trait = diligent
		remove_trait = envious
		remove_trait = kind
		remove_trait = wroth
		remove_trait = patient
		remove_trait = proud
		remove_trait = humble
		remove_trait = deceitful
		remove_trait = honest
		remove_trait = craven
		remove_trait = brave
		remove_trait = shy
		remove_trait = gregarious
		remove_trait = ambitious
		remove_trait = content
		remove_trait = arbitrary
		remove_trait = just
		remove_trait = cynical
		remove_trait = zealous
		remove_trait = paranoid
		remove_trait = trusting
		remove_trait = cruel
		remove_trait = authoritative
		remove_trait = rude
		remove_trait = familyperson
		remove_trait = selfish
		remove_trait = stubborn
		remove_trait = ruthless
		remove_trait = honorable
		remove_trait = haughty
		remove_trait = affectionate
		remove_trait = timid
		remove_trait = rowdy
		remove_trait = willful
		remove_trait = brooding
		remove_trait = indolent
		remove_trait = playful
		remove_trait = conscientious
		remove_trait = fussy
		remove_trait = curious
		remove_trait = idolizer
		remove_trait = drunkard
		
		#History whip
		add_artifact = dragons_whip
		new_artifact = { 
			set_name = [Root.GetDragonWhipName]
			ROOT = { save_persistent_event_target = { name = whip scope = PREV } }
			save_event_target_as = new_whip
		}
		random_friend = {
			event_target:new_whip = { transfer_artifact = { from = ROOT to = PREV } }
		}
	}
	
	option = {
		name = OK
	}
}
###Dragon Egg Events###
#Offered egg to buy
character_event = {
	id = dragon.1
	desc = "wanna_buy_egg"

	picture = "GFX_targaryen_eggs" 
	
	prisoner = no
	only_playable = yes
	capable_only = yes
	min_age = 16
	in_command = no
	is_sick = no
	
	trigger = {
		demesne_size = 1
		NOT = { has_global_flag = dragon_egg_3 }
		NOT = { trait = nightswatch } 
		NOT = { primary_title = { title = d_kingsguard } }
		OR = {
			wealth = 800
			AND = { #Ai may take a loan if rich enough
				ai = yes
				war = no
				monthly_income = 20
				wealth = 300
				NOT = { has_character_flag = loan_taken }
				NOT = { has_character_modifier = loan_timer }
				NOT = { has_character_flag = offended_moneylenders }
			}
		}	
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
	}
	
	mean_time_to_happen = {
		months = 75000
		
		modifier = {
			factor = 0.5
			NOT = { has_global_flag = dragon_egg_1 }
		}
		modifier = {
			factor = 1.1
			has_global_flag = dragon_egg_1
		}
		modifier = {
			factor = 1.65
			has_global_flag = dragon_egg_2
		}	
		modifier = {
			factor = 0.8
			has_ambition = obj_obtain_dragon_egg
		}
		modifier = {
			factor = 0.5
			trait = fire_obsessed 
		}
		modifier = {
			factor = 0.9
			trait = just
		}
		modifier = {
			factor = 0.9
			trait = honorable
		}
		modifier = {
			factor = 0.9
			trait = honest
		}
		modifier = {
			factor = 1.25
			trait = arbitrary
		}
		modifier = {
			factor = 1.25
			trait = ruthless
		}
		modifier = {
			factor = 1.25
			trait = deceitful
		}
		modifier = {
			factor = 0.25
			location = { 
				province_id = 795 # Asshai 
			}
		}
	}
	
	option = {
		name = "buy_the_egg" # buy egg
		ai_chance = {
			factor = 100
		}	
		if = {
			limit = { #Ai may take a loan if rich enough
				ai = yes
				war = no
				monthly_income = 20
				wealth = 300
				NOT = { has_character_flag = loan_taken }
				NOT = { has_character_modifier = loan_timer }
				NOT = { has_character_flag = offended_moneylenders }
			}
			set_variable = { which = "loan_amount" value = 800 }
			add_character_modifier = {
				name = "loan_timer"
				duration = 1825
			}
			set_character_flag = loan_taken
			set_character_flag = loan_amount_found
			character_event = { id = bankruptcy.1 }
		}
		add_artifact = dragon_egg
		new_artifact = { set_artifact_flag = heirloom_@PREV }
		wealth = -800
		hidden_tooltip = {
			if = {
				limit = { ai = no }
				chronicle = {
					entry = CHRONICLE_BOUGHT_DRAGON_EGG
					picture = "GFX_targaryen_eggs" 
				}
			}
			any_playable_ruler = {
				limit = { 
					ai = no 
					NOT = { character = ROOT }
					OR = {
						dynasty = ROOT
						is_close_relative = ROOT
						same_realm = ROOT
					}
				}
				character_event = { id = dragon.2 }
			}
		}
		if = {
			limit = { has_global_flag = dragon_egg_2 }
			clr_global_flag = dragon_egg_2
			set_global_flag = dragon_egg_3
		}
		if = {
			limit = { has_global_flag = dragon_egg_1 }
			clr_global_flag = dragon_egg_1
			set_global_flag = dragon_egg_2
		}
		if = {
			limit = {
				NOT = { has_global_flag = dragon_egg_1 }
				NOT = { has_global_flag = dragon_egg_2 }
				NOT = { has_global_flag = dragon_egg_3 }
			}
			set_global_flag = dragon_egg_1
		}		
	}
	
	option = {
		name = "no_thanks" # Nope
		ai_chance = {
			factor = 0.1
		}
	}	
}
#Inform World of Egg Purchase
character_event = {
	id = dragon.2
	desc = "EVTDESCdragon.2"
	
	is_triggered_only = yes
	picture = "GFX_targaryen_eggs" 
	
	option = {
		name = "EVTOPTdragon.2"	
		chronicle = {
			entry = CHRONICLE_BOUGHT_DRAGON_EGG_FROM
			portrait = [From.GetID]
		}
	}
}
#Are you sure you wanna hatch? (triggered from dragon_decisions)
character_event = {
	id = dragon.3
	desc = "EVTDESCdragon.3"
	is_triggered_only = yes
	picture = "GFX_targaryen_eggs"
	
	trigger = {
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
	}
	
	immediate = { 
		#randomly add intel to AI
		if = {
			limit = { ai = yes }
			if = {
				limit = {
					OR = {
						has_character_modifier = went_on_foreign_tour
						trait = viking
						trait = ravager
						trait = seaking
						trait = sea_queen
						AND = {
							trait = ambitious
							OR = {
								is_ruler = yes
								martial = 15
								diplomacy = 15
								wealth = 200
							}
						}
					}
				}
				set_character_flag = dragon_egg_adventurer #increases probability of intel
			}
			if = {
				limit = {
					NOT = { has_character_flag = dragon_intel_dragonpit }
					b_red_keep = { 
						has_building = ca_dragon_pit 
						holder_scope = {
							OR = {
								character = ROOT
								dynasty = ROOT
								is_close_relative = ROOT
								same_realm = ROOT
								AND = {
									ROOT = { has_character_flag = dragon_egg_adventurer }
									is_within_diplo_range = ROOT
								}
							}
						}
					}
				}
				random = {
					chance = 5
					modifier = {
						factor = 2.5
						b_red_keep = { 
							holder_scope = {
								OR = {
									character = ROOT
									dynasty = ROOT
									is_close_relative = ROOT
								}
							}
						}
					}
					modifier = {
						factor = 2
						b_red_keep = { 
							holder_scope = {
								same_realm = ROOT
							}
						}
					}
					modifier = {
						factor = 2
						has_character_flag = dragon_egg_adventurer
					}
					modifier = {
						factor = 2
						trait = ambitious
					}
					modifier = {
						factor = 0.5
						trait = content
					}
					modifier = {
						factor = 2
						trait = diligent
					}
					modifier = {
						factor = 0.5
						trait = slothful
					}
					set_character_flag = dragon_intel_dragonpit
				}
			}
			if = {
				limit = {
					NOT = { has_character_flag = dragon_intel_dragonstone }
					c_dragonstone = { 
						holder_scope = {
							OR = {
								character = ROOT
								dynasty = ROOT
								is_close_relative = ROOT
								same_realm = ROOT
								AND = {
									ROOT = { has_character_flag = dragon_egg_adventurer }
									is_within_diplo_range = ROOT
								}
							}
						}
					}
				}
				random = {
					chance = 5
					modifier = {
						factor = 2.5
						c_dragonstone = {  
							holder_scope = {
								OR = {
									character = ROOT
									dynasty = ROOT
									is_close_relative = ROOT
								}
							}
						}
					}
					modifier = {
						factor = 2
						c_dragonstone = {  
							holder_scope = {
								same_realm = ROOT
							}
						}
					}
					modifier = {
						factor = 2
						has_character_flag = dragon_egg_adventurer
					}
					modifier = {
						factor = 2
						trait = ambitious
					}
					modifier = {
						factor = 0.5
						trait = content
					}
					modifier = {
						factor = 2
						trait = diligent
					}
					modifier = {
						factor = 0.5
						trait = slothful
					}
					set_character_flag = dragon_intel_dragonstone
				}
			}
			if = {
				limit = {
					NOT = { has_character_flag = dragon_intel_citadel }
					c_oldtown = { 
						holder_scope = {
							OR = {
								character = ROOT
								dynasty = ROOT
								is_close_relative = ROOT
								same_realm = ROOT
								AND = {
									ROOT = { has_character_flag = dragon_egg_adventurer }
									is_within_diplo_range = ROOT
								}
							}
						}
					}
				}
				random = {
					chance = 5
					modifier = {
						factor = 2.5
						c_oldtown = {   
							holder_scope = {
								OR = {
									character = ROOT
									dynasty = ROOT
									is_close_relative = ROOT
								}
							}
						}
					}
					modifier = {
						factor = 2
						c_oldtown = {  
							holder_scope = {
								same_realm = ROOT
							}
						}
					}
					modifier = {
						factor = 2
						has_character_flag = dragon_egg_adventurer
					}
					modifier = {
						factor = 2
						trait = ambitious
					}
					modifier = {
						factor = 0.5
						trait = content
					}
					modifier = {
						factor = 2
						trait = diligent
					}
					modifier = {
						factor = 0.5
						trait = slothful
					}
					set_character_flag = dragon_intel_citadel
				}
			}
			if = {
				limit = {
					NOT = { has_character_flag = dragon_intel_fof }
					start_date = 8000.1.1
					c_bramsfort = { 
						holder_scope = {
							OR = {
								character = ROOT
								dynasty = ROOT
								is_close_relative = ROOT
								same_realm = ROOT
								AND = {
									ROOT = { has_character_flag = dragon_egg_adventurer }
									is_within_diplo_range = ROOT
								}
							}
						}
					}
				}
				random = {
					chance = 5
					modifier = {
						factor = 2.5
						c_bramsfort = {   
							holder_scope = {
								OR = {
									character = ROOT
									dynasty = ROOT
									is_close_relative = ROOT
								}
							}
						}
					}
					modifier = {
						factor = 2
						c_bramsfort = {  
							holder_scope = {
								same_realm = ROOT
							}
						}
					}
					modifier = {
						factor = 2
						has_character_flag = dragon_egg_adventurer
					}
					modifier = {
						factor = 2
						trait = ambitious
					}
					modifier = {
						factor = 0.5
						trait = content
					}
					modifier = {
						factor = 2
						trait = diligent
					}
					modifier = {
						factor = 0.5
						trait = slothful
					}
					set_character_flag = dragon_intel_fof
				}
			}
			if = {
				limit = {
					NOT = { has_character_flag = dragon_intel_harrenhal }
					b_kingharren1 = { has_building = ca_harrenhal_ruins }
					c_harrenhal = { 
						holder_scope = {
							OR = {
								character = ROOT
								dynasty = ROOT
								is_close_relative = ROOT
								same_realm = ROOT
								AND = {
									ROOT = { has_character_flag = dragon_egg_adventurer }
									is_within_diplo_range = ROOT
								}
							}
						}
					}
				}
				random = {
					chance = 5
					modifier = {
						factor = 2.5
						c_harrenhal = {   
							holder_scope = {
								OR = {
									character = ROOT
									dynasty = ROOT
									is_close_relative = ROOT
								}
							}
						}
					}
					modifier = {
						factor = 2
						c_harrenhal = {  
							holder_scope = {
								same_realm = ROOT
							}
						}
					}
					modifier = {
						factor = 2
						has_character_flag = dragon_egg_adventurer
					}
					modifier = {
						factor = 2
						trait = ambitious
					}
					modifier = {
						factor = 0.5
						trait = content
					}
					modifier = {
						factor = 2
						trait = diligent
					}
					modifier = {
						factor = 0.5
						trait = slothful
					}
					set_character_flag = dragon_intel_harrenhal
				}
			}
			if = {
				limit = {
					NOT = { has_character_flag = dragon_intel_summerhall }
					has_global_flag = summerhall_established
					c_summerhall = { 
						holder_scope = {
							OR = {
								character = ROOT
								dynasty = ROOT
								is_close_relative = ROOT
								same_realm = ROOT
								AND = {
									ROOT = { has_character_flag = dragon_egg_adventurer }
									is_within_diplo_range = ROOT
								}
							}
						}
					}
				}
				random = {
					chance = 5
					modifier = {
						factor = 2.5
						c_summerhall = {   
							holder_scope = {
								OR = {
									character = ROOT
									dynasty = ROOT
									is_close_relative = ROOT
								}
							}
						}
					}
					modifier = {
						factor = 2
						c_summerhall = {  
							holder_scope = {
								same_realm = ROOT
							}
						}
					}
					modifier = {
						factor = 2
						has_character_flag = dragon_egg_adventurer
					}
					modifier = {
						factor = 2
						trait = ambitious
					}
					modifier = {
						factor = 0.5
						trait = content
					}
					modifier = {
						factor = 2
						trait = diligent
					}
					modifier = {
						factor = 0.5
						trait = slothful
					}
					set_character_flag = dragon_intel_summerhall
				}
			}
			if = {
				limit = {
					NOT = { has_character_flag = dragon_intel_old_ghis }
					619 = { 
						owner = {
							OR = {
								character = ROOT
								dynasty = ROOT
								is_close_relative = ROOT
								same_realm = ROOT
								AND = {
									ROOT = { has_character_flag = dragon_egg_adventurer }
									is_within_diplo_range = ROOT
								}
							}
						}
					}
				}
				random = {
					chance = 5
					modifier = {
						factor = 2.5
						619 = { 
							owner = {
								OR = {
									character = ROOT
									dynasty = ROOT
									is_close_relative = ROOT
								}
							}
						}
					}
					modifier = {
						factor = 2
						619 = { 
							owner = {
								same_realm = ROOT
							}
						}
					}
					modifier = {
						factor = 2
						has_character_flag = dragon_egg_adventurer
					}
					modifier = {
						factor = 2
						trait = ambitious
					}
					modifier = {
						factor = 0.5
						trait = content
					}
					modifier = {
						factor = 2
						trait = diligent
					}
					modifier = {
						factor = 0.5
						trait = slothful
					}
					set_character_flag = dragon_intel_old_ghis
				}
			}
			if = {
				limit = {
					NOT = { has_character_flag = dragon_intel_volantis }
					419 = { 
						owner = {
							OR = {
								character = ROOT
								dynasty = ROOT
								is_close_relative = ROOT
								same_realm = ROOT
								AND = {
									ROOT = { has_character_flag = dragon_egg_adventurer }
									is_within_diplo_range = ROOT
								}
							}
						}
					}
				}
				random = {
					chance = 5
					modifier = {
						factor = 2.5
						419 = { 
							owner = {
								OR = {
									character = ROOT
									dynasty = ROOT
									is_close_relative = ROOT
								}
							}
						}
					}
					modifier = {
						factor = 2
						419 = { 
							owner = {
								same_realm = ROOT
							}
						}
					}
					modifier = {
						factor = 2
						has_character_flag = dragon_egg_adventurer
					}
					modifier = {
						factor = 2
						trait = ambitious
					}
					modifier = {
						factor = 0.5
						trait = content
					}
					modifier = {
						factor = 2
						trait = diligent
					}
					modifier = {
						factor = 0.5
						trait = slothful
					}
					set_character_flag = dragon_intel_volantis
				}
			}
			if = {
				limit = {
					NOT = { has_character_flag = dragon_intel_asshai }
					795 = { 
						owner = {
							OR = {
								character = ROOT
								dynasty = ROOT
								is_close_relative = ROOT
								same_realm = ROOT
								AND = {
									ROOT = { has_character_flag = dragon_egg_adventurer }
									is_within_diplo_range = ROOT
								}
							}
						}
					}
				}
				random = {
					chance = 5
					modifier = {
						factor = 2.5
						795 = { 
							owner = {
								OR = {
									character = ROOT
									dynasty = ROOT
									is_close_relative = ROOT
								}
							}
						}
					}
					modifier = {
						factor = 2
						795 = { 
							owner = {
								same_realm = ROOT
							}
						}
					}
					modifier = {
						factor = 2
						has_character_flag = dragon_egg_adventurer
					}
					modifier = {
						factor = 2
						trait = ambitious
					}
					modifier = {
						factor = 0.5
						trait = content
					}
					modifier = {
						factor = 2
						trait = diligent
					}
					modifier = {
						factor = 0.5
						trait = slothful
					}
					set_character_flag = dragon_intel_asshai
				}
			}
			clr_character_flag = dragon_egg_adventurer
		}
		calculate_dragon_preference_effect = yes
	}

	option = {
		name = "EVTOPTAdragon.3" #try hatch
		ai_chance = {
			factor = 1
			
			modifier = {
				factor = 0
				has_character_flag = desires_large_dragon
			}
			modifier = {
				factor = 25
				has_game_rule = { name = dragon_hatching_taming value = easy }
			}
			modifier = {
				factor = 3
				has_game_rule = { name = dragon_hatching_taming value = less_hard }
			}
			modifier = {
				factor = 0.33
				has_game_rule = { name = dragon_hatching_taming value = hard }
			}
			modifier = {
				factor = 4
				has_ambition = obj_tame_a_dragon
			}
			modifier = {
				factor = 3.5
				has_dynasty_flag = dragon_riding_dynasty
			}
			modifier = {
				factor = 3.5
				liege = { is_close_relative = ROOT can_use_dragon_abilities_trigger = yes }
			}
			modifier = {
				factor = 5
				has_dragonpit_trigger = yes
			}
			modifier = {
				factor = 10
				has_global_flag = age_of_dragons
			}
			modifier = {
				factor = 3
				trait = genius
			}
			modifier = {
				factor = 3
				trait = brave
			}
			modifier = {
				factor = 1.5
				is_smart_trigger = yes
			}
			modifier = {
				factor = 3
				trait = lunatic
			}
			modifier = {
				factor = 3
				trait = ambitious
			}
			#intel
				
			modifier = {
				factor = 3.5
				has_character_flag = dragon_intel_citadel
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_harrenhal 
			}
			modifier = {
				factor = 2
				has_character_flag = dragon_intel_dragonstone 
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_dragonpit 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_fof 
			}			
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_summerhall
			}
			modifier = {
				factor = 2
				has_character_flag = dragon_intel_eggs 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_old_ghis
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_volantis
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_smoking_sea
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_asshai
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_dynamic
			}
			modifier = {
				factor = 2
				has_character_flag = dragon_intel_rebirth
			}
			#valyrian modifiers
			modifier = {
				factor = 3.5
				any_owned_bloodline = { has_bloodline_flag = blood_of_the_dragon }	
			}
			modifier = {
				factor = 5
				religion_group = valyrian_rel_group 
			}
			modifier = {
				factor = 2.5
				OR = {			
					culture = high_valyrian 
					graphical_culture = valyriangfx
				}	
			}
			modifier = {
				factor = 2
				OR = {
					culture_group = valyrian
					has_silver_hair_ethnicity_trigger = yes
				}	
			}
			modifier = {
				factor = 1.5
				culture = asshai
			}
			#rhollor path
			modifier = {
				factor = 1.5
				religion = rhllor 
			}
			modifier = {
				factor = 3
				trait = favored_by_rhllor
			}
			modifier = {
				factor = 10
				trait = chosen_by_rhllor
			}
			#Demon Child
			modifier = {
				factor = 20
				has_character_flag = demon_child_non_pagan
			}			
		}
		custom_tooltip = {
			text = TOOLTIPDRAGON.3
		}
		hidden_tooltip = { c_the_citadel = { holder_scope = { character_event = { id = dragon.4 } } } }
		
	}
	option = {
		name = "EVTOPTBdragon.3" #nope
		ai_chance = {
			factor = 100
			modifier = {
				factor = 3
				trait = imbecile
			}
			modifier = {
				factor = 3
				trait = craven
			}
			modifier = {
				factor = 1.5
				is_dumb_trigger = yes
			}
			modifier = {
				factor = 3
				trait = content
			}
		}
	}
}
# Citadel Determine if dragon hatched
character_event = {
	id = dragon.4
	is_triggered_only = yes
	desc = "EVTDESCdragon.4"
	
	# Nobody but the actual referee should ever get this
	trigger = { has_landed_title = c_the_citadel }
	
	#hatched
	option = {
		name = "HATCHED"
		ai_chance = {
			factor = 1
			
			modifier = {
				factor = 25
				has_game_rule = { name = dragon_hatching_taming value = easy }
			}
			modifier = {
				factor = 5
				has_game_rule = { name = dragon_hatching_taming value = less_hard }
			}
			modifier = {
				factor = 0.33
				has_game_rule = { name = dragon_hatching_taming value = hard }
			}
			#Dragons already hatched
			modifier = {
				factor = 3.5
				FROM = { has_dynasty_flag = dragon_riding_dynasty }
			}
			modifier = {
				factor = 3.5
				FROM = { liege = { is_close_relative = FROM can_use_dragon_abilities_trigger = yes } }
			}
			modifier = {
				factor = 10
				has_global_flag = age_of_dragons
			}
			modifier = {
				factor = 5
				FROM = { has_dragonpit_trigger = yes }
			}
			
			modifier = {
				factor = 2
				FROM = {  trait = genius }
			}
			modifier = {
				factor = 1.25
				FROM = {  trait = brave }
			}
			modifier = {
				factor = 1.25
				FROM = {  trait = scholar }
			}
			modifier = {
				factor = 1.25
				FROM = {  is_smart_trigger = yes }
			}
			modifier = {
				factor = 1.25
				FROM = {  trait = mystic }
			}
			#intel
				
			modifier = {
				factor = 3.5
				FROM = {  has_character_flag = dragon_intel_citadel  }
			}
			modifier = {
				factor = 1.5
				FROM = {  has_character_flag = dragon_intel_harrenhal  }
			}
			modifier = {
				factor = 2
				FROM = {  has_character_flag = dragon_intel_dragonstone  }
			}
			modifier = {
				factor = 2.5
				FROM = {  has_character_flag = dragon_intel_dragonpit  }
			}
			modifier = {
				factor = 1.5
				FROM = {  has_character_flag = dragon_intel_fof  }
			}
			modifier = {
				factor = 2.5
				FROM = {  has_character_flag = dragon_intel_summerhall  }
			}
			modifier = {
				factor = 2
				FROM = {  has_character_flag = dragon_intel_eggs  }
			}
			modifier = {
				factor = 1.5
				FROM = { has_character_flag = dragon_intel_old_ghis }
			}
			modifier = {
				factor = 1.5
				FROM = { has_character_flag = dragon_intel_volantis }
			}
			modifier = {
				factor = 2.5
				FROM = { has_character_flag = dragon_intel_smoking_sea }
			}
			modifier = {
				factor = 1.5
				FROM = { has_character_flag = dragon_intel_asshai }
			}
			modifier = {
				factor = 1.5
				FROM = { has_character_flag = dragon_intel_dynamic }
			}
			#valyrian modifiers
			modifier = {
				factor = 3.5
				FROM = {
					any_owned_bloodline = { has_bloodline_flag = blood_of_the_dragon }
				}
			}
			modifier = {
				factor = 5
				FROM = {  religion_group = valyrian_rel_group  }
			}
			modifier = {
				factor = 2.5
				FROM = {  
					OR = {			
						culture = high_valyrian 
						graphical_culture = valyriangfx
					}
				}
			}
			modifier = {
				factor = 2
				FROM = {  
					OR = {
						culture_group = valyrian
						has_silver_hair_ethnicity_trigger = yes
					}
				}
			}
			modifier = {
				factor = 1.5
				FROM = {  culture = asshai  }
			}
			#rhollor path
			modifier = {
				factor = 1.5
				FROM = {  religion = rhllor  }
			}
			modifier = {
				factor = 3
				FROM = {  trait = favored_by_rhllor  }
			}
			modifier = {
				factor = 10
				FROM = {  trait = chosen_by_rhllor  }
			}	
			#Demon Child
			modifier = {
				factor = 20
				has_character_flag = demon_child_non_pagan
			}
			#Books
			modifier = {
				factor = 3
				FROM = { any_artifact = { artifact_type = book_blood_and_fire is_artifact_active = yes } }
			}
			modifier = {
				factor = 1.5
				FROM = { any_artifact = { artifact_type = book_dragons_wyrms_and_wyverns is_artifact_active = yes } }
			}
			modifier = {
				factor = 1.5
				FROM = { any_artifact = { artifact_type = book_fires_of_the_freehold is_artifact_active = yes } }
			}
		}
		FROM = {
			character_event = { id = dragon.5 days = 1 } 
		}
		
	}
	#not hatched
	option = {
		name = "NOT HATCHED"
		ai_chance = {
			factor = 500

			modifier = {
				factor = 1.25
				FROM = {  trait = craven }
			}
			modifier = {
				factor = 1.25
				FROM = {  is_dumb_trigger = yes }
			}
			modifier = {
				factor = 1.25
				FROM = {  trait = slothful  }
			}
			modifier = {
				factor = 1.25
				FROM = {  trait = wroth  }
			}
			
		}
		
		FROM = {
			if = {
				limit = {
					NOT = { 
						has_dynasty_flag = dragon_riding_dynasty	
					}	
				}
				set_character_flag = remove_egg
				random = {
					chance = 50
					set_character_flag = kill_son
				}	
				random = {
					chance = 50
					set_character_flag = kill_daughter
				}	
				random = {
					chance = 50
					set_character_flag = kill_wife
				}	
				random = {
					chance = 50
					set_character_flag = kill_self				
				}
				random = {
					chance = 50
					set_character_flag = kill_bodyguard
				}	
				random = {
					chance = 75
					set_character_flag = kill_province				
				}
			}	
			character_event = { id = dragon.6 days = 1} 
		}
	}
}
#hatched dragon
character_event = {
	id = dragon.5
	desc = "EVTDESCdragon.5"
	picture = "GFX_targaryen_hatching"
	
	is_triggered_only = yes
	hide_from = yes

	prisoner = no
	capable_only = yes
	
	immediate = {
		if = {
			limit = { 
				NOT = {
					any_artifact = {
						artifact_type = dragon_egg
						has_artifact_flag = dany_dragon_eggs
					}
				}	
			}
			random_list = {
				50 = {
					create_character = {
						dynasty = none
						age = 0
						culture = dragon_culture
						religion = dragon_rel
						historical = yes
					}
				}
				50 = {
					create_character = {
						female = yes
						dynasty = none
						age = 0
						culture = dragon_culture
						religion = dragon_rel
						historical = yes
					}
				}
			}
			new_character = {
				add_friend = ROOT
				add_trait = dragon
				add_trait = incapable_dragon
				character_event = { id = dragon.599 }
				random = {
					chance = 5
					add_trait = fair_dragon
				}
				random = {
					chance = 5
					if = {
						limit = { NOT = { trait = fair_dragon } }
						add_trait = ugly_dragon
					}	
				}
				if = {
					limit = {
						ROOT = { 
							has_dragonpit_trigger = yes	
						} 
					}
					add_character_modifier = { name = locked_in_dragonpit duration = -1 }
					random = {
						chance = 8
						add_trait = sickly_dragon
					}
					if = {
						limit = { NOT = { trait = sickly_dragon } }
						random = {
							chance = 2
							add_trait = strong_dragon
						}
						random = {
							chance = 15
							add_trait = fertile_dragon
						}
					}
				}
				if = {
					limit = {
						NOT = { has_character_modifier = locked_in_dragonpit }
					}
					random = {
						chance = 2
						add_trait = sickly_dragon
					}
					if = {
						limit = { NOT = { trait = sickly_dragon } }
						random = {
							chance = 5
							add_trait = strong_dragon
						}
						random = {
							chance = 15
							add_trait = fertile_dragon
						}
					}
				}
				random = {
					chance = 33
					add_trait = nimble_dragon
				}
				random_list = {
					1 = { add_trait = dragon_1 }
					1 = { add_trait = dragon_2 }
					1 = { add_trait = dragon_3 }
					1 = { add_trait = dragon_4 }
					1 = { add_trait = dragon_5 }
					1 = { add_trait = dragon_6 }
					1 = { add_trait = dragon_7 }
					1 = { add_trait = dragon_8 }
					1 = { add_trait = dragon_9 }
					1 = { add_trait = dragon_10 }
					1 = { add_trait = dragon_11 }
					1 = { add_trait = dragon_12 }
					1 = { add_trait = dragon_13 }
					1 = { add_trait = dragon_14 }
					1 = { add_trait = dragon_15 }
					1 = { add_trait = dragon_16 }
					1 = { add_trait = dragon_17 }
					1 = { add_trait = dragon_18 }
					1 = { add_trait = dragon_19 }
					1 = { add_trait = dragon_20 }
					1 = { add_trait = dragon_21 }
					1 = { add_trait = dragon_22 }
					1 = { add_trait = dragon_23 }
					1 = { add_trait = dragon_24 }
					1 = { add_trait = dragon_25 }
					1 = { add_trait = dragon_26 }
					1 = { #Balerion
						modifier = {
							factor = 0.05
						}
						add_trait = dragon_27 
					}
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTdragon.5"	
		trigger = { 
			NOT = { 
				any_artifact = {
					artifact_type = dragon_egg
					has_artifact_flag = dany_dragon_eggs
				}
			}
		}
		hidden_tooltip = {
			if = {
				limit = { 
					NOT = { any_province = { has_province_flag = dragon_intel_rebirth } }
					NOT = { dragon = { is_alive = yes NOT = { has_character_flag = shadow_lands_dragon } } }
				}
				location = {
					set_province_flag = dragon_intel_rebirth
				}
			}
		}
		custom_tooltip = { text = TOOLTIPdragon.5RENAMEINFO }
		random_friend = {
			limit = { trait = dragon }
			tooltip = { show_portrait = yes }
		}
		if = {
			limit = {
				OR = {
					has_global_flag = age_of_dragons
					any_close_relative = { is_alive = yes can_use_dragon_abilities_trigger = yes }
				}	
			}
			prestige = 200
		}
		if = {
			limit = {
				NOT = { has_global_flag = age_of_dragons }
				NOT = { any_close_relative = { is_alive = yes can_use_dragon_abilities_trigger = yes } }
			}
			prestige = 1000				
		}
		if = {
			limit = { 
				NOT = { trait = ambitious } 
				OR = {	
					dynasty = 0
					NOT = { any_close_relative = { is_alive = yes can_use_dragon_abilities_trigger = yes } }
				}	
			}
			random = {
				chance = 50
				modifier = {
					factor = 0.2
					trait = content
				}
				hidden_tooltip = { remove_trait = content }
				add_trait = ambitious
				hidden_tooltip = {
					character_event = {
						id = 38278 #Notify Ambitious
					}
				}
			}	
		}	
		set_character_flag = dragon_intel_eggs	
	}	
	option = {
		name = "EVTOPTdragon.5DANY"	#Dany's special hatching
		trigger = { 
			any_artifact = {
				artifact_type = dragon_egg
				has_artifact_flag = dany_dragon_eggs
			}
		}
		custom_tooltip = { text = TOOLTIPdragon.5RENAMEINFO }
		hidden_tooltip = { #common dragon ancestor
			c_77990029 = {
				if = {
					limit = { ROOT = { NOT = { dynasty = 496 } } }
					dynasty = father_bastard
				}
				save_event_target_as = dragon_father
			}
		}
		if = {
			limit = { character = 77041 }
			create_character = {
				name = Дрогон
				age = 0
				culture = dragon_culture
				religion = dragon_rel
				trait = strong_dragon
				trait = dragon_1
				historical = yes
			}
		}	
		if = {
			limit = { NOT = { character = 77041 } }
			create_character = {
				age = 0
				culture = dragon_culture
				religion = dragon_rel
				trait = strong_dragon
				trait = dragon_1
				historical = yes
			}
		}
		new_character = {
			add_friend = ROOT
			set_mother = ROOT
			add_trait = dragon
			add_trait = incapable_dragon
			dynasty = event_target:dragon_father
			set_father = event_target:dragon_father
			character_event = { id = dragon.599 }	
		}
		if = {
			limit = { character = 77041 }
			create_character = {
				name = Рейгаль
				age = 0
				culture = dragon_culture
				religion = dragon_rel
				trait = dragon_2
				historical = yes
			}
		}	
		if = {
			limit = { NOT = { character = 77041 } }
			create_character = {
				age = 0
				culture = dragon_culture
				religion = dragon_rel
				trait = dragon_2
				historical = yes
			}
		}		
		new_character = {
			set_mother = ROOT
			add_trait = dragon
			add_trait = incapable_dragon
			dynasty = event_target:dragon_father
			set_father = event_target:dragon_father
			character_event = { id = dragon.599 }	
		}
		if = {
			limit = { character = 77041 }
			create_character = {
				name = Визерион
				age = 0
				culture = dragon_culture
				religion = dragon_rel
				trait = dragon_3
				historical = yes
			}
		}	
		if = {
			limit = { NOT = { character = 77041 } }
			create_character = {
				age = 0
				culture = dragon_culture
				religion = dragon_rel
				trait = dragon_3
				historical = yes
			}
		}		
		new_character = {
			set_mother = ROOT
			add_trait = dragon
			add_trait = incapable_dragon
			dynasty = event_target:dragon_father
			set_father = event_target:dragon_father
			character_event = { id = dragon.599 }	
		}
		if = {
			limit = {
				has_dynasty_flag = dragon_riding_dynasty
			}
			prestige = 250
		}
		if = {
			limit = {
				NOT = { has_dynasty_flag = dragon_riding_dynasty }
			}
			prestige = 1000
			random = {
				chance = 50
				hidden_tooltip = { remove_trait = content }
				add_trait = ambitious
				hidden_tooltip = {
					character_event = {
						id = 38278 #Notify Ambitious
					}
				}
			}	
		}
		hidden_tooltip = {
			random_artifact = {
				limit = {
					artifact_type = dragon_egg
					has_artifact_flag = dany_dragon_eggs
				}
				unsafe_destroy_artifact = yes
			}
		}	
		set_character_flag = dragon_intel_eggs	
	}		
}
#New dragon born, set mother and other stuff (new dragons should always have this event triggered)
character_event = { 
	id = dragon.599

	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		clear_event_target = hatched_dragon_egg
		if = {
			limit = {
				NOR = {
					father_even_if_dead = { always = yes }
					mother_even_if_dead = { always = yes }
				}
			}
			FROM = {
				random_artifact = {
					limit = { artifact_type = dragon_egg }
					save_event_target_as = hatched_dragon_egg
				}
			}
			dragon = {
				limit = { event_target:hatched_dragon_egg = { has_artifact_flag = dragon_egg_mother_@PREV } }
				if = {
					limit = { is_female = yes }
					ROOT = { 
						set_mother = PREV 
						dynasty = PREV
					}
				}
				if = {
					limit = { is_female = no }
					ROOT = { 
						set_father = PREV 
						dynasty = PREV
					}
				}
				if = { #maester conspiracy
					limit = { has_character_modifier = mnm_effected }
					ROOT = { add_trait = sickly }
				}
			}
			dragon = {
				limit = { event_target:hatched_dragon_egg = { has_artifact_flag = dragon_egg_father_@PREV } }
				if = {
					limit = { is_female = yes }
					ROOT = { 
						set_mother = PREV 
					}
				}
				if = {
					limit = { is_female = no }
					ROOT = { 
						set_father = PREV 
						dynasty = PREV
					}
				}	
				if = { #maester conspiracy
					limit = { has_character_modifier = mnm_effected }
					ROOT = { add_trait = sickly }
				}
			}
			event_target:hatched_dragon_egg = { unsafe_destroy_artifact = yes }
		}
		set_immune_to_pruning = yes
		set_character_flag = no_court_invites
		if = {
			limit = { dynasty = 0 }
			dynasty = mother_bastard
		}
		FROM = {
			if = {
				limit = { ai = no }
				ROOT = {
					character_event = { id = dragon.598 days = 2 } #delay chronicle to allow for renaming
					prompt_name = { #player can also rename
						player = PREV
						type = NAME_DRAGON_MESSAGE
						culture = dragon_culture
					}
				}
			}
		}
		set_focus = focus_ch_dragon
		#History tracking artifact
		if = {
			limit = { 
				NOT = { character = FROM } 
				FROM = { NOT = { trait = dragon } }
			}
			if = {
				limit = { 
					any_artifact = { artifact_type = dragons_whip } 	
				}
				random_artifact = { 
					limit = { artifact_type = dragons_whip }
					transfer_artifact = { from = ROOT to = FROM }
				}
			}
			else = {
				FROM = {
					add_artifact = dragons_whip
					new_artifact = { 
						set_name = [Root.GetDragonWhipName]
						ROOT = { save_persistent_event_target = { name = whip scope = PREV } }
					}
				}
			}
		}	
	}
	
	option = {
		name = OK
		any_player = {
			limit = { 
				NOT = { character = FROM }
			}
			character_event = { id = dragon.7 days = 1 }
			character_event = { id = dragon.799 days = 1 }			
		}
	}
}	
character_event = { #chronicle entry
	id = dragon.598
	
	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		FROMFROM = {
			chronicle = {
				entry = CHRONICLE_HATCHED_DRAGON
				portrait = [Root.GetID]
			}
		}
	}
	
	option = {
		name = OK
	}
}	
#dragon failed to hatch
character_event = {
	id = dragon.6
	title = "EVTNAMEdragon.6"
	desc = "EVTDESCdragon.6"
	picture = "GFX_evt_dragon_flame_death"
	
	is_triggered_only = yes
	
	hide_from = yes
	
	immediate = {
		if = {
			limit = { has_character_flag = remove_egg }
			random_artifact = {
				limit = { artifact_type = dragon_egg }
				unsafe_destroy_artifact = yes
			}
		}	
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_HATCHED_DRAGON_FAIL
				portrait = [Root.GetID]
			}
		}
		any_playable_ruler = { #inform world
			limit = { 
				ai = no
				OR = {
					same_realm = ROOT
					dynasty = ROOT
					is_close_relative = ROOT
				}
			}
			character_event = { id = dragon.798 days = 1 }
		}
	}
	
	option = {
		name = "EVTOPTAdragon.6"
		if = {
			limit = {
				NOT = { has_character_flag = remove_egg } #not already removed above
			}
			random = {
				chance = 25
				random_artifact = {
					limit = { artifact_type = dragon_egg }
					unsafe_destroy_artifact = yes
				}
			}
		}
		if = {
			limit = {
				has_character_flag = kill_son
			}
			random_child = {
				limit = { 	
					is_female = no
					age = 14
					at_location = ROOT
					ai = yes
				}
				red_god_resurrect_effect = yes #check for rhllor resurrection
				if = {
					limit = {
						ROOT = { 
							is_any_kinslayer_trigger = no 
							NOT = { trait = suspected_kinslayer }
							NOT = { has_cutthroat_religion_trigger = yes }
						}					
					}
					ROOT = { add_trait = suspected_kinslayer }
				}
				death = { 
					death_reason = death_accident_dragon_hatching 
					killer = ROOT
				}
			}		
		}
		if = {
			limit = {
				has_character_flag = kill_daughter
			}
			random_child = {
				limit = { 	
					is_female = yes
					age = 14
					at_location = ROOT
					ai = yes
				}			
				red_god_resurrect_effect = yes #check for rhllor resurrection
				if = {
					limit = {
						ROOT = { 
							is_any_kinslayer_trigger = no 
							NOT = { trait = suspected_kinslayer }
							NOT = { has_cutthroat_religion_trigger = yes }
						}					
					}
					ROOT = { add_trait = suspected_kinslayer }
				}
				death = { 
					death_reason = death_accident_dragon_hatching 
					killer = ROOT
				}
			}
		}
		if = {
			limit = {
				has_character_flag = kill_wife
				spouse = { 
					at_location = ROOT
					ai = yes 
				}
			}
			spouse = {
				red_god_resurrect_effect = yes #check for rhllor resurrection
				if = {
					limit = {
						is_blood_relative_of_root_trigger = yes
						ROOT = { 
							is_any_kinslayer_trigger = no 
							NOT = { trait = suspected_kinslayer }
							NOT = { has_cutthroat_religion_trigger = yes }
						}					
					}
					ROOT = { add_trait = suspected_kinslayer }
				}
				death = { 
					death_reason = death_accident_dragon_hatching 
					killer = ROOT
				}
			}
		}
		if = {
			limit = {
				has_character_flag = kill_bodyguard				
			}
			if = {
				limit = { has_landed_title = e_iron_throne }
				kingsguard = {
					limit = { is_alive = yes }
					red_god_resurrect_effect = yes #check for rhllor resurrection
					if = {
						limit = {
							is_blood_relative_of_root_trigger = yes
							ROOT = { 
								is_any_kinslayer_trigger = no 
								NOT = { trait = suspected_kinslayer }
								NOT = { has_cutthroat_religion_trigger = yes }
							}					
						}
						ROOT = { add_trait = suspected_kinslayer }
					}
					death = { 
						death_reason = death_accident_dragon_hatching 
						killer = ROOT
					}
				}
			}
			if = {
				limit = { is_ruler = yes }
				random_courtier = {
					limit = { 
						liege = { character = ROOT } 
						has_minor_title = title_bodyguard
					}
					red_god_resurrect_effect = yes #check for rhllor resurrection
					if = {
						limit = {
							is_blood_relative_of_root_trigger = yes
							ROOT = { 
								is_any_kinslayer_trigger = no 
								NOT = { trait = suspected_kinslayer }
								NOT = { has_cutthroat_religion_trigger = yes }
							}					
						}
						ROOT = { add_trait = suspected_kinslayer }
					}
					death = { 
						death_reason = death_accident_dragon_hatching 
						killer = ROOT
					}
				}
			}
		}
		if = {
			limit = {
				has_character_flag = kill_province
			}
			capital_scope = { province_event = { id = dragon.25 } }
		}
		if = {
			limit = {
				has_character_flag = kill_self
			}
			random_list = {
				20 = {
					hidden_tooltip = {
						red_god_resurrect_effect = yes #check for rhllor resurrection
					}
					death = { death_reason = death_accident_dragon_hatching }			
				}
				50 = {
					add_trait = depressed
					hidden_tooltip = {
						character_event ={
							id = 38288 #Notify
						}
					}
				}
				15 = {
					add_maimed_trait_effect = yes
				}
				15 = {
					trigger = { NOT = { trait = burned } }
					add_trait = burned
					hidden_tooltip = { character_event = { id = trait_notification.23 } }					
				}
			}	
		}		
		clr_character_flag = kill_son
		clr_character_flag = kill_daughter
		clr_character_flag = kill_wife
		clr_character_flag = kill_self
		clr_character_flag = kill_province
		clr_character_flag = kill_bodyguard
		clr_character_flag = tried_hatch	
	}
	after = { clr_character_flag = remove_egg }
}
#dragon hatched  world notfication
character_event = {
	id = dragon.7
	desc = "EVTDESCdragon.7"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_global_flag = age_of_dragons }
		FROM = { any_friend = { always = yes } }
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { character = FROMFROM }
			}
			chronicle = {
				entry = CHRONICLE_HATCHED_DRAGON_FROM_A
				portrait = [FromFrom.GetID]
			}
		}
	}
	
	option = {
		name = "EVTOPTAdragon.7"	
	}
}
character_event = {
	id = dragon.799
	picture = "GFX_valyria_dragon"
	
	desc = {
		text = "EVTDESCdragon.799"
		trigger = { NOT = { FROM = { trait = sickly_dragon } } }
	}	
	desc = {
		text = "EVTDESCdragon.799B"
		trigger = { FROM = { trait = sickly_dragon } }
	}	
	
	is_triggered_only = yes
	has_global_flag = age_of_dragons
	
	trigger = {		
		NOT = { has_character_flag = no_dragon_hatching_inform }
		had_global_flag = { flag = scenario_initialised days = 2 }
		FROM = { any_friend = { always = yes } }
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { character = FROMFROM }
				OR = {		
					dynasty = FROMFROM
					is_liege_or_above = FROMFROM
					is_close_relative = FROMFROM
					is_vassal_or_below = FROMFROM
				}
			}
			chronicle = {
				entry = CHRONICLE_HATCHED_DRAGON_FROM
				portrait = [FromFrom.GetID]
			}
		}
	}
	
	option = {
		name = {
			text = "EVTOPTAdragon.799"	
			trigger = {
				NAND = {
					FROM = { trait = sickly_dragon }
					is_close_relative = FROMFROM
				}	
			}
		}	
		name = {
			text = "EVTOPTBdragon.799" #bad omen
			trigger = {
				FROM = { trait = sickly_dragon }
				is_close_relative = FROMFROM
			}
		}
	}	
	option = {
		name = "EVTOPTBdragon.1198"	
		set_character_flag = no_dragon_hatching_inform
	}	
}
#Inform world FROM failed in hatching dragons
character_event = {
	id = dragon.798
	picture = "GFX_evt_dragon_flame_death" 
	
	is_triggered_only = yes	
	
	trigger = {
		OR = {
			FROM = { is_alive = no }
			FROM = { NOT = { has_artifact = dragon_egg } }
			dynasty = FROM
			is_close_relative = FROM
		}
		NOT = { has_character_flag = no_dragon_hatching_fail_inform }
	}
	
	desc = {
		text = EVTDESCdragon.798
		trigger = { FROM = { is_alive = no } }		
	}
	desc = {
		text = EVTDESCdragon.798B
		trigger = { 
			FROM = { 
				is_alive = yes 
				NOT = { has_artifact = dragon_egg }
			} 
		}		
	}
	desc = {
		text = EVTDESCdragon.798C
		trigger = { 
			FROM = { 
				is_alive = yes 
				has_artifact = dragon_egg
			} 
		}		
	}
	
	immediate = {
		if = {
			limit = {
				OR = {
					is_close_relative = FROM
					vassal_of = FROM
				}
			}
			chronicle = {
				entry = CHRONICLE_HATCHED_DRAGON_FAIL_FROM
				portrait = [From.GetID]
			}
		}
	}
	
	option = {
		name = "EVTOPTAdragon.798"  #idiot			
	}
	option = { #bad omen
		name = "EVTOPTBdragon.799"	
		trigger = {
			is_close_relative = FROM
			has_global_flag = age_of_dragons
		}
	}
	option = {
		name = "EVTOPTBdragon.1198"	
		set_character_flag = no_dragon_hatching_fail_inform
	}	
}
##Dragon Rearing Events###
#Yearly Dragon Growth/Maintenance
character_event = {
	id = dragon.8
	desc = "EVTDESCdragon.8"
	picture = "GFX_targaryen_balerion" 
	
	is_triggered_only = yes
	hide_window = yes
	
	trigger = {
		OR = {	
			AND = {
				trait = dragon
				culture = dragon_culture
			}	
			graphical_culture = dragongfx
		}	
	}
	
	immediate = {
		remove_trait = dragon #This ensures the dragon is 'immortal'
		add_trait = dragon
		
		#make sure the dragon has a parent to stop random culling #TENP vanilla bug workaround
		if = {
			limit = { 
				NOT = { father_even_if_dead = { always = yes } }
				NOT = { mother_even_if_dead = { always = yes } }
			}		
			create_character = {
				name = "Неизвестный дракон"
				culture = dragon_culture
				religion = dragon_rel
				dynasty = actually_culture
				age = 30				
				female = yes
			}
			new_character = {
				add_trait = dragon
				add_trait = incapable_dragon
				ROOT = { 
					set_mother = PREV 	
					if = {
						limit = { dynasty = 0 }
						dynasty = PREV
					}	
				}	
				dynasty = none
				death = yes
			}
		}
				
		#Remove wrong traits
		remove_trait = stressed
		remove_trait = depressed
		remove_trait = possessed
		remove_trait = lustful
		remove_trait = chaste
		remove_trait = temperate
		remove_trait = greedy
		remove_trait = charitable
		remove_trait = diligent
		remove_trait = envious
		remove_trait = kind
		remove_trait = deceitful
		remove_trait = honest
		remove_trait = craven
		remove_trait = brave
		remove_trait = gregarious
		remove_trait = ambitious
		remove_trait = arbitrary
		remove_trait = just
		remove_trait = cynical
		remove_trait = zealous
		remove_trait = paranoid
		remove_trait = cruel
		remove_trait = authoritative
		remove_trait = rude
		remove_trait = ruthless
		remove_trait = selfish
		remove_trait = stubborn	
		remove_trait = erudite
		remove_trait = affectionate
		remove_trait = timid
		remove_trait = rowdy
		remove_trait = willful
		remove_trait = brooding
		remove_trait = indolent
		remove_trait = playful
		remove_trait = conscientious
		remove_trait = fussy
		remove_trait = curious
		remove_trait = idolizer
		remove_trait = humble
		remove_trait = proud
		remove_trait = wroth
		remove_trait = patient
		remove_trait = slothful
		remove_trait = gluttonous
		remove_trait = content
		remove_trait = trusting
		remove_trait = shy
		remove_trait = lunatic
		remove_trait = drunkard
		
		#remove surperfulous friends
		any_friend = {
			limit = { graphical_culture = dragongfx }
			remove_friend = ROOT
		}
		while = {
			limit = { num_of_friends = 2 }
			count = 30
			random_friend = {
				preferred_limit = {
					NOT = { can_use_dragon_abilities_trigger = yes }
				}				
				remove_friend = ROOT
			}
		}
		
		if = {
			limit = {
				NOR = {
					has_alternate_start_parameter = { key = special_culture value = mythological } 
					has_alternate_start_parameter = { key = special_culture value = all } 
				}
			}
			if = { #kill if dragons disabled
				limit = { 
					has_game_rule = { name = dragon_hatching_taming value = off } 
				}
				death = yes
			}
			set_character_flag = no_court_invites
		
			religion = dragon_rel
			
				
			if = {
				limit = { prisoner = yes }
				prisoner = no
			}
			
			clear_wealth = yes
		}	
		if = {
			limit = { is_ill = yes }
			heal_basic_effect = yes
		}		
		if = { 
			limit = { 
				age = 14
				NOT = { age = 16 }
			}
			add_trait = misguided_warrior
		}		
		if = {  #wound heal
			limit = { trait = wounded_dragon }
			random = {
				chance = 50
				remove_trait = wounded_dragon			
				any_friend = { 
					limit = { NOT = { graphical_culture = dragongfx } }
					character_event = { id = dragon.899 } 
				}
			}
		}
		if = {  #maim heal
			limit = { trait = maimed_dragon }
			random = {
				chance = 15
				remove_trait = maimed_dragon
				add_trait = wounded_dragon
				any_friend = { 
					limit = { NOT = { graphical_culture = dragongfx } }
					character_event = { id = dragon.898 } 
				}
			}
		}	
		if = {
			limit = {
				is_ruler = no
				liege = {
					NOR = {
						graphical_culture = dragongfx
						trait = dragon
					}
				}
			}
			add_trait = incapable_dragon
		}
		else = {
			remove_trait = incapable_dragon
		}
		if = {
			limit = {
				NOR = {
					has_alternate_start_parameter = { key = special_culture value = mythological } 
					has_alternate_start_parameter = { key = special_culture value = all } 
				}
			}
			if = { #remove baronies
				limit = { 
					demesne_size = 1	
					NOT = { liege = { character = ROOT } }
				}
				liege = {
					ROOT = { any_demesne_title = { gain_title = PREVPREV } }
				}
			}
			if = {
				limit = { 
					is_ruler = yes
				}
				if = {
					limit = { current_heir = { NOT = { trait = dragon } } }
					abdicate = yes
				}
				else = {
					random_character = {
						limit = {
							is_unimportant_trigger = yes
							is_ruler = no
							is_adult = yes
							prisoner = no
							is_incapable = no
							NOT_mythical_creature_trigger = yes
							is_inaccessible_trigger = no
						}
						ROOT = { abdicate_to = PREV }
					}
				}
			}	
		}	
			
		if = {
			limit = { is_ruler = no }
			random_friend = { #make sure it is in same court as rider
				limit = { 			
					is_alive = yes
					NOT = { any_courtier = { character = ROOT } }
					NOT = { same_liege = ROOT }
					NOT = { is_liege_of = ROOT }
					NOT = { trait = slave } #not if in captivity
					NAND = {
						is_consort = yes
						consort = { reverse_has_opinion_modifier = { who = PREV modifier = opinion_forced_consort } } 
					}
				}
				if = {
					limit = { is_ruler = yes }
					ROOT = { move_character = PREV }
				}
				else = {
					liege = { ROOT = { move_character = PREV } }
				}
				clr_character_flag = has_dragon_location 
				random_province = {
					limit = { ROOT = { has_character_flag = dragon_location_@PREV } }
					ROOT = { clr_character_flag = dragon_location_@PREV }
				}
			}
			if = { #if wild and in ANY_ALL move to a random volcano
				limit = {
					NOT = { any_friend = { is_alive = yes } }
					NOT = { liege = { demesne_size = 1 } }
					NOT = { liege = { is_friend = ROOT } }
					NOT = { liege = { graphical_culture = dragongfx } }
					NOT = { has_character_flag = dany_dragon }	 
				}
				random_province = {
					limit = {
						OR = {
							is_volcano_location_trigger = yes
							owner = { graphical_culture = dragongfx }
						}	
						NOT = { region = world_far_east }
					}			
					random_province_lord = {
						preferred_limit = { tier = BARON }
						ROOT = { move_character = PREV }
					}
				}	
				clr_character_flag = has_dragon_location 
				random_province = {
					limit = { ROOT = { has_character_flag = dragon_location_@PREV } }
					ROOT = { clr_character_flag = dragon_location_@PREV }
				}				
			}	
			if = { #if wild, move to sub barony
				limit = {
					NOT = { any_friend = { is_alive = yes } }
					liege = { higher_tier_than = BARON }
					NOT = { liege = { graphical_culture = dragongfx } }
				}
				liege = {
					capital_scope = {
						random_province_lord = {
							limit = { tier = BARON }
							ROOT = { move_character = PREV }
						}
					}	
				}	
				clr_character_flag = has_dragon_location 
				random_province = {
					limit = { ROOT = { has_character_flag = dragon_location_@PREV } }
					ROOT = { clr_character_flag = dragon_location_@PREV }
				}			
			}
			#Check recorded location
			if = {
				limit = { 
					has_character_flag = has_dragon_location 
					liege = {
						capital_scope = {
							ROOT = { 
								NOT = { has_character_flag = dragon_location_@PREV }
							}
						}
					}
					NOT = { liege = { graphical_culture = dragongfx } }
				}
				if = { #check if already in location of rider
					limit = {
						any_friend = {
							is_alive = yes
							OR = {
								same_liege = ROOT
								is_liege_of = ROOT
							}
							NOT = { trait = slave } #not if in captivity
							NAND = {
								is_consort = yes
								consort = { reverse_has_opinion_modifier = { who = PREV modifier = opinion_forced_consort } } 
							}
						}
					}
					clr_character_flag = has_dragon_location 
					random_province = {
						limit = { ROOT = { has_character_flag = dragon_location_@PREV } }
						ROOT = { clr_character_flag = dragon_location_@PREV }
					}
				}
				else = {
					random_province = {
						limit = { ROOT = { has_character_flag = dragon_location_@PREV } }
						random_province_lord = {
							limit = { tier = BARON }
							ROOT = { move_character = PREV }
						}
					}
				}	
			}
			#Record location, to make sure they dont move by mistake
			if = {
				limit = { 
					NOT = { has_character_flag = has_dragon_location }
					NOT = { liege = { graphical_culture = dragongfx } }
				}	
				liege = {
					capital_scope = {
						ROOT = { 
							set_character_flag = has_dragon_location
							set_character_flag = dragon_location_@PREV 
						}
					}
				}
			}
		}
		if = { #If locked in dragonpit check lcoation actually has one
			limit = { 
				has_character_modifier = locked_in_dragonpit
				liege = { 
					NOT = { has_dragonpit_trigger = yes }
				}	
			}
			remove_character_modifier = locked_in_dragonpit
		}
		if = { #If locked in dragonpit, ai release?
			limit = { has_character_modifier = locked_in_dragonpit }
			clear_event_target = dragon_controller
			random_friend = {
				limit = { ai = yes }
				save_event_target_as = dragon_controller
			}
			if = {
				limit = {
					NOT = { any_friend = { always = yes } }
					liege = { ai = yes }
				}
				liege = { save_event_target_as = dragon_controller }
			}
			if = {
				limit = {
					event_target:dragon_controller = {
						is_incapable = no
						prisoner = no
						age = 8
						OR = {
							trait = lunatic
							trait = arbitrary
							trait = kind
						}
						NOR = {
							trait = just
							trait = honorable
							trait = cruel
						}
					}
				}
				random = {
					chance = 1
					modifier = {
						factor = 0.5
						event_target:dragon_controller = { NOT = { learning = 6 } }
					}
					modifier = {
						factor = 2
						event_target:dragon_controller = { learning = 10 }
					}
					modifier = {
						factor = 2
						event_target:dragon_controller = { learning = 14 }
					}
					remove_character_modifier = locked_in_dragonpit		
					event_target:dragon_controller = { character_event = { id = dragon.150 } }
				}			
			}	
		}
		
		#dragon rider moves?
		random_friend = {
			limit = { 
				can_use_dragon_abilities_trigger = yes 
				age = 16
				is_ruler = no
			}
			character_event = { id = dragon.190 days = 2 } 
		}	
		#dragon rider builds dragon pit?
		random_friend = {
			limit = { 
				can_use_dragon_abilities_trigger = yes 
				age = 16
				is_playable = yes
				OR = {
					is_patrician = yes
					capital_holding = { holding_type = castle }
				}
				ai = yes
				has_dragonpit_trigger = no
				war = no
				has_regent = no
				NOT = { has_character_flag = loan_taken }
				NOT = { has_character_modifier = loan_timer }
				NOT = { culture_group = unoccupied_group }
				NOT = { trait = kingsguard }
				OR = {
					wealth = 450
					AND = {
						monthly_income = 5
						wealth = 100
					}
				}
			}
			if = { #AI may take loan to build dragonpit
				limit = { 
					NOT = { wealth = 450 } 
				}
				add_character_modifier = {
					name = "loan_timer"
					duration = 1825
				}
				set_character_flag = loan_taken
				if = {
					limit = { NOT = { wealth = 200 } }
					set_variable = { which = "loan_amount" value = 400 }
				}	
				else_if = {
					limit = { NOT = { wealth = 300 } }
					set_variable = { which = "loan_amount" value = 300 }
				}
				else_if = {
					limit = { NOT = { wealth = 400 } }
					set_variable = { which = "loan_amount" value = 200 }
				}
				set_character_flag = loan_amount_found
				character_event = { id = bankruptcy.1 }
			}	
			wealth = -500
			if = {
				limit = { is_patrician = yes }
				family_palace = { add_building = fp_dragon_pit }
			}
			else_if = {
				limit = { capital_holding = { holding_type = castle } }
				capital_holding = { add_building = ca_dragon_pit }
			}
		}	
		#Dragon rider starts war of conquest (prompts island rulers with no neighbors, where AI gets stuck e.g. Aurion on Elyria)
		if = {
			limit = { 
				martial = 50
				NOT = { trait = maimed_dragon }
			}	
			random_friend = {
				limit = { 
					can_use_dragon_abilities_trigger = yes 
					age = 16
					independent = yes
					ai = yes
					war = no
					has_regent = no
					wealth = 50
					NOT = { trait = content }
					
					OR = {
						trait = ambitious
						trait = brave
						martial = 20
						trait = greedy
						trait = envious
					}
					NOT = { any_neighbor_independent_ruler = { higher_tier_than = BARON } }
				}
				save_event_target_as = dragon_conquester
				random_independent_ruler = {
					limit = {
						demesne_size = 1
						NOT = { culture_group = unoccupied_group }
						NOT = { reverse_has_truce = PREV }
						NOR = {
							is_allied_with = PREV	
							has_non_aggression_pact_with = PREV				
						}
						NOT = { relative_power = { who = PREV power = 2.5 } }
						NOT = { trait = dragon_rider }
						NOT = { trait = wildling }
						NOT = { primary_title = { title = d_kingsguard } }
						capital_scope = {
							event_target:dragon_conquester = { #restrict to sensible dsitances
								capital_scope = {
									NOT = {
										distance = {
											where = PREVPREV
											value = 350
										}
									}	
								}
							}
						}
					}
					primary_title = {
						reverse_war = {
							target = event_target:dragon_conquester
							casus_belli = dragon_conquest
						}
					}
				}				
			}	
		}
		
		set_immune_to_pruning = yes
		if = {  #hatch egg
			limit = { 
				has_artifact = dragon_egg 
				NOT = { has_character_flag = shadow_lands_dragon }
			}
			if = {
				limit = { any_friend = { always = yes  } }
				random_artifact = { 
                    limit = { artifact_type = dragon_egg }
                    save_event_target_as = new_dragon_egg
                }
				random_friend = { character_event = { id = dragon.10 days = 1 } }
			}
			else = {
				random = {
					chance = 15
					random_list = {
						50 = {
							create_character = {
								dynasty = actually_culture
								age = 0
								culture = dragon_culture
								religion = dragon_rel
								historical = yes
							}
						}
						50 = {
							create_character = {
								female = yes
								dynasty = actually_culture
								age = 0
								culture = dragon_culture
								religion = dragon_rel
								historical = yes
							}
						}
					}
					new_character = {
						add_trait = dragon
						add_trait = incapable_dragon
						character_event = { id = dragon.599 }
						random = {
							chance = 5
							add_trait = fair_dragon
						}
						random = {
							chance = 5
							if = {
								limit = { NOT = { trait = fair_dragon } }
								add_trait = ugly_dragon
							}	
						}
						random = {
							chance = 2
							add_trait = sickly_dragon
						}
						if = {
							limit = { NOT = { trait = sickly_dragon } }
							random = {
								chance = 5
								add_trait = strong_dragon
							}
							random = {
								chance = 15
								add_trait = fertile_dragon
							}
						}
						random = {
							chance = 33
							add_trait = nimble_dragon
						}						
						random_list = {
							1 = { add_trait = dragon_1 }
							1 = { add_trait = dragon_2 }
							1 = { add_trait = dragon_3 }
							1 = { add_trait = dragon_4 }
							1 = { add_trait = dragon_5 }
							1 = { add_trait = dragon_6 }
							1 = { add_trait = dragon_7 }
							1 = { add_trait = dragon_8 }
							1 = { add_trait = dragon_9 }
							1 = { add_trait = dragon_10 }
							1 = { add_trait = dragon_11 }
							1 = { add_trait = dragon_12 }
							1 = { add_trait = dragon_13 }
							1 = { add_trait = dragon_14 }
							1 = { add_trait = dragon_15 }
							1 = { add_trait = dragon_16 }
							1 = { add_trait = dragon_17 }
							1 = { add_trait = dragon_18 }
							1 = { add_trait = dragon_19 }
							1 = { add_trait = dragon_20 }
							1 = { add_trait = dragon_21 }
							1 = { add_trait = dragon_22 }
							1 = { add_trait = dragon_23 }
							1 = { add_trait = dragon_24 }
							1 = { add_trait = dragon_25 }
							1 = { add_trait = dragon_26 }
							1 = { #Balerion
								modifier = {
									factor = 0.05
								}
								add_trait = dragon_27 
							}
						}
					}
					location = { province_event = { id = dragon.897 } }
				}
			}					
		}
		if = {
			limit = {
				NOR = {
					has_alternate_start_parameter = { key = special_culture value = mythological } 
					has_alternate_start_parameter = { key = special_culture value = all } 
				}
			}
			#Remove claims
			random_claim = { remove_claim = ROOT }
			#Remove lovers/rivals
			any_lover = {
				limit = { NOT = { trait = dragon } }
				remove_lover = ROOT
			}
			any_rival = {
				remove_rival = ROOT
			}
		}	
		#Check whip owner
		persistent_event_target:whip = {
			if = {
				limit = {
					owner = {
						NOR = {
							character = ROOT
							is_friend = ROOT
						}
					}
				}
				owner = { save_event_target_as = whip_owner }
				transfer_artifact = { from = event_target:whip_owner to = ROOT }
			}
		}
		#Random personality change
		if = {  
			limit = { 
				NOT = { 
					calc_true_if = {
						amount = 2
						trait = wroth_dragon
						trait = obedient_dragon
						trait = lazy_dragon
						trait = ravenous_dragon
						trait = playful_dragon 
						trait = affectionate_dragon 
						trait = shy_dragon
						#trait = lunatic_dragon #can be thrid trait
					}
				} 
			}
			random_list = {
				161 = { }
				2 = { #wroth
					modifier = {
						factor = 0				
						OR = {
							trait = wroth_dragon
							trait = obedient_dragon
						}
					}
					modifier = {
						factor = 2
						trait = lunatic_dragon
					}
					modifier = {
						factor = 2
						any_friend = { trait = wroth }
					}
					modifier = {
						factor = 0.5
						any_friend = { trait = patient }
					}
					modifier = {
						factor = 2
						any_friend = { trait = cruel }
					}
					add_trait = wroth_dragon
					random_friend = { character_event = { id = dragon.100 } }
				}
				2 = { #obedient
					modifier = {
						factor = 0				
						OR = {
							trait = wroth_dragon
							trait = obedient_dragon
						}
					}
					modifier = {
						factor = 2
						any_friend = { trait = patient }
					}
					modifier = {
						factor = 0.5
						any_friend = { trait = wroth }
					}
					modifier = {
						factor = 2
						any_friend = { trait = diligent }
					}
					modifier = {
						factor = 0.5
						any_friend = { trait = slothful }
					}
					add_trait = obedient_dragon
					random_friend = { character_event = { id = dragon.105 } }
				}
				2 = { #lazy
					modifier = {
						factor = 0		
						trait = lazy_dragon
					}
					modifier = {
						factor = 1.5
						trait = ravenous_dragon 
					}
					modifier = {
						factor = 0.5
						any_friend = { trait = diligent }
					}
					modifier = {
						factor = 2
						any_friend = { trait = slothful }
					}
					add_trait = lazy_dragon
					random_friend = { character_event = { id = dragon.110 } }				
				}
				2 = { #ravenous
					modifier = {
						factor = 0
						trait = ravenous_dragon
					}
					modifier = {
						factor = 2
						trait = lunatic_dragon
					}
					modifier = {
						factor = 2
						trait = lazy_dragon
					}
					modifier = {
						factor = 0.5
						any_friend = { trait = temperate }
					}
					modifier = {
						factor = 2
						any_friend = { trait = gluttonous }
					}
					add_trait = ravenous_dragon
					random_friend = { character_event = { id = dragon.84 } }
				}
				2 = { #playful
					modifier = {
						factor = 0		
						trait = playful_dragon 
					}
					modifier = {
						factor = 0
						trait = shy_dragon
					}
					modifier = {
						factor = 0.5
						any_friend = { trait = diligent }
					}
					modifier = {
						factor = 2
						any_friend = { trait = slothful }
					}
					modifier = {
						factor = 0.5
						any_friend = { trait = shy }
					}
					modifier = {
						factor = 2
						any_friend = { trait = gregarious }
					}
					add_trait = playful_dragon 
					random_friend = { character_event = { id = dragon.115 } }
				}
				1 = { #lunatic
					modifier = {
						factor = 0		
						trait = lunatic_dragon 
					}
					modifier = {
						factor = 2
						trait = wroth_dragon
					}
					modifier = {
						factor = 0.5
						trait = obedient_dragon
					}
					modifier = {
						factor = 2
						any_friend = { trait = lunatic }
					}
					modifier = {
						factor = 2
						any_friend = { trait = cruel }
					}
					add_trait = lunatic_dragon 
					random_friend = { character_event = { id = dragon.120 } }
				}
				2 = { 
					modifier = {
						factor = 0				
						OR = {
							trait = affectionate_dragon 
							trait = shy_dragon
						}
					}
					modifier = {
						factor = 0.5
						any_friend = { trait = cruel }
					}
					modifier = {
						factor = 2
						any_friend = { trait = kind }
					}
					add_trait = affectionate_dragon 
					random_friend = { character_event = { id = dragon.125 } }
				}
				1 = { #shy
					modifier = {
						factor = 0				
						OR = {
							trait = affectionate_dragon 
							trait = playful_dragon
							trait = shy_dragon
						}
					}
					modifier = {
						factor = 0.25
						trait = wroth_dragon
					}
					modifier = {
						factor = 0.25
						trait = playful_dragon
					}
					modifier = {
						factor = 2
						any_friend = { trait = shy }
					}
					modifier = {
						factor = 0.5
						any_friend = { trait = gregarious }
					}
					add_trait = shy_dragon 
					random_friend = { character_event = { id = dragon.130 } }
				}
			}
		}
		#Random flavour event
		random_list = {
			100 = { }
			10 = { #Dragon is eating smallfolk's animals
				modifier = {
					factor = 0
					NOR = {
						trait = ravenous_dragon
						trait = lunatic_dragon
						trait = wroth_dragon
					}
				}
				modifier = {
					factor = 0
					has_character_modifier = locked_in_dragonpit
				}
				modifier = {
					factor = 2
					trait = ravenous_dragon
				}
				modifier = {
					factor = 0.25
					trait = lazy_dragon
				}
				modifier = {
					factor = 0.05
					trait = shy_dragon
				}
				character_event = { id = dragon.85 }
			}
			20 = { #Large dragon loses nimble trait
				modifier = {
					factor = 0
					NOT = { trait = nimble_dragon }
				}
				modifier = {
					factor = 0
					NOT = { martial = 40 }
				}
				modifier = {
					factor = 2
					martial = 50
				}
				modifier = {
					factor = 2
					martial = 60
				}
				modifier = {
					factor = 5
					martial = 70
				}
				remove_trait = nimble_dragon
				random_friend = { character_event = { id = dragon.135 } }
			}
			5 = { #Untamed dragon attacks another dragon
				modifier = {
					factor = 0
					OR = {
						any_friend = { can_use_dragon_abilities_trigger = yes }
						has_character_modifier = locked_in_dragonpit
						NOT = { martial = 10 }
						trait = maimed_dragon
						trait = sickly_dragon
						trait = shy_dragon
						trait = playful_dragon
					}	
				}
				modifier = {
					factor = 0
					NOR = {
						trait = wroth_dragon
						trait = ravenous_dragon
						trait = lunatic_dragon
					}
				}
				modifier = {
					factor = 2
					trait = wroth_dragon
				}
				modifier = {
					factor = 2
					trait = ravenous_dragon
				}
				modifier = {
					factor = 2
					trait = lunatic_dragon
				}
				modifier = {
					factor = 0.5
					trait = lazy_dragon
				}
				modifier = {
					factor = 0.5
					trait = affectionate_dragon
				}
				dragon = { #try to find wild dragon first
					limit = {
						is_alive = yes
						at_location = ROOT
						NOT = { has_character_modifier = locked_in_dragonpit }
						NOT = {
							attribute_diff = { character = ROOT attribute = martial value = 10 }
						}
						NOT = { any_friend = { always = yes } }
						NOT = { character = ROOT }
						NOT = { is_lover = ROOT }
						OR = {
							ROOT = { trait = lunatic_dragon }
							NOT = { is_close_relative = ROOT }
						}
						ai = yes
					}
					character_event = { id = dragon.140 }
					break = yes
				}
				dragon = { #then try a dragon with a rider
					limit = {
						is_alive = yes
						at_location = ROOT
						NOT = { has_character_modifier = locked_in_dragonpit }
						NOT = {
							attribute_diff = { character = ROOT attribute = martial value = 10 }
						}
						NOT = { any_friend = { in_command = yes } }
						NOT = { character = ROOT }
						NOT = { is_lover = ROOT }
						OR = {
							ROOT = { trait = lunatic_dragon }
							NOT = { is_close_relative = ROOT }
						}
						ai = yes
					}
					character_event = { id = dragon.140 }
					break = yes
				}
			}
			5 = { #Dragon lovers
				modifier = {
					factor = 0
					OR = {
						NOT = { martial = 10 }
						trait = sickly_dragon
						trait = shy_dragon
						trait = wroth_dragon
						has_lover = yes
					}
				}
				modifier = {
					factor = 3
					trait = playful_dragon
				}
				modifier = {
					factor = 2
					trait = affectionate_dragon
				}
				modifier = {
					factor = 2
					trait = fair_dragon
				}
				modifier = {
					factor = 0.25
					trait = lazy_dragon
				}
				modifier = {
					factor = 0.25
					trait = lunatic_dragon
				}
				modifier = {
					factor = 0.25
					trait = ugly_dragon
				}
				dragon = { #try and find dragon of rider's lover
					limit = {
						is_alive = yes
						at_location = ROOT
						any_friend = { ROOT = { any_friend = { is_lover = PREVPREV } } }
						NOT = { same_sex = ROOT }
						martial = 10
						NOR = { #roughly the same size
							attribute_diff = { character = ROOT attribute = martial value = 30 }
							ROOT = { attribute_diff = { character = PREV attribute = martial value = 30 } }
						}
						OR = {
							AND = {
								has_character_modifier = locked_in_dragonpit
								ROOT = { has_character_modifier = locked_in_dragonpit }
							}
							AND = {
								NOT = { has_character_modifier = locked_in_dragonpit }
								ROOT = { NOT = { has_character_modifier = locked_in_dragonpit } }
							}
						}
						has_lover = no						
					}
					character_event = { id = dragon.145 }
					break = yes
				}
				dragon = {
					limit = {
						is_alive = yes
						at_location = ROOT
						NOT = { same_sex = ROOT }
						martial = 10
						NOR = { #roughly the same size
							attribute_diff = { character = ROOT attribute = martial value = 30 }
							ROOT = { attribute_diff = { character = PREV attribute = martial value = 30 } }
						}
						OR = {
							AND = {
								has_character_modifier = locked_in_dragonpit
								ROOT = { has_character_modifier = locked_in_dragonpit }
							}
							AND = {
								NOT = { has_character_modifier = locked_in_dragonpit }
								ROOT = { NOT = { has_character_modifier = locked_in_dragonpit } }
							}
						}
						NOT = { trait = sickly_dragon }
						NOT = { trait = shy_dragon }
						NOT = { trait = wroth_dragon }
						NOT = { trait = ugly_dragon }
						has_lover = no
					}
					character_event = { id = dragon.145 }
					break = yes
				}
			}
			10 = { #Dragon is enraged in the dragonpit
				modifier = {
					factor = 0
					NOR = {
						trait = ravenous_dragon
						trait = lunatic_dragon
						trait = wroth_dragon
					}
				}
				modifier = {
					factor = 0
					OR = {
						NOT = { has_character_modifier = locked_in_dragonpit }
						trait = maimed_dragon
					}	
				}
				modifier = {
					factor = 0
					trait = obedient_dragon
					NOT = { trait = lunatic_dragon }
				}
				modifier = {
					factor = 0.5
					NOR = {
						trait = lunatic_dragon
						trait = wroth_dragon
					}
				}				
				modifier = {
					factor = 2
					trait = lunatic_dragon
				}
				modifier = {
					factor = 0.5
					trait = lazy_dragon
				}
				modifier = {
					factor = 0.66
					trait = shy_dragon
				}
				character_event = { id = dragon.155 }
			}			
		}
		#GROWTH
		random_list = {  #Aiming for 1 martial every 2 years
			50 = {
				modifier = {
					factor = 0.75
					has_character_modifier = mnm_effected	
				}
				modifier = {
					factor = 1.66
					trait = strong_dragon
				}
				modifier = {
					factor = 0.85
					trait = lazy_dragon
				}
				modifier = {
					factor = 1.25
					trait = ravenous_dragon
				}		
				modifier = {
					factor = 3
					NOT = { age = 6 }
				}
				modifier = { #Having a guardian increases martial rapidly
					factor = 0.5
					age = 6
					NOT = { age = 16 }
				}
				modifier = {
					factor = 1.5
					location = { is_volcano_location_trigger = yes }
				}
				modifier = {
					factor = 0.75
					has_character_modifier = locked_in_dragonpit
				}	
				change_martial = 1
			}
			50 = {
			}
		}
	}
	
	option = {
		name = "OK"
	}
}
#Inform dragon wound healed
character_event = {
	id = dragon.899
	desc = "EVTDESCdragon.899"
	picture = "GFX_evt_dragon_riding_3" 
	
	is_triggered_only = yes

	option = {
		name = OK
		FROM = { remove_trait = wounded_dragon }
	}
}
#Inform dragon maiming healed
character_event = {
	id = dragon.898
	desc = "EVTDESCdragon.898"
	picture = "GFX_targaryen_balerion" 
	
	is_triggered_only = yes

	option = {
		name = OK
		FROM = { remove_trait = maimed_dragon }
	}
}
#Inform wild dragon born
province_event = {
	id = dragon.897
	desc = "EVTDESCdragon.897"
	picture = "GFX_evt_dragons_flying" 
	
	is_triggered_only = yes

	option = {
		name = OK
	}
}
#wild chained untamed dragon gets mad
character_event = {
	id = dragon.950
	
	culture = dragon_culture
	min_age = 5
	friends = yes
	
	trigger = {	
		trait = dragon 
		is_ruler = no
		NOT = { has_character_modifier = locked_in_dragonpit }
		any_friend = { 
			NOT = { can_use_dragon_abilities_trigger = yes }
			NOT = { trait = dragon }
			age = 10
			OR = {
				had_character_flag = { flag = chained_dragon_mad days = 250 } 
				NOT = { has_character_flag = chained_dragon_mad}
			}
		}	
		NOT = { liege = { graphical_culture = dragongfx } }
	}
	
	mean_time_to_happen = {
		years = 4
		
		modifier = {
			factor = 25
			has_game_rule = { name = dragon_hatching_taming value = easy }
		}
		modifier = {
			factor = 5
			has_game_rule = { name = dragon_hatching_taming value = less_hard }
		}
		modifier = {
			factor = 0.33
			has_game_rule = { name = dragon_hatching_taming value = hard }
		}
		modifier = { 
			factor = 2.5
			any_friend = { has_dynasty_flag = dragon_riding_dynasty }
		}
		modifier = { 
			factor = 2
			any_friend = { liege = { is_close_relative = PREV can_use_dragon_abilities_trigger = yes } }
		}
		modifier = { 
			factor = 4
			any_friend = { 
				NOT = { age = 14 }
				has_dynasty_flag = dragon_riding_dynasty
			}	
		}
	}
	
	option = {
		name = OK
		random_friend = { 
			limit = {
				NOT = { can_use_dragon_abilities_trigger = yes }
				NOT = { trait = dragon }
				OR = {
					had_character_flag = { flag = chained_dragon_mad days = 250 } 
					NOT = { has_character_flag = chained_dragon_mad}
				}
			}	
			character_event = { id = dragon.9 }
		}
	}
}
character_event = {
	id = dragon.9
	desc = "EVTDESCdragon.9"
	picture = "GFX_evt_dragon_battle" 
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.9" # Ugh
		ai_chance = {
			factor = 4
		}
		set_character_flag = chained_dragon_mad
		capital_scope = { province_event = { id = dragon.25 } }
		prestige = -50
	}
	
	option = {
		name = "EVTOPTBdragon.9" # Try and lock in pit
		trigger = {
			has_dragonpit_trigger = yes
			age = 12
			NOT = { has_severe_disability_trigger = yes }
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.1
				trait = craven
			}
			modifier = {
				factor = 2
				trait = brave
			}
			modifier = {
				factor = 3
				trait = trained_warrior
			}
			modifier = {
				factor = 5
				trait = skilled_warrior
			}
			modifier = {
				factor = 8
				trait = master_warrior
			}
			modifier = {
				factor = 1.5
				FROM = { NOT = { martial = 20 } }
			}
			modifier = {
				factor = 0.9
				FROM = { martial = 40 } 
			}
			modifier = {
				factor = 0.8
				FROM = { martial = 60 } 
			}
			modifier = {
				factor = 0.75
				FROM = { martial = 80 } 
			}
			modifier = {
				factor = 0.66
				FROM = { martial = 100 } 
			}
		}
		set_character_flag = capture_dragon
		FROM = { character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 days = 1 } }
	}
}
#Dragon bears you a dragon egg
character_event = {
	id = dragon.1099
	
	hide_window = yes
	min_age = 4
	
	trigger = {
		trait = dragon
		NOT = { has_artifact = dragon_egg }
		NOT = { trait = sickly_dragon }
		NAND = { #female partner gets egg bonus
			has_lover = yes
			is_female = no
		}
	}
	
	mean_time_to_happen = {
		years = 80
		
		modifier = {
			factor = 0.4
			has_lover = yes
		}
		modifier = {
			factor = 0.6
			trait = fertile_dragon	
		}
		modifier = {
			factor = 0.75
			trait = playful_dragon	
		}
		modifier = {
			factor = 1.33
			trait = shy_dragon	
		}
		modifier = {
			factor = 1.5
			has_character_modifier = mnm_effected	
		}
			
		modifier = {
			factor = 1.5
			num_of_children = 2
		}
		modifier = {
			factor = 1.5
			num_of_children = 3
		}
		modifier = {
			factor = 2
			num_of_children = 4
		}
		
		modifier = { #Already has egg
			factor = 5
			any_friend = { has_artifact = dragon_egg }
		}
		modifier = { #Make sure at least one egg comes
			factor = 0.2
			age = 80
			NOT = { any_child = { trait = dragon is_alive = yes } }
			NOT = { 
				any_courtier = { 
					any_artifact = {
						artifact_type = dragon_egg
						has_artifact_flag = dragon_egg_mother_@ROOT 
					}					
				} 
			}
		}
		modifier = { #Owner's dynasty is short on eggs
			factor = 0.4
			any_friend = {
				NOT = { has_artifact = dragon_egg }
				NOT = { any_dynasty_member = { is_close_relative = PREV has_artifact = dragon_egg } }
			}
		}
		modifier = {
			factor = 0.9
			any_friend = { trait = genius }
		}
		modifier = {
			factor = 0.9
			any_friend = { trait = quick }
		}
		modifier = {
			factor = 0.9
			any_friend = { learning = 15 }
		}
		modifier = {
			factor = 0.9
			any_friend = { learning = 18 }
		}
		modifier = {
			factor = 0.9
			any_friend = { learning = 21 }
		}
		modifier = {
			factor = 2
			any_friend = { trait = imbecile }
		}
		modifier = {
			factor = 1.5
			any_friend = { is_dumb_trigger = yes }
		}
		modifier = {
			factor = 1.1
			any_friend = { NOT = { learning = 8 } }
		}
		modifier = {
			factor = 1.1
			any_friend = { NOT = { learning = 5 } }
		}
		modifier = {
			factor = 1.1
			any_friend = { NOT = { learning = 2 } }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_citadel }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_harrenhal } 
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_dragonstone }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_dragonpit }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_fof }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_summerhall }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_eggs }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_old_ghis }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_volantis }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_smoking_sea }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_asshai }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_dynamic }
		}
	}
	
	immediate = {
		add_artifact = dragon_egg
		new_artifact = {
			set_artifact_flag = dragon_egg_mother_@ROOT
			set_name = [Root.GetDynamicDragonEggName]
			save_event_target_as = new_dragon_egg
			
		}
		if = {
			limit = { has_lover = yes }
			random_lover = { event_target:new_dragon_egg = { set_artifact_flag = dragon_egg_father_@PREV } }
		}
		random_friend = { character_event = { id = dragon.10 days = 1 } }
	}
	
	option = {
		name = OK
	}
}	
character_event = {
	id = dragon.10
	desc = "EVTDESCdragon.10"
	picture = "GFX_targaryen_eggs" 
	
	is_triggered_only = yes
	
	trigger = { 
		is_alive = yes 
	}
	
	option = {
		name = "EVTOPTAdragon.10" 
		event_target:new_dragon_egg = {
			transfer_artifact = { from = FROM to = ROOT }
			set_artifact_flag = heirloom_@ROOT
		}
	}
}	
##Dragon dies
character_event = {
	id = dragon.1199
	
	hide_window = yes
	
	trigger = {
		trait = dragon
		OR = { #Not before age 100 unless ill/injured
			age = 100
			trait = sickly_dragon
			trait = wounded_dragon
			trait = maimed_dragon
		}		
	}
	
	mean_time_to_happen = {
		years = 250
		modifier = {
			factor = 0.0007
			trait = sickly_dragon
		}
		modifier = {
			factor = 0.8
			trait = wounded_dragon
		}
		modifier = {
			factor = 0.05
			trait = maimed_dragon
		}		
		modifier = {
			factor = 0.8
			has_character_modifier = locked_in_dragonpit	
		}
		modifier = {
			factor = 0.8
			has_character_modifier = mnm_effected
		}	
		modifier = {
			factor = 1.33
			location = { is_volcano_location_trigger = yes } 
		}
	}
	
	immediate = {	
		if = {
			limit = { 
				trait = sickly_dragon
			}
			death = {					
				death_reason = death_sickly_dragon
			}
		}
		else_if = {
			limit = { 
				OR = {
					trait = wounded_dragon 
					trait = maimed_dragon
				}	
			}
			death = {					
				death_reason = death_trait
			}
		}
		else = {
			death = {					
				death_reason = death_natural
			}
		}
			
		any_friend = { 
			save_event_target_as = former_dragon_rider
			character_event = { id = dragon.11 } 
		}
		any_playable_ruler = { #inform world
			limit = { 
				ai = no
				NOT = { is_friend = ROOT }
			}	
			character_event = { id = dragon.1198 }
		}		
	}
	
	option = {
		name = OK	
	}
}
character_event = {
	id = dragon.11
	desc = "EVTDESCdragon.11"
	picture = "GFX_evt_dragon_skull"
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				wealth = 75
				OR = {
					ai = no
					AND = {
						war = no
						prisoner = no
						NOT = { has_character_modifier = loan_timer }
					}
				}
			}
			#Find potential weapon to make
			random_list = {
				100 = {
					trigger = {
						NOT = { has_artifact = dragonbone_bow } 
						OR = {
							is_nomadic = yes 
							culture = summer_islander
							can_use_bow_trigger = yes
						}	
					}
					modifier = { culture = summer_islander factor = 4 }
					set_character_flag = dragonbone_bow
				}
				100 = {
					trigger = { NOT = { has_artifact = dragonbone_axe } }
					modifier = { culture = norvoshi factor = 4 }
					modifier = { culture_group = iron_isles_culture factor = 2 }
					set_character_flag = dragonbone_axe
				}
				100 = {
					trigger = { NOT = { has_artifact = dragonbone_sword } }
					set_character_flag = dragonbone_sword
				}
				1 = { }
			}
			#Find potential other artifact to make
			random_list = {
				100 = {
					trigger = { NOT = { has_artifact = dragonbone_whip } }
					set_character_flag = dragonbone_whip
				}
				100 = {
					trigger = { NOT = { has_artifact = dragonbone_bracelet } }
					set_character_flag = dragonbone_bracelet
				}
				100 = {
					trigger = { NOT = { has_artifact = dragonbone_statue } }
					set_character_flag = dragonbone_statue
				}
				100 = {
					trigger = { NOT = { has_artifact = dragonbone_amulet } }
					set_character_flag = dragonbone_amulet
				}
				100 = {
					trigger = { NOT = { has_artifact = dragonbone_seal } }
					set_character_flag = dragonbone_seal
				}
				100 = {
					trigger = { NOT = { has_artifact = dragonbone_scepter } }
					set_character_flag = dragonbone_scepter
				}
				100 = {
					trigger = { NOT = { has_artifact = dragonbone_necklace } }
					set_character_flag = dragonbone_necklace
				}
				1 = { }
			}
		}	
	}
	
	option = {
		name = "EVTOPTAdragon.11" 	
		ai_chance = { factor = 1 }
	}
	option = {
		name = "EVTOPTBdragon.11" 	#keep the skull
		ai_chance = { 
			factor = 100
			modifier = {
				factor = 0
				NOT = { wealth = 25 }
				FROM = { NOT = { age = 50 } }
			}
		}
		wealth = -25
		add_artifact = dragon_skull
		new_artifact = {
			set_name = [From.GetDynamicDragonSkullName]
			set_description = [From.GetDynamicDragonSkullDesc]
			set_artifact_flag = dragon_@FROM
			set_original_owner = FROM
		}
		primary_title = {
			set_title_flag = has_artifact_claims
			new_artifact = { 
				set_artifact_flag = heirloom_@ROOT 
				set_artifact_flag = title_heirloom_@ROOT
				set_artifact_flag = heirloom_@PREV
			}
		}
	}
	option = {
		name = "EVTOPTCdragon.11" 	#Make a weapon
		trigger = {
			OR = {
				has_character_flag = dragonbone_bow
				has_character_flag = dragonbone_axe
				has_character_flag = dragonbone_sword
			}
			wealth = 150
		}
		ai_chance = { 
			factor = 100
		}
		wealth = -150
		if = {
			limit = { has_character_flag = dragonbone_bow }
			add_artifact = dragonbone_bow
		}
		if = {
			limit = { has_character_flag = dragonbone_axe }
			add_artifact = dragonbone_axe
		}
		if = {
			limit = { has_character_flag = dragonbone_sword }
			add_artifact = dragonbone_sword
		}
		add_artifact = dragon_skull
		new_artifact = {
			set_name = [From.GetDynamicDragonSkullName]
			set_description = [From.GetDynamicDragonSkullDesc]
			set_artifact_flag = dragon_@FROM
			set_original_owner = FROM
		}
		primary_title = {
			set_title_flag = has_artifact_claims
			new_artifact = { 
				set_artifact_flag = heirloom_@ROOT 
				set_artifact_flag = title_heirloom_@ROOT
				set_artifact_flag = heirloom_@PREV
			}
		}
	}
	option = {
		name = "EVTOPTDdragon.11" 	#Make other artifact
		trigger = {
			OR = {
				has_character_flag = dragonbone_whip
				has_character_flag = dragonbone_bracelet
				has_character_flag = dragonbone_statue
				has_character_flag = dragonbone_amulet
				has_character_flag = dragonbone_scepter
				has_character_flag = dragonbone_seal
				has_character_flag = dragonbone_necklace
			}
			wealth = 75
		}
		ai_chance = { 
			factor = 100
		}
		wealth = -75
		if = {
			limit = { has_character_flag = dragonbone_whip }
			add_artifact = dragonbone_whip
		}
		if = {
			limit = { has_character_flag = dragonbone_bracelet }
			add_artifact = dragonbone_bracelet
		}
		if = {
			limit = { has_character_flag = dragonbone_statue }
			add_artifact = dragonbone_statue
		}
		if = {
			limit = { has_character_flag = dragonbone_amulet }
			add_artifact = dragonbone_amulet
		}
		if = {
			limit = { has_character_flag = dragonbone_scepter }
			add_artifact = dragonbone_scepter
		}
		if = {
			limit = { has_character_flag = dragonbone_seal }
			add_artifact = dragonbone_seal
		}
		if = {
			limit = { has_character_flag = dragonbone_necklace }
			add_artifact = dragonbone_necklace
		}
		add_artifact = dragon_skull
		new_artifact = {
			set_name = [From.GetDynamicDragonSkullName]
			set_description = [From.GetDynamicDragonSkullDesc]
			set_artifact_flag = dragon_@FROM
			set_original_owner = FROM
		}
		primary_title = {
			set_title_flag = has_artifact_claims
			new_artifact = { 
				set_artifact_flag = heirloom_@ROOT 
				set_artifact_flag = title_heirloom_@ROOT
				set_artifact_flag = heirloom_@PREV
			}
		}
	}
	
	after = {
		remove_trait = dragon_rider	
		random = {
			chance = 33
			add_artifact = dragon_egg
			new_artifact = {
				set_artifact_flag = dragon_egg_mother_@FROM
				set_artifact_flag = heirloom_@ROOT
				set_name = [From.GetDynamicDragonEggName]
			}	
		}	
		if = {
			limit = { NOT = { trait = depressed } }
			random = {
				chance = 20
				modifier = {
					factor = 2
					trait = kind
				}
				modifier = {
					factor = 2
					trait = stressed
				}
				modifier = {
					factor = 0.5
					trait = cruel
				}
				modifier = {
					factor = 0.5
					trait = ruthless
				}
				add_trait = depressed
				hidden_tooltip = {
					character_event = {
						id = 38288 #Notify Depressed
					}
				}
			}
		}
		
		if = { #Check dragon riding dynasty status
			limit = {
				NOT = { dynasty = 0 }
				has_dynasty_flag = dragon_riding_dynasty
				NOT = { any_dynasty_member = { can_use_dragon_abilities_trigger = yes	is_alive = yes } }
			}
			clr_dynasty_flag = dragon_riding_dynasty
		}
		clr_character_flag = dragonbone_bow
		clr_character_flag = dragonbone_axe
		clr_character_flag = dragonbone_whip
		clr_character_flag = dragonbone_bracelet
		clr_character_flag = dragonbone_statue
		clr_character_flag = dragonbone_sword
		clr_character_flag = dragonbone_amulet
		clr_character_flag = dragonbone_scepter
		clr_character_flag = dragonbone_seal
		clr_character_flag = dragonbone_necklace
	}
}
character_event = {
	id = dragon.1198
	picture = "GFX_evt_dragon_skull"
	
	desc = {
		text = EVTDESCdragon.1198 #default
	}
	desc = {
		text = EVTDESCdragon.1198B #sickly
		trigger = { FROM = { death_reason = death_sickly_dragon } }
	}
	desc = {
		text = EVTDESCdragon.1198C #wound
		trigger = { 
			FROM = {
				trait = wounded_dragon
				death_reason = death_trait
			} 
		}
	}
	desc = {
		text = EVTDESCdragon.1198D #maimed
		trigger = { 
			FROM = {
				trait = maimed_dragon
				death_reason = death_trait
			} 
		}
	}
	
	is_triggered_only = yes
	
	trigger = { NOT = { has_character_flag = no_dragon_old_age_death } }
	
	option = {
		name = "EVTOPTAdragon.1198" 	
		event_target:former_dragon_rider = { show_portrait = yes }
	}
	option = {
		name = "EVTOPTBdragon.1198" 	
		set_character_flag = no_dragon_old_age_death
	}
}
#young dragon OR inherited dragon grown up, try to tame
character_event = {
	id = dragon.12
	desc = "EVTDESCdragon.12"
	picture = "GFX_tamingdragon" 
	
	is_triggered_only = yes
	friends = yes
	
	trigger = { 
		NOT = { trait = dragon }
		can_use_dragon_abilities_trigger = no
		any_friend = { 
			trait = dragon 
			age = 2
		}
		NOT = { has_character_flag = dany_no_tame_dragon }
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
	}
	
	option = {
		name = "EVTOPTAdragon.12" # tame it
		trigger = {
			OR = {
				culture_group = valyrian
				high_valyrian_dynasty_trigger = yes
				NOT = { has_game_rule = { name = dragon_hatching_taming value = valyrian_only } }
			}
		}
		ai_chance = {
			factor = 1	

			modifier = {
				factor = 25
				has_game_rule = { name = dragon_hatching_taming value = easy }
			}
			modifier = {
				factor = 5
				has_game_rule = { name = dragon_hatching_taming value = less_hard }
			}
			modifier = {
				factor = 0.33
				has_game_rule = { name = dragon_hatching_taming value = hard }
			}	
			modifier = {
				factor = 5
				has_ambition = obj_tame_a_dragon
			}			
			modifier = {
				factor = 5
				any_friend = { trait = dragon age = 2 has_character_flag = tamed_dragon }
			}
			modifier = {
				factor = 10
				any_dynasty_member = { at_location = ROOT is_alive = yes can_use_dragon_abilities_trigger = yes }
			}
			modifier = {
				factor = 5
				any_friend = {
					trait = dragon
					has_character_modifier = locked_in_dragonpit
				}
			}
			modifier = {
				factor = 3
				trait = brave
			}
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 3
				trait = genius
			}
			modifier = {
				factor = 1.5
				is_smart_trigger = yes
			}
			modifier = {
				factor = 2
				trait = lunatic
			}
			modifier = {
				factor = 5
				any_owned_bloodline = { has_bloodline_flag = blood_of_the_dragon }
			}
			modifier = {
				factor = 5
				OR = {			
					culture = high_valyrian 
					graphical_culture = valyriangfx
				}
			}
			modifier = {
				factor = 5
				OR = {
					culture_group = valyrian
					has_silver_hair_ethnicity_trigger = yes
				}
			}
			modifier = {
				factor = 2.5
				culture = asshai
			}
			modifier = {
				factor = 5
				religion_group = valyrian_rel_group
			}
			modifier = {
				factor = 10
				has_character_flag = daenerys_targaryen
			}
			modifier = {
				factor = 3
				has_character_flag = dragon_intel_citadel 
			}
			modifier = {
				factor = 1.5
				religion = rhllor 
			}
			modifier = {
				factor = 3
				trait = favored_by_rhllor
			}
			modifier = {
				factor = 10
				trait = chosen_by_rhllor 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_harrenhal
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_dragonstone
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_dragonpit 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_old_ghis
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_volantis
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_smoking_sea
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_asshai
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_dynamic
			}
			#Demon Child
			modifier = {
				factor = 20
				has_character_flag = demon_child_non_pagan
			}
		}
		random_friend = {
			limit = {
				trait = dragon
				age = 2
			}
			character_event = { id = dragon.1399 tooltip = TOOLTIPdragon.1399 }
		}		
	}
	option = {
		name = "EVTOPTEdragon.12" # Use Dragonhorn!
		trigger = {
			any_artifact = {
				has_artifact_flag = dragonhorn
				is_artifact_active = yes
			}
		}
		ai_chance = {
			factor = 9999
		}
		tooltip_info = yes
		character_event = { id = dragon.195 tooltip = TOOLTIPdragon.195 }
	}
	option = {
		name = "EVTOPTBdragon.12" #kill the beast
		ai_chance = {
			factor = 0.3
			
			modifier = {
				factor = 0
				NOT = { trait = lunatic }
				OR = {
					has_game_rule = { name = dragon_hatching_taming value = easy }
					any_owned_bloodline = { has_bloodline_flag = blood_of_the_dragon }
					culture_group = valyrian
					has_silver_hair_ethnicity_trigger = yes
					religion_group = valyrian_rel_group
					trait = chosen_by_rhllor 
					has_character_flag = demon_child_non_pagan
				}
			}
			modifier = {
				factor = 2
				trait = lunatic
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 2
				trait = wroth
			}
			modifier = {
				factor = 2
				trait = dragon_slayer 
			}
		}
		set_character_flag = duel_dragon
		random_friend = {
			limit = {
				trait = dragon
				age = 2
			}
			character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 }
		}	
	}
	option = {
		name = "EVTOPTCdragon.12" #set it free
		ai_chance = {
			factor = 1
			
			modifier = {
				factor = 0
				NOT = { trait = craven }
				OR = {
					has_game_rule = { name = dragon_hatching_taming value = easy }
					any_owned_bloodline = { has_bloodline_flag = blood_of_the_dragon }
					culture_group = valyrian
					has_silver_hair_ethnicity_trigger = yes
					religion_group = valyrian_rel_group
					trait = chosen_by_rhllor 
					has_character_flag = demon_child_non_pagan
				}
			}
			modifier = {
				factor = 2
				trait = shy
			}
			modifier = {
				factor = 2
				trait = kind
			}
			modifier = {
				factor = 2
				is_weak_trigger = yes
			}
			modifier = {
				factor = 3
				trait = craven
			}
			modifier = {
				factor = 2
				trait = content
			}
		}
		random_friend = {
			limit = {
				trait = dragon
				age = 2
			}
			character_event = { id = dragon.1599 tooltip = TOOLTIPdragon.1599 }
		}
		set_character_flag = ran_from_dragon	
	}
	option = {
		name = "EVTOPTDdragon.12" #later
		ai_chance = {
			factor = 0.5
		}
		#clr_character_flag = choose_wild_dragon_action
	}
	
}
# Citadel Determine if dragon tamed
character_event = { #scope to dragon
	id = dragon.1399
	
	is_triggered_only = yes
	hide_window = yes
	
	trigger = { trait = dragon }
	
	immediate = {
		hidden_tooltip = { c_the_citadel = { holder_scope = { character_event = { id = dragon.13 } } } }
	}
	
	option = {
		name = OK
	}
}	
character_event = {
	id = dragon.13
	is_triggered_only = yes
	desc = "EVTDESCdragon.13"
	
	# Nobody but the actual referee should ever get this
	trigger = {
		has_landed_title = c_the_citadel 
		NOT = { FROM = { any_friend = { NOT = { character = ROOT_FROMFROM } } } }
	}
	
	#tamed
	option = {
		name = "TAMED"
		ai_chance = {
			factor = 1
			
			modifier = {
				factor = 25
				has_game_rule = { name = dragon_hatching_taming value = easy }
			}
			modifier = {
				factor = 5
				has_game_rule = { name = dragon_hatching_taming value = less_hard }
			}
			modifier = {
				factor = 0.33
				has_game_rule = { name = dragon_hatching_taming value = hard }
			}
			##Tamer Factors##
			modifier = {
				factor = 5
				FROM = { FROM = { any_dynasty_member = { at_location = PREV is_alive = yes can_use_dragon_abilities_trigger = yes } } }
			}
			modifier = {
				factor = 2
				FROM = { FROM = {  trait = authoritative } }
			}
			modifier = {
				factor = 2
				FROM = { FROM = {  is_strong_trigger = yes } }
			}
			modifier = {
				factor = 2
				FROM = { FROM = {  trait = brave } }
			}
			modifier = {
				factor = 3
				FROM = { FROM = {  trait = genius } }
			}
			modifier = {
				factor = 1.5
				FROM = { FROM = {  is_smart_trigger = yes } }
			}	
			#The Dragon recognises me because im a pureborn targ			
			modifier = { 
				factor = 5
				FROM = {
					FROM = {  
						has_character_modifier = abomination_of_incest
						OR = {
							culture_group = valyrian
							has_silver_hair_ethnicity_trigger = yes
						}
					}
				}	
			}
			modifier = { 
				factor = 2.5
				FROM = {
					FROM = {  
						has_character_modifier = grandchild_of_incest
						OR = {
							culture_group = valyrian
							has_silver_hair_ethnicity_trigger = yes
						}
					}
				}	
			}
			modifier = {
				factor = 2.5
				FROM = { 
					FROM = { 
						any_owned_bloodline = { has_bloodline_flag = blood_of_the_dragon }
					} 
				}
			}
			modifier = {
				factor = 5
				FROM = { FROM = {  has_character_flag = daenerys_targaryen  } }
			}
			modifier = {
				factor = 6
				FROM = { 
					FROM = {  
						OR = {			
							culture = high_valyrian 
							graphical_culture = valyriangfx
						}
					} 
				}
			}
			modifier = {
				factor = 5
				FROM = { FROM = {  religion_group = valyrian_rel_group  } }
			}
			modifier = {
				factor = 2.5
				FROM = { FROM = {  culture = asshai  } }
			}
			modifier = {
				factor = 3
				FROM = { FROM = {  has_character_flag = dragon_intel_citadel  } }
			}
			modifier = {
				factor = 5
				FROM = { 
					FROM = {  
						OR = {
							culture_group = valyrian
							has_silver_hair_ethnicity_trigger = yes
						}
					} 
				}
			}
			modifier = {
				factor = 1.5
				FROM = { FROM = {  religion = rhllor  } }
			}
			modifier = {
				factor = 3
				FROM = { FROM = {  trait = favored_by_rhllor  } }
			}
			modifier = {
				factor = 10
				FROM = { FROM = {  trait = chosen_by_rhllor  } }
			}
			modifier = {
				factor = 1.5
				FROM = { FROM = {  has_character_flag = dragon_intel_harrenhal  } }
			}
			modifier = {
				factor = 1.5
				FROM = { FROM = {  has_character_flag = dragon_intel_dragonstone  } }
			}
			modifier = {
				factor = 2.5
				FROM = { FROM = {  has_character_flag = dragon_intel_dragonpit  } }
			}	
			modifier = {
				factor = 1.5
				FROM = { FROM = { has_character_flag = dragon_intel_old_ghis } }
			}
			modifier = {
				factor = 1.5
				FROM = { FROM = { has_character_flag = dragon_intel_volantis } }
			}
			modifier = {
				factor = 2.5
				FROM = { FROM = { has_character_flag = dragon_intel_smoking_sea } }
			}	
			modifier = {
				factor = 1.5
				FROM = { FROM = { has_character_flag = dragon_intel_asshai } }
			}
			modifier = {
				factor = 1.5
				FROM = { FROM = { has_character_flag = dragon_intel_dynamic } }
			}
			modifier = {
				factor = 2
				FROM = { FROM = { has_character_flag = dragon_intel_rebirth } }
			}
			#Demon Child
			modifier = {
				factor = 20
				FROM = { FROM = { has_character_flag = demon_child_non_pagan } }
			}	
			#Books
			modifier = {
				factor = 3
				FROMFROM = { any_artifact = { artifact_type = book_blood_and_fire is_artifact_active = yes } }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { any_artifact = { artifact_type = book_dragons_wyrms_and_wyverns is_artifact_active = yes } }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { any_artifact = { artifact_type = book_fires_of_the_freehold is_artifact_active = yes } }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { any_artifact = { artifact_type = dragonbone_whip is_artifact_active = yes } }
			}
			
			##Dragon Factors##	
			modifier = {
				factor = 5
				FROM = { has_character_modifier = locked_in_dragonpit } 
			}			
			modifier = {
				factor = 5
				FROM = { has_character_flag = tamed_dragon }
			}
			modifier = {
				factor = 1.5
				FROM = { NOT = { martial = 20 } }
			}
			modifier = {
				factor = 0.9
				FROM = { martial = 40 } 
			}
			modifier = {
				factor = 0.8
				FROM = { martial = 60 } 
			}
			modifier = {
				factor = 0.75
				FROM = { martial = 80 } 
			}
			modifier = {
				factor = 2
				FROM = { trait = obedient_dragon }
			}	
			modifier = {
				factor = 0.5
				FROM = { trait = wroth_dragon }
			}
			modifier = {
				factor = 1.5
				FROM = { trait = playful_dragon }
			}
			modifier = {
				factor = 0.5
				FROM = { trait = lunatic_dragon }
			}	
			modifier = {
				factor = 1.5
				FROM = { trait = wounded_dragon }
			}			
			modifier = {
				factor = 2
				FROM = { trait = maimed_dragon }
			}
			modifier = {
				factor = 2
				FROM = { trait = sickly_dragon }
			}
			modifier = {
				factor = 2
				FROM = { trait = affectionate_dragon }
			}			
		}
		FROMFROM = {		
			if = {
				limit = { ROOT_FROM = { NOT = { any_friend = { NOT = { character = ROOT_FROMFROM } } } } }
				set_character_flag = tamed_dragon
				add_friend = ROOT_FROM
				character_event = { id = dragon.14 }		
			}	
			clr_character_flag = inherited_dragon			
		}		
	}
	#not tamed
	option = {	
		name = "NOT TAMED"
		ai_chance = {
			factor = 125
			modifier = {
				factor = 2
				FROM = { FROM = {  is_weak_trigger = yes } }
			}
			modifier = {
				factor = 2
				FROM = { FROM = {  trait = craven } }
			}
			modifier = {
				factor = 3
				FROM = { FROM = {  trait = imbecile } }
			}
			modifier = {
				factor = 1.5
				FROM = { FROM = {  is_dumb_trigger = yes } }
			}
			#not my dragon, harder to tame
			modifier = {
				factor = 1.5
				NOT = { FROM = { FROM = { is_friend = FROM } } }
			}
		}
		FROM = {
			FROM = {
				set_character_flag = not_tamed_dragon
				character_event = { id = dragon.15 } 
			}
			clr_character_flag = found_wild_dragon
		}	
	}
}
#wild dragon tamed
character_event = {
	id = dragon.14
	desc = "EVTDESCdragon.14"
	is_triggered_only = yes
	picture = "GFX_evt_dragon_riding_1"
	
	show_from_from = yes
	
	trigger = {
		has_character_flag = tamed_dragon
		FROMFROM = { NOT = { any_friend = { NOT = { character = ROOT } } } }
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
	}
	
	immediate = {
		if = { #triggered from valyrian quest, resume quest chain
			limit = { has_character_flag = valyrian_quest_taming }
			clr_character_flag = valyrian_quest_taming
			character_event = { id = wikid.102 days = 2 }
		}
		if = { #Check for new dragon riding dynasty
			limit = {
				NOT = { dynasty = 0 }
				NOT = { has_dynasty_flag = dragon_riding_dynasty }
				dynasty_head = { character = ROOT }
			}
			set_dynasty_flag = dragon_riding_dynasty
		}
	}
	
	option = {
		name = "EVTOPTAdragon.14"	
		add_trait = dragon_rider
		top_liege = {		
			if = {
				limit = { #give weak claim on top liege title
					OR = {
						culture_group = ROOT
						religion_group = ROOT
						ROOT = { culture = high_valyrian }					
					}	
					NOT = { character = ROOT }
					primary_title = { NOT = { ROOT = { has_claim = PREV } } }
					is_republic = no
					is_valyrian_freehold_trigger = no
				}
				primary_title = { add_weak_claim = ROOT }
			}		
		}
		# if = {
			# limit = {
				# NOT = { 
					# any_liege = { 
						# OR = {
							# tier = EMPEROR
							# can_use_dragon_abilities_trigger = yes 
						# }	
					# } 
				# }
				# demesne_size = 1
				# NOT = { tier = BARON }
				# independent = no
				# is_patrician = no
			# }
			# set_defacto_liege = ROOT
			# #set_character_flag = new_dragon_lord
		# }
		if = { #Move baron courtiers to province owner
			limit = {
				is_ruler = no
				liege = { 
					tier = BARON 
					is_patrician = no 
				}
			}
			liege = { liege = { ROOT = { move_character = PREV } } }
		}
		set_immune_to_pruning = yes
		hidden_tooltip = { FROMFROM = { character_event = { id = dragon.1499 } } }
	}	
}
character_event = { #set dragon scope
	id = dragon.1499
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		NOT = { any_friend = { NOT = { character = ROOT_FROM } } }
	}
	
	immediate = {
		FROM = {
			if = {
				limit = { ai = no }
				chronicle = {
					entry = CHRONICLE_TAMED_DRAGON
					portrait = [Root.GetID]
				}
			}
		}
		set_character_flag = tamed_dragon
		clr_character_flag = shadow_lands_dragon
		#remove_character_modifier = locked_in_dragonpit
		FROM = {
			if = {
				limit = {	
					NOT = { has_character_flag = found_wild_dragon }
				}
				any_player = { #inform world
					limit = { 
						NOT = { character = PREV }
					}
					character_event = { id = dragon.17 }
				}
			}
			if = {
				limit = {	
					has_character_flag = found_wild_dragon
				}
				add_friend = ROOT
				if = {
					limit = { is_ruler = yes }
					ROOT = { move_character = PREV }
				}
				if = {
					limit = { is_ruler = no }
					liege = { ROOT = { move_character = PREV } }
				}
				location = { province_event = { id = dragon.24 } }
				any_player = { #inform world
					limit = { 
						NOT = { character = PREV }
					}
					set_character_flag = from_found_wild_dragon
					character_event = { id = dragon.17 }
				}
				clr_character_flag = found_wild_dragon
				ROOT = {
					clr_character_flag = has_dragon_location 
					random_province = {
						limit = { ROOT = { has_character_flag = dragon_location_@PREV } }
						ROOT = { clr_character_flag = dragon_location_@PREV }
					}
				}
			}			
			clr_character_flag = tamed_dragon
		}	
		clr_character_flag = found_wild_dragon
		
		if = {
			limit = { 
				any_artifact = { artifact_type = dragons_whip } 	
			}
			random_artifact = { 
				limit = { artifact_type = dragons_whip }
				transfer_artifact = { from = ROOT to = FROM }
			}
		}
		else_if = {
			limit = {
				NOT = { persistent_event_target:whip = { owner = { always = yes } } }
			}
			FROM = {
				add_artifact = dragons_whip
				new_artifact = { 
					set_name = [Root.GetDragonWhipName]
					ROOT = { save_persistent_event_target = { name = whip scope = PREV } }
				}
			}
		}
		else_if = {
			limit = { NOT = { persistent_event_target:whip = { owner = { character = FROM } } } }
			persistent_event_target:whip = {
				transfer_artifact = { from = owner to = FROM }
			}
		}
	}

	option = {
		name = OK
	}
}	
#wild dragon not tamed
character_event = {
	id = dragon.15
	desc = "EVTDESCdragon.15"
	is_triggered_only = yes
	picture = "GFX_evt_dragon_flame_death"
	
	show_from_from = yes
	
	trigger = {
		has_character_flag = not_tamed_dragon
	}
	
	option = {
		name = "EVTOPTAdragon.15"
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_TAMED_DRAGON_FAIL
				portrait = [FromFrom.GetID]
			}
		}
		clr_character_flag = not_tamed_dragon
		random_friend = {
			limit = { character = FROMFROM }
			tooltip = { remove_friend = ROOT }
		}
		prestige = -100
		hidden_tooltip = { FROM = { FROM = { character_event = { id = dragon.1599 } } } }
		if = { #triggered from valyrian quest, always die
			limit = { has_character_flag = valyrian_quest_taming }
			event_target:wikid_companion = {
				death = { death_reason = death_missing }
			}
			clr_global_flag = someone_doing_valyrian_sword	
			hidden_tooltip = { add_trait = fed_to_dragon }
			death = { 
				death_reason = death_dragon
				killer = FROMFROM
			}
			hidden_tooltip = {
				FROMFROM = {
					death = { death_reason = death_missing }
				}
			}
		}			
		if = {
			limit = { NOT = { has_character_flag = valyrian_quest_taming } }	
			random_list = {
				20 = {
					hidden_tooltip = { add_trait = fed_to_dragon }
					red_god_resurrect_effect = yes #check for rhllor resurrection
					death = { 
						death_reason = death_dragon
						killer = FROMFROM
					}
				}
				50 = {
					add_trait_silently_wounded_effect = yes
					hidden_tooltip = {
						character_event ={
							id = 38280 #Notify
						}
					}
				}
				15 = {
					add_maimed_trait_effect = yes
				}
				15 = {
					trigger = { NOT = { trait = burned } }
					add_trait = burned
					hidden_tooltip = { character_event = { id = trait_notification.23 } }					
				}
			}
		}	
	}	
}
character_event = { #set dragon scope
	id = dragon.1599
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		location = { province_event = { id = dragon.22 } } #Dragon establishes lair					
		if = {
			limit = {
				NOT = { is_friend = FROM }
				NOT = { has_character_flag = shadow_lands_dragon }
			}
			any_playable_ruler = { #inform world
				limit = { 
					ai = no 
					NOT = { character = FROM }
					OR = {
						at_location = ROOT
						is_close_relative = FROM
					}	
				}
				character_event = { id = dragon.19 }
			}		
		}
		if = {
			limit = {
				is_friend = FROM
			}
			any_playable_ruler = { #inform world
				limit = { 
					ai = no 
					NOT = { character = FROM }
				}
				character_event = { id = dragon.18 }
			}
			remove_friend = FROM
			persistent_event_target:whip = { transfer_artifact = { from = FROM to = ROOT } }
		}	
	}

	option = {
		name = OK
	}
}	
#dragon slain own notfication
# character_event = {
	# id = dragon.16
	# desc = "EVTDESCdragon.16"
	# picture = "GFX_valyria_dragon"
	
	# is_triggered_only = yes
	# show_from_from = yes
	
	# option = {
		# name = "EVTOPTAdragon.16"
		# FROM = {
			# FROM = {
				# hidden_tooltip = {
					# prestige = 0
				# }
			# }
		# }	
	# }
# }
#World dragon tamed notfication
character_event = {
	id = dragon.17
	picture = "GFX_tamingdragon"
	
	desc = {
		text = "EVTDESCdragon.17"
		trigger = {
			NOT = { 
				FROMFROMFROM = {
					any_artifact = {
						has_artifact_flag = dragonhorn
						is_artifact_active = yes
					}
				} 
			}
		}
	}	
	desc = {
		text = "EVTDESCdragon.17B" #used dragonhorn
		trigger = {
			FROMFROMFROM = { 
				any_artifact = {
					has_artifact_flag = dragonhorn
					is_artifact_active = yes
				}
			}
		}
	}
	is_triggered_only = yes
	
	show_from_from = yes
	
	trigger = {
		NOT = { character = FROMFROM }
		OR = {
			NOT = { has_global_flag = age_of_dragons }
			has_character_flag = from_found_wild_dragon
		}
		NOT = { has_character_flag = no_dragon_taming_inform }
	}
	
	immediate = { 
		clr_character_flag = from_found_wild_dragon 
		if = {
			limit = {
				OR = {		
					dynasty = FROMFROM
					is_liege_or_above = FROMFROM
					is_close_relative = FROMFROM
					is_vassal_or_below = FROMFROM
				}
			}
			chronicle = {
				entry = CHRONICLE_TAMED_DRAGON_FROM
				portrait = [From.GetID]
			}
		}
	}
	
	option = {
		name = {
			text = "EVTOPTAdragon.17"	
			trigger = {
				NOR = {
					has_global_flag = age_of_dragons
					can_use_dragon_abilities_trigger = yes
				}
			}
		}	
		name = {
			text = "EVTOPTBdragon.17"	
			trigger = {
				OR = {
					has_global_flag = age_of_dragons
					can_use_dragon_abilities_trigger = yes
				}
			}
		}	
		show_portrait = FROM
		show_portrait = FROMFROMFROM
	}
	option = {
		name = "EVTOPTBdragon.1198"	
		set_character_flag = no_dragon_taming_inform
	}		
}
#dragon escaped first notfication
character_event = {
	id = dragon.18
	desc = "EVTDESCdragon.18"
	picture = "GFX_evt_dragon_battle"
	
	is_triggered_only = yes
	show_from_from = yes
	
	trigger = { NOT = { has_character_flag = no_dragon_lair_inform } }

	option = {
		name = "EVTOPTAdragon.18"	
		FROM = { tooltip = { show_portrait = yes } }
		chronicle = {
			entry = CHRONICLE_TAMED_DRAGON_FAIL_FROM
			portrait = [FromFrom.GetID]
		}
	}
	option = {
		name = "EVTOPTBdragon.1198"	
		set_character_flag = no_dragon_lair_inform
	}	
}
#dragon escaped continuos notfication
character_event = {
	id = dragon.19
	desc = "EVTDESCdragon.19"
	picture = "GFX_evt_dragon_battle"
	
	is_triggered_only = yes
	show_from_from = yes

	option = {
		name = "EVTOPTAdragon.19"	
		ai_chance = {
			factor = 1
		}	
		FROM = { tooltip = { show_portrait = yes } }
		chronicle = {
			entry = CHRONICLE_TAMED_DRAGON_FAIL_FROM
			portrait = [FromFrom.GetID]
		}
	}
	option = {
		name = EVTOPTDdragon.87 #I shall isolate it in the dragonpit
		trigger = {
			FROM = { 
				NOT = { any_friend = { can_use_dragon_abilities_trigger = yes } } 
				NOT = { has_character_modifier = locked_in_dragonpit }
				OR = {
					liege = { character = ROOT }
					liege = {
						tier = BARON
						liege = { character = ROOT }
					}
				}
			}
			owner = {
				character = ROOT
				OR = {
					is_adult = yes
					can_use_dragon_abilities_trigger = yes
				}
				NOT = { has_severe_disability_trigger = yes}
				in_command = no
				has_dragonpit_trigger = yes
			}	
		}
		ai_chance = {
			factor = 0.05
			modifier = {
				factor = 20
				owner = { can_use_dragon_abilities_trigger = yes }
			}
			modifier = {
				factor = 0
				owner = { trait = craven }
			}
			modifier = {
				factor = 2
				owner = { trait = brave }
			}
		}	
		owner = { character_event = { id = dragon.2398 tooltip = TOOLTIPdragon.2799 days = 1 } }
	}
	option = {
		name = EVTOPTEdragon.87 #Send marshal to isolate it in the dragonpit
		trigger = {			
			FROM = { 
				NOT = { any_friend = { can_use_dragon_abilities_trigger = yes } } 
				NOT = { has_character_modifier = locked_in_dragonpit }
				OR = {
					liege = { character = ROOT }
					liege = {
						tier = BARON
						liege = { character = ROOT }
					}
				}
			}
			owner = { 
				is_ruler = yes
				character = ROOT
				job_marshal = {
					NOT = { has_severe_disability_trigger = yes}
				}	
				has_dragonpit_trigger = yes
			}	
		}
		ai_chance = {
			factor = 0.1
			modifier = {
				factor = 10
				owner = { job_marshal = { can_use_dragon_abilities_trigger = yes } }
			}
		}	
		owner = { 
			save_event_target_as = commanding_liege 
			job_marshal = {
				character_event = { id = dragon.2398 tooltip = TOOLTIPdragon.2398 }
			}
		}		
	}
}
# #Inform Dragon inherited
# character_event = {
	# id = dragon.20
	# desc = "EVTDESCdragon.20"
	# picture = "GFX_siegeoffire"
	
	# is_triggered_only = yes
	
	# option = {
		# name = OK
		# random_friend = {
			# limit = { trait = dragon }
			# tooltip = { show_portrait = yes }
		# }		
	# }
# }
#Inform Dragon egg inherited
character_event = {
	id = dragon.21
	desc = "EVTDESCdragon.21"
	picture = "GFX_targaryen_eggs" 
	
	is_triggered_only = yes
	
	option = {
		name = OK
		tooltip = { 
			event_target:dragon_egg_to_inherit = {
				transfer_artifact = { from = FROM to = ROOT }
			}
		}
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_INHERITED_DRAGON_EGG
				picture = GFX_targaryen_eggs
			}
		}	
	}
}
#inform Dany given you dragon
character_event = {
	id = dragon.400
	desc = "EVTDESCdragon.400"
	picture = "GFX_evt_dragon_angry"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.400"
		random_friend = {
			limit = { trait = dragon is_alive = yes }
			tooltip = { add_friend = ROOT }
			ROOT = {
				chronicle = {
					entry = CHRONICLE_GIVEN_DRAGON
					portrait = [Prev.GetID]
				}
			}
		}
		prestige = 100
	}
}
#Inform Dragon egg given
character_event = {
	id = dragon.401
	desc = "EVTDESCdragon.401"
	picture = "GFX_targaryen_eggs" 
	
	is_triggered_only = yes
	show_from_from = yes
	
	option = {
		name = EVTOPTAdragon.401
		event_target:dragon_egg_to_transfer = {
			transfer_artifact = { from = FROMFROM to = ROOT }
		}	
	}
}
###Dragon Lair/Province Events###
#dragon lair established
province_event = {
	id = dragon.22
	desc = "EVTDESCdragon.22"
	picture = "GFX_evt_dragon_angry"

	is_triggered_only = yes
	
	trigger = {
		NOT = {  has_province_modifier = dragon_lair }
	}
	option = {
		name = "EVTOPTAdragon.22"		
		FROM = { FROM = { tooltip = { show_portrait = yes } } }
	}
	option = {
		name = EVTOPTDdragon.87 #I shall isolate it in the dragonpit
		trigger = {
			FROM = { 
				NOT = { any_friend = { can_use_dragon_abilities_trigger = yes } } 
				NOT = { has_character_modifier = locked_in_dragonpit }
				OR = {
					liege = { character = ROOT }
					liege = {
						tier = BARON
						liege = { character = ROOT }
					}
				}
			}
			owner = {
				character = ROOT
				OR = {
					is_adult = yes
					can_use_dragon_abilities_trigger = yes
				}
				NOT = { has_severe_disability_trigger = yes}
				in_command = no
				has_dragonpit_trigger = yes
			}	
		}
		ai_chance = {
			factor = 0.05
			modifier = {
				factor = 20
				owner = { can_use_dragon_abilities_trigger = yes }
			}
			modifier = {
				factor = 0
				owner = { trait = craven }
			}
			modifier = {
				factor = 2
				owner = { trait = brave }
			}
		}	
		owner = { character_event = { id = dragon.2398 tooltip = TOOLTIPdragon.2799 days = 1 } }
	}
	option = {
		name = EVTOPTEdragon.87 #Send marshal to isolate it in the dragonpit
		trigger = {			
			FROM = { 
				NOT = { any_friend = { can_use_dragon_abilities_trigger = yes } } 
				NOT = { has_character_modifier = locked_in_dragonpit }
				OR = {
					liege = { character = ROOT }
					liege = {
						tier = BARON
						liege = { character = ROOT }
					}
				}
			}
			owner = { 
				is_ruler = yes
				character = ROOT
				job_marshal = {
					NOT = { has_severe_disability_trigger = yes}
				}	
				has_dragonpit_trigger = yes
			}	
		}
		ai_chance = {
			factor = 0.1
			modifier = {
				factor = 10
				owner = { job_marshal = { can_use_dragon_abilities_trigger = yes } }
			}
		}	
		owner = { 
			save_event_target_as = commanding_liege 
			job_marshal = {
				character_event = { id = dragon.2398 tooltip = TOOLTIPdragon.2398 }
			}
		}		
	}
}
character_event = { #self sent
	id = dragon.2398

	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		set_character_flag = capture_dragon
		FROMFROM = { character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 days = 1 } }
	}
}	
character_event = { #marshall sent
	id = dragon.2399
	desc = "EVTDESCdragon.2399"
	picture = "GFX_evt_dragon_angry"

	is_triggered_only = yes
	
	option = {
		name = EVTOPTAdragon.2399
		set_character_flag = capture_dragon
		FROMFROM = { character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 days = 1 } }
	}
	option = { #refuse
		trigger = { ai = no }
		name = EVTOPTBdragon.2399
		prestige = -100
		remove_title = job_marsal
		FROM = { opinion = { who = ROOT modifier = opinion_refused_order } }
	}
}	
#dragon lair established after owner's death
character_event = {
	id = dragon.2399

	is_triggered_only = yes
	hide_window = yes
	
	immediate = { 
		remove_trait = dragon #This ensures the dragon is 'immortal'
		add_trait = dragon
		
		#Check recorded location
		if = {
			limit = { 
				has_character_flag = has_dragon_location 
				liege = {
					capital_scope = {
						ROOT = { 
							NOT = { has_character_flag = dragon_location_@PREV }
						}
					}
				}
			}
			random_province = {
				limit = { ROOT = { has_character_flag = dragon_location_@PREV } }
				random_province_lord = {
					limit = { tier = BARON }
					ROOT = { move_character = PREV }
				}
			}
		}
		
		if = { #If location is off map move on map
			limit = {
				liege = { NOT = { demesne_size = 1 } }				
			}
			random_playable_ruler = {
				limit = {
					is_alive = yes
					demesne_size = 1
					dynasty = FROM
					is_close_relative = FROM
				}
				ROOT = { move_character = PREV }
				break = yes
			}	
			random_playable_ruler = {
				limit = {
					is_alive = yes
					demesne_size = 1
					dynasty = FROM
				}
				ROOT = { move_character = PREV }
				break = yes
			}			
			random_province = { #Volcano
				limit = {
					is_volcano_location_trigger = yes
					ROOT = {
						location = {
							NOT = { distance = { where = PREVPREV value = 1000 } }
						}
					}
				}
				random_province_lord = {
					limit = { tier = BARON }
					ROOT = { move_character = PREV }
					break = yes
				}
				random_province_lord = {
					ROOT = { move_character = PREV }
					break = yes
				}
			}	
			random_playable_ruler = {
				limit = {
					is_alive = yes
					demesne_size = 1
					culture_group = FROM
				}
				ROOT = { move_character = PREV }
				break = yes
			}
		}
		if = { #Chance of being locked in dragonpit
			limit = {
				NOT = { has_character_modifier = locked_in_dragonpit }				
				liege = { 
					has_dragonpit_trigger = yes
				}
			}
			random = {
				chance = 80
				add_character_modifier = {
					name = locked_in_dragonpit
					duration = -1
				}	
			}
			break = yes
		}		
		if = { #In dragonpit, stay here?
			limit = {
				has_character_modifier = locked_in_dragonpit				
			}
			if = { 
				limit = {			
					liege = { 
						has_dragonpit_trigger = yes
					}
				}
				break = yes
			}
			remove_character_modifier = locked_in_dragonpit
		}
		
		if = { #33% Chance of flying to nearby volcano if not in dragonpit
			limit = {	
				NOT = { has_character_modifier = locked_in_dragonpit }			
			}
			random = {
				chance = 33
				random_province = {
					limit = {
						is_volcano_location_trigger = yes
						ROOT = {
							location = {
								NOT = { distance = { where = PREVPREV value = 1000 } }
							}
						}
					}
					random_province_lord = {
						limit = { tier = BARON }
						ROOT = { move_character = PREV }
						break = yes
					}
					random_province_lord = {
						ROOT = { move_character = PREV }
						break = yes
					}
				}
			}
		}
		if = { #25% Chance of flying to volcano if not in dragonpit and owner of volcano is same dynasty as previous owner
			limit = {	
				NOT = { has_character_modifier = locked_in_dragonpit }
			}
			random = {
				chance = 25
				random_province = {
					limit = {
						is_volcano_location_trigger = yes
						owner = { dynasty = FROM }
					}
					random_province_lord = {
						limit = { tier = BARON }
						ROOT = { move_character = PREV }
						break = yes
					}
					random_province_lord = {
						ROOT = { move_character = PREV }
						break = yes
					}
				}
			}		
		}
		if = { #25% Chance of flying to court of same dynasty as previous owner
			limit = {
				liege = { NOT = { dynasty = FROM } }
				FROM = { NOT = { dynasty = 0 } }
				NOT = { has_character_modifier = locked_in_dragonpit }
			}
			random = {
				chance = 25
				random_playable_ruler = {
					limit = {
						is_alive = yes
						demesne_size = 1
						dynasty = FROM
					}
					ROOT = { move_character = PREV }
					break = yes
				}
			}		
		}	
		
		#Set final location flags
		random_province = {
			limit = { ROOT = { has_character_flag = dragon_location_@PREV } }
			ROOT = { clr_character_flag = dragon_location_@PREV }
		}
		liege = {
			capital_scope = {
				ROOT = { 
					set_character_flag = has_dragon_location
					set_character_flag = dragon_location_@PREV 
				}
			}
		}
	}
	
	option = {
		name = "OK"		
		if = { #Finally move dragon to sub barony in province
			limit = { 
				liege = { NOT = { tier = BARON } } 
				NOT = { has_character_modifier = locked_in_dragonpit }	
			}
			liege = {
				capital_scope = {
					random_province_lord = {
						limit = { tier = BARON }
						ROOT = { move_character = PREV }
					}
				}
			}
		}	
		location = { province_event = { id = dragon.23 } } 
	}
}
province_event = {
	id = dragon.23
	desc = "EVTDESCdragon.23"
	picture = "GFX_evt_dragon_angry"

	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.22"	
		FROM = { FROM = { tooltip = { show_portrait = yes } } }
	}
}
#dragon lair removed
province_event = {
	id = dragon.24
	desc = "EVTDESCdragon.24"
	picture = "GFX_evt_dragon_angry"
	#hide_from = yes
	is_triggered_only = yes
	
	trigger = {
		 has_province_modifier = dragon_lair
	}
	option = {
		name = "EVTOPTAdragon.24"
		remove_province_modifier = dragon_lair
	}
	
}
#add burned land
province_event = {
	id = dragon.25
	desc = "EVTDESCdragon.25"
	picture = "GFX_evt_dragon_battle"

	is_triggered_only = yes
	
	immediate = {
		any_province_lord = {
			limit = {
				NOT = { character = FROM }
			}
			opinion = {
				modifier = opinion_upset  
				who = FROM
				years = 6
			}
			any_courtier = {
				opinion = {
					modifier = opinion_upset   
					who = FROM
					years = 6
				}
			}
		}
	}

	option = {
		name = "EVTOPTAdragon.25"
		FROM = {
			random_friend = {
				limit = {
					trait = dragon
					age = 2
				}
				tooltip = { show_portrait = yes }
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = burned1 }
				has_province_modifier = burned2
				NOT = {  has_province_modifier = burned3 }
			}		
			hidden_tooltip = {  remove_province_modifier = burned2 }
			add_province_modifier = {
				name = burned3
				duration = 1500
			}		
		}
		if = {
			limit = {
				NOT = {  has_province_modifier = burned2 }
				has_province_modifier = burned1
				NOT = {  has_province_modifier = burned3 }
			}
			
			hidden_tooltip = { remove_province_modifier = burned1 }
			add_province_modifier = {
				name = burned2
				duration = 1500
			}				
		}
		if = {
			limit = {
				NOT = {  has_province_modifier = burned1 }
				NOT = {  has_province_modifier = burned2 }
				NOT = {  has_province_modifier = burned3 }
			}		
			add_province_modifier = {
				name = burned1
				duration = 1500
			}		
		}
		hidden_tooltip = { remove_province_modifier = burning }
		add_province_modifier = {
			name = burning
			duration = 90
		}
	}
}
###Encountered wild escaped dragon###
character_event = { #Choose dragon
	id = dragon.2699
	desc = "EVTDESCdragon.2699"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	immediate = {
		set_character_flag = found_wild_dragon
		#location = { set_province_flag = face_dragon }
		
		calculate_dragon_preference_effect = yes
		
		clear_event_target = dragon_1
		clear_event_target = dragon_2
		clear_event_target = dragon_3
		clear_event_target = dragon_4
		dragon = {		
			limit = {
				is_alive = yes
				OR = {
					at_location = ROOT
					location = { 
						owner = { 
							is_liege_of = ROOT 
							has_character_modifier = calling_for_dragon_riders
							ROOT = { NOT = { tier = KING } }
							opinion = { who = ROOT value = -24 }
							reverse_opinion = { who = ROOT value = -24 }
						} 
					}
				}				
				OR = {
					NOT = { educator = { always = yes } } 
					location = { any_province_lord = { is_liege_of = PREVPREV } }
				}
				NOT = { num_of_friends = 1 }
				NOT = { has_character_flag = dany_dragon }
				OR = {
					NOT = { has_character_flag = found_wild_dragon }
					had_character_flag = { flag = found_wild_dragon days = 30 }
				}
				is_ruler = no
				NOT = { liege = { graphical_culture = dragongfx } }
			}
			set_character_flag = found_wild_dragon
			save_event_target_as = dragon_1	
		}
		dragon = {		
			limit = {
				is_alive = yes
				OR = {
					at_location = ROOT
					location = { 
						owner = { 
							is_liege_of = ROOT 
							has_character_modifier = calling_for_dragon_riders
							ROOT = { NOT = { tier = KING } }
							opinion = { who = ROOT value = -24 }
							reverse_opinion = { who = ROOT value = -24 }
						} 
					}
				}
				OR = {
					NOT = { educator = { always = yes } } 
					location = { any_province_lord = { is_liege_of = PREVPREV } }
				}
				NOT = { num_of_friends = 1 }
				NOT = { has_character_flag = dany_dragon }
				OR = {
					NOT = { has_character_flag = found_wild_dragon }
					had_character_flag = { flag = found_wild_dragon days = 30 }
				}
				is_ruler = no
				NOT = { liege = { graphical_culture = dragongfx } }
			}
			set_character_flag = found_wild_dragon
			save_event_target_as = dragon_2
		}
		dragon = {		
			limit = {
				is_alive = yes
				OR = {
					at_location = ROOT
					location = { 
						owner = { 
							is_liege_of = ROOT 
							has_character_modifier = calling_for_dragon_riders
							ROOT = { NOT = { tier = KING } }
							opinion = { who = ROOT value = -24 }
							reverse_opinion = { who = ROOT value = -24 }
						} 
					}
				}
				OR = {
					NOT = { educator = { always = yes } } 
					location = { any_province_lord = { is_liege_of = PREVPREV } }
				}
				NOT = { num_of_friends = 1 }
				NOT = { has_character_flag = dany_dragon }
				OR = {
					NOT = { has_character_flag = found_wild_dragon }
					had_character_flag = { flag = found_wild_dragon days = 30 }
				}
				is_ruler = no
				NOT = { liege = { graphical_culture = dragongfx } }
			}
			set_character_flag = found_wild_dragon
			save_event_target_as = dragon_3	
		}
		dragon = {		
			limit = {
				is_alive = yes
				OR = {
					at_location = ROOT
					location = { 
						owner = { 
							is_liege_of = ROOT 
							has_character_modifier = calling_for_dragon_riders
							ROOT = { NOT = { tier = KING } }
							opinion = { who = ROOT value = -24 }
							reverse_opinion = { who = ROOT value = -24 }
						} 
					}
				}
				OR = {
					NOT = { educator = { always = yes } } 
					location = { any_province_lord = { is_liege_of = PREVPREV } }
				}
				NOT = { num_of_friends = 1 }
				NOT = { has_character_flag = dany_dragon }
				OR = {
					NOT = { has_character_flag = found_wild_dragon }
					had_character_flag = { flag = found_wild_dragon days = 30 }
				}
				is_ruler = no
				NOT = { liege = { graphical_culture = dragongfx } }
			}
			set_character_flag = found_wild_dragon
			save_event_target_as = dragon_4
		}
		if = { #if desires large dragon, add one
			limit = {
				has_character_flag = desires_large_dragon
			}
			dragon = {		
				limit = {
					is_alive = yes
					OR = {
						at_location = ROOT
						location = { 
							owner = {
								OR = {
									dynasty = ROOT
									is_liege_or_above = ROOT
									AND = {
										is_liege_of = ROOT 
										has_character_modifier = calling_for_dragon_riders
										ROOT = { NOT = { tier = KING } }
										opinion = { who = ROOT value = -24 }
										reverse_opinion = { who = ROOT value = -24 }
									}
								}
							}
						}
					}	
					martial = 70
					OR = {
						NOT = { educator = { always = yes } } 
						location = { any_province_lord = { is_liege_of = PREVPREV } }
					}
					NOT = { num_of_friends = 1 }
					NOT = { has_character_flag = dany_dragon }
					OR = {
						NOT = { has_character_flag = found_wild_dragon }
						had_character_flag = { flag = found_wild_dragon days = 30 }
					}
					is_ruler = no
					NOT = { liege = { graphical_culture = dragongfx } }
				}
				set_character_flag = found_wild_dragon
				event_target:dragon_4 = { clr_character_flag = found_wild_dragon }
				save_event_target_as = dragon_4
			}
		}
		clr_character_flag = liege_called_for_dragons
	}
	
	option = {
		name = "EVTOPTAdragon.2699"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				has_character_flag = desires_large_dragon
				event_target:dragon_1 = { NOT = { martial = 70 } }
			}
			modifier = {
				factor = 0
				has_character_flag = desires_heir_dragon
				event_target:dragon_1 = { NOT = { martial = 90 } }
			}
			modifier = {
				factor = 0.5
				NOT = { has_character_flag = content_with_small_dragon }
				event_target:dragon_1 = { NOT = { martial = 50 } }
			}
			modifier = {
				factor = 0.5
				NOT = { has_character_flag = content_with_small_dragon }
				event_target:dragon_1 = { NOT = { martial = 25 } }
			}
			modifier = {
				factor = 0.5
				NOT = { has_character_flag = content_with_small_dragon }
				event_target:dragon_1 = { NOT = { martial = 10 } }
			}
			modifier = {
				factor = 0
				event_target:dragon_1 = {
					OR = {
						trait = shy_dragon
						has_character_flag = shadow_lands_dragon
					}
					NOT = { has_character_modifier = locked_in_dragonpit }
				}
			}
		}
		event_target:dragon_1 = {
			character_event = { id = dragon.2698 tooltip = TOOLTIPdragon.2698 days = 2 random = 1 }
		}	
		hidden_tooltip = {
			event_target:dragon_2 = { clr_character_flag = found_wild_dragon }
			event_target:dragon_3 = { clr_character_flag = found_wild_dragon }
			event_target:dragon_4 = { clr_character_flag = found_wild_dragon }
		}
	}
	option = {
		name = "EVTOPTBdragon.2699"
		ai_chance = {
			factor = 10
			
			modifier = {
				factor = 0
				has_character_flag = desires_large_dragon
				event_target:dragon_2 = { NOT = { martial = 70 } }
			}
			modifier = {
				factor = 0
				has_character_flag = desires_heir_dragon
				event_target:dragon_2 = { NOT = { martial = 90 } }
			}
			modifier = {
				factor = 0.5
				NOT = { has_character_flag = content_with_small_dragon }
				event_target:dragon_2 = { NOT = { martial = 50 } }
			}
			modifier = {
				factor = 0.5
				NOT = { has_character_flag = content_with_small_dragon }
				event_target:dragon_2 = { NOT = { martial = 25 } }
			}
			modifier = {
				factor = 0.5
				NOT = { has_character_flag = content_with_small_dragon }
				event_target:dragon_2 = { NOT = { martial = 10 } }
			}
			modifier = {
				factor = 0
				event_target:dragon_2 = {
					OR = {
						trait = shy_dragon
						has_character_flag = shadow_lands_dragon
					}
					NOT = { has_character_modifier = locked_in_dragonpit }
				}
			}
		}
		trigger = {
			event_target:dragon_2 = { always = yes }
		}
		event_target:dragon_2 = {
			character_event = { id = dragon.2698 tooltip = TOOLTIPdragon.2698 days = 2 random = 1 }
		}	
		hidden_tooltip = {
			event_target:dragon_1 = { clr_character_flag = found_wild_dragon }
			event_target:dragon_2 = { clr_character_flag = found_wild_dragon }
			event_target:dragon_3 = { clr_character_flag = found_wild_dragon }
			event_target:dragon_4 = { clr_character_flag = found_wild_dragon }
		}
	}
	option = {
		name = "EVTOPTCdragon.2699"
		ai_chance = {
			factor = 10
			
			modifier = {
				factor = 0
				has_character_flag = desires_large_dragon
				event_target:dragon_3 = { NOT = { martial = 70 } }
			}
			modifier = {
				factor = 0
				has_character_flag = desires_heir_dragon
				event_target:dragon_3 = { NOT = { martial = 90 } }
			}
			modifier = {
				factor = 0.5
				NOT = { has_character_flag = content_with_small_dragon }
				event_target:dragon_3 = { NOT = { martial = 50 } }
			}
			modifier = {
				factor = 0.5
				NOT = { has_character_flag = content_with_small_dragon }
				event_target:dragon_3 = { NOT = { martial = 25 } }
			}
			modifier = {
				factor = 0.5
				NOT = { has_character_flag = content_with_small_dragon }
				event_target:dragon_3 = { NOT = { martial = 10 } }
			}
			modifier = {
				factor = 0
				event_target:dragon_3 = {
					OR = {
						trait = shy_dragon
						has_character_flag = shadow_lands_dragon
					}
					NOT = { has_character_modifier = locked_in_dragonpit }
				}
			}
		}
		trigger = {
			event_target:dragon_3 = { always = yes }
		}
		event_target:dragon_3 = {
			character_event = { id = dragon.2698 tooltip = TOOLTIPdragon.2698 days = 2 random = 1 }
		}	
		hidden_tooltip = {
			event_target:dragon_1 = { clr_character_flag = found_wild_dragon }
			event_target:dragon_2 = { clr_character_flag = found_wild_dragon }
			event_target:dragon_4 = { clr_character_flag = found_wild_dragon }
		}
	}
	option = {
		name = "EVTOPTDdragon.2699"
		ai_chance = {
			factor = 10
			
			modifier = {
				factor = 0
				has_character_flag = desires_large_dragon
				event_target:dragon_4 = { NOT = { martial = 70 } }
			}
			modifier = {
				factor = 0
				has_character_flag = desires_heir_dragon
				event_target:dragon_4 = { NOT = { martial = 90 } }
			}
			modifier = {
				factor = 0.5
				NOT = { has_character_flag = content_with_small_dragon }
				event_target:dragon_4 = { NOT = { martial = 50 } }
			}
			modifier = {
				factor = 0.5
				NOT = { has_character_flag = content_with_small_dragon }
				event_target:dragon_4 = { NOT = { martial = 25 } }
			}
			modifier = {
				factor = 0.5
				NOT = { has_character_flag = content_with_small_dragon }
				event_target:dragon_4 = { NOT = { martial = 10 } }
			}
			modifier = {
				factor = 0
				event_target:dragon_4 = {
					OR = {
						trait = shy_dragon
						has_character_flag = shadow_lands_dragon
					}
					NOT = { has_character_modifier = locked_in_dragonpit }
				}
			}
		}
		trigger = {
			event_target:dragon_4 = { always = yes }
		}
		event_target:dragon_4 = {
			character_event = { id = dragon.2698 tooltip = TOOLTIPdragon.2698 days = 2 random = 1 }
		}	
		hidden_tooltip = {
			event_target:dragon_1 = { clr_character_flag = found_wild_dragon }
			event_target:dragon_2 = { clr_character_flag = found_wild_dragon }
			event_target:dragon_3 = { clr_character_flag = found_wild_dragon }
		}
	}
	option = {
		name = "AI REJECT"
		trigger = { ai = yes }
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				has_character_flag = content_with_small_dragon
			}
		}	
		hidden_tooltip = {
			event_target:dragon_1 = { clr_character_flag = found_wild_dragon }
			event_target:dragon_2 = { clr_character_flag = found_wild_dragon }
			event_target:dragon_3 = { clr_character_flag = found_wild_dragon }
			event_target:dragon_4 = { clr_character_flag = found_wild_dragon }
		}
	}
	after = {
		clr_character_flag = desires_large_dragon
		clr_character_flag = desires_heir_dragon
		clr_character_flag = content_with_small_dragon
	}
}	
character_event = { #scope to dragon
	id = dragon.2698

	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		#find tamer
		if = {
			limit = {
				FROM = { NOT = { character = ROOT } }
			}
			FROM = { save_event_target_as = dragon_tamer }
		}
		else_if = {
			limit = { FROMFROM = { NOT = { character = ROOT } } }
			FROMFROM = { save_event_target_as = dragon_tamer }
		}
		
		if = { #Double check dragon doesnt have rider already
			limit = { 
				OR = {
					any_friend = { is_alive = yes } 
					num_of_friends = 1
					is_ruler = yes
					liege = { graphical_culture = dragongfx }
				}	
			}
			clr_character_flag = found_wild_dragon
			event_target:dragon_tamer = { clr_character_flag = found_wild_dragon }
			break = yes
		}	
		if = {
			limit = { #Shy dragons cannot be found this way
				OR = {
					trait = shy_dragon
					has_character_flag = shadow_lands_dragon
				}
				NOT = { has_character_modifier = locked_in_dragonpit }
			}
			clr_character_flag = found_wild_dragon
			event_target:dragon_tamer = { character_event = { id = dragon.2695 days = 10 } }  
			break = yes
		}
		if = {
			limit = { #If locked in the dragonpit must be related to province owner
				has_character_modifier = locked_in_dragonpit
				NOT = {
					location = {
						owner = {
							OR = {
								character = event_target:dragon_tamer	
								AND = {
									dynasty = event_target:dragon_tamer
									NOT = { dynasty = 0 }
								}
								is_close_relative = event_target:dragon_tamer
								is_liege_or_above = event_target:dragon_tamer
								AND = {
									has_character_modifier = calling_for_dragon_riders
									is_liege_of = event_target:dragon_tamer
								}
							}
						}
					}
				}
			}
			clr_character_flag = found_wild_dragon
			event_target:dragon_tamer = { character_event = { id = dragon.2694 days = 2 } }		
			break = yes
		}

		event_target:dragon_tamer = { character_event = { id = dragon.26 days = 4 random = 2 } } 
	}
	
	option = {
		name = OK
	}	
}
#Not allowed in the dragonpit
character_event = {
	id = dragon.2694
	desc = "EVTDESCdragon.2694"
	
	is_triggered_only = yes
	
	trigger = { 
		has_character_flag = found_wild_dragon 
		NOT = { trait = dragon }
	}
	
	option = {
		name = "EVTOPTAdragon.2694"
	}
}	
#Dragon cant be found
character_event = {
	id = dragon.2695	
	picture = "GFX_valyria_dragon"
	
	desc = {
		text = "EVTDESCdragon.2695"
		trigger = { FROM = { NOT = { has_character_flag = shadow_lands_dragon } } }
	}
	desc = {
		text = "EVTDESCdragon.2695B"
		trigger = { FROM = { has_character_flag = shadow_lands_dragon } }
	}
	
	is_triggered_only = yes
	
	trigger = { 
		has_character_flag = found_wild_dragon 
		NOT = { trait = dragon }
	}
	
	option = {
		name = "EVTOPTAdragon.2695"
		clr_character_flag = found_wild_dragon
	}
}	
character_event = {
	id = dragon.26
	desc = "EVTDESCdragon.26"
	picture = "GFX_tamingdragon"
	
	is_triggered_only = yes
	
	trigger = { 
		has_character_flag = found_wild_dragon 
		NOT = { trait = dragon }
		NOT = { FROM = { any_friend = { is_alive = yes } } }
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
	}
	
	option = {
		name = "EVTOPTAdragon.26" # tame it
		trigger = {
			OR = {
				culture_group = valyrian
				high_valyrian_dynasty_trigger = yes
				NOT = { has_game_rule = { name = dragon_hatching_taming value = valyrian_only } }
			}
		}
		ai_chance = {
			factor = 1
			
			modifier = {
				factor = 25
				has_game_rule = { name = dragon_hatching_taming value = easy }
			}
			modifier = {
				factor = 5
				has_game_rule = { name = dragon_hatching_taming value = less_hard }
			}
			modifier = {
				factor = 0.33
				has_game_rule = { name = dragon_hatching_taming value = hard }
			}
			modifier = {
				factor = 100
				has_ambition = obj_tame_a_dragon
			}
			modifier = {
				factor = 5
				any_dynasty_member = { at_location = PREV is_alive = yes can_use_dragon_abilities_trigger = yes }
			}
			modifier = {
				factor = 3
				trait = brave
			}
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 3
				trait = genius
			}
			modifier = {
				factor = 1.5
				is_smart_trigger = yes
			}
			modifier = {
				factor = 2
				trait = lunatic
			}
			modifier = {
				factor = 5
				any_owned_bloodline = { has_bloodline_flag = blood_of_the_dragon }
			}
			modifier = {
				factor = 5
				OR = {			
					culture = high_valyrian 
					graphical_culture = valyriangfx
				}
			}
			modifier = {
				factor = 5
				OR = {
					culture_group = valyrian
					has_silver_hair_ethnicity_trigger = yes
				}
			}
			modifier = {
				factor = 2.5
				culture = asshai
			}
			modifier = {
				factor = 5
				religion_group = valyrian_rel_group
			}
			modifier = {
				factor = 10
				has_character_flag = daenerys_targaryen
			}
			modifier = {
				factor = 3
				has_character_flag = dragon_intel_citadel 
			}
			modifier = {
				factor = 1.5
				religion = rhllor 
			}
			modifier = {
				factor = 3
				trait = favored_by_rhllor
			}
			modifier = {
				factor = 10
				trait = chosen_by_rhllor 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_harrenhal
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_dragonstone
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_dragonpit 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_old_ghis
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_volantis
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_smoking_sea
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_asshai
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_dynamic
			}
			##Dragon Factors##		
			modifier = {
				factor = 5
				FROM = { has_character_modifier = locked_in_dragonpit }
			}
			modifier = {
				factor = 5
				FROM = { has_character_flag = tamed_dragon }
			}
		}
		FROM = {
			character_event = { id = dragon.1399 tooltip = TOOLTIPdragon.1399 }
		}	
	}
	option = {
		name = "EVTOPTEdragon.12" # Use Dragonhorn!
		trigger = {
			any_artifact = {
				has_artifact_flag = dragonhorn
				is_artifact_active = yes
			}
		}
		ai_chance = {
			factor = 9999
		}
		tooltip_info = yes
		character_event = { id = dragon.195 tooltip = TOOLTIPdragon.195 }
	}
	option = {
		name = "EVTOPTBdragon.26" #kill the wild beast	
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				trait = trained_warrior 
			}
			modifier = {
				factor = 4
				trait = skilled_warrior 
			}
			modifier = {
				factor = 8
				trait = master_warrior 
			}
			modifier = {
				factor = 5
				trait = dragon_slayer 
			}
			modifier = {
				factor = 2
				trait = proud 
			}
			modifier = {
				factor = 3
				trait = brave 
			}
			modifier = {
				factor = 3
				trait = lunatic 
			}
			modifier = {
				factor = 3
				trait = wroth
			}
			modifier = {
				factor = 0.5
				 trait = craven 
			}
			modifier = {
				factor = 0.5
				is_weak_trigger = yes
			}
		}
		pacifists_lose_piety_effect = yes
		FROM = {	
			character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 }
		}		
	}
	option = {
		name = "EVTOPTCdragon.26" #run	
		trigger = { NOT = { trait = berserker } }
		ai_chance = {
			factor = 20
			modifier = {
				factor = 2
				trait = craven
			}
			modifier = {
				factor = 2
				is_weak_trigger = yes
			}
			modifier = {
				factor = 2
				trait = content
			}
			##Dragon Factors##		
			modifier = {
				factor = 0.66
				FROM = { NOT = { martial = 20 } }
			}
			modifier = {
				factor = 1.1
				FROM = { martial = 40 } 
			}
			modifier = {
				factor = 1.25
				FROM = { martial = 60 } 
			}
			modifier = {
				factor = 1.33
				FROM = { martial = 80 } 
			}
			modifier = {
				factor = 0.5
				FROM = { trait = obedient_dragon }
			}	
			modifier = {
				factor = 2
				FROM = { trait = wroth_dragon }
			}
			modifier = {
				factor = 0.66
				FROM = { trait = playful_dragon }
			}
			modifier = {
				factor = 2
				FROM = { trait = lunatic_dragon }
			}	
			modifier = {
				factor = 0.66
				FROM = { trait = wounded_dragon }
			}			
			modifier = {
				factor = 0.5
				FROM = { trait = maimed_dragon }
			}
			modifier = {
				factor = 0.5
				FROM = { trait = sickly_dragon }
			}
			modifier = {
				factor = 0.66
				FROM = { trait = affectionate_dragon }
			}
		}
		if = {
			limit = { 
				NOT = { trait = craven } 
				NOT = { trait = brave }
				can_press_claims_trigger = yes
				NOT = { age = 50 }
			}
			random = {
				chance = 15
				add_trait = craven
				hidden_tooltip = {
					character_event ={
						id = 38257 #Notify
					}
				}
			}
		}
		if = {
			limit = { 
				trait = brave 
				NOT = { trait = maester }
				NOT = { trait = archmaester }
				NOT = { trait = septon }
				NOT = { age = 50 }
			}
			remove_trait = brave
		}
		set_character_flag = ran_from_dragon
		clr_character_flag = found_wild_dragon
		FROM = { clr_character_flag = found_wild_dragon }
		prestige = -25		
	}	
}
#Random wild dragon encounter
character_event = { 
	id = dragon.2696

	hide_window = yes
	
	min_age = 2
	
	trigger = {
		trait = dragon
		NOT = { any_friend = { is_alive = yes } }
		NOT = { num_of_friends = 1 }
		NOT = { has_character_flag = dany_dragon }
		OR = {
			NOT = { has_character_flag = found_wild_dragon }
			had_character_flag = { flag = found_wild_dragon days = 30 }
		}
		NOT = { has_character_modifier = locked_in_dragonpit }
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		is_ruler = no
		NOT = { liege = { graphical_culture = dragongfx } }
	}
	
	mean_time_to_happen = {
		years = 10
		modifier = {
			factor = 0.5
			trait = wroth_dragon
		}
		modifier = {
			factor = 0.5
			trait = ravenous_dragon
		}
		modifier = {
			factor = 0.5
			trait = lunatic_dragon
		}
		modifier = {
			factor = 2
			trait = nimble_dragon
		}
		modifier = {
			factor = 2
			trait = lazy_dragon
		}
		modifier = {
			factor = 3
			trait = shy_dragon
		}		
	}
	
	immediate = { 
		location = {
			random_province_character = {
				limit = {
					age = 14
					NOT = { trait = dragon }
					NOT = { in_battle = yes }
					prisoner = no
					NOT = { trait = incapable }
					OR = {
						is_ruler = yes
						trait = brave
						has_job_title = job_marshal
						martial = 10				
						OR = {
							culture_group = valyrian
							has_silver_hair_ethnicity_trigger = yes
						}
					}
					is_ill = no
					NOT = { has_severe_disability_trigger = yes }
					NOT = { is_inaccessible_trigger = yes }
				}
				character_event = { id = dragon.2697 }
			}
		}
	}
	
	option = {
		name = OK
	}	
}	
character_event = {
	id = dragon.2697
	desc = "EVTDESCdragon.2697"
	picture = "GFX_tamingdragon"
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { FROM = { any_friend = { is_alive = yes } } }
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
	}
	
	immediate = { 
		set_character_flag = found_wild_dragon 
		FROM = { set_character_flag = found_wild_dragon }
		calculate_dragon_preference_effect = yes
	}
	
	option = {
		name = "EVTOPTAdragon.26" # tame it
		trigger = {
			NOT = {
				any_friend = {
					is_alive = yes
					trait = dragon
				}
			}
			NOT = { can_use_dragon_abilities_trigger = yes }
			OR = {
				culture_group = valyrian
				high_valyrian_dynasty_trigger = yes
				any_artifact = { has_artifact_flag = dragonhorn }
				NOT = { has_game_rule = { name = dragon_hatching_taming value = valyrian_only } }
			}
		}
		ai_chance = {
			factor = 1
			
			modifier = {
				factor = 0
				has_character_flag = desires_large_dragon
				FROM = { NOT = { martial = 70 } }
			}
			modifier = {
				factor = 0
				has_character_flag = desires_heir_dragon
				FROM = { NOT = { martial = 90 } }
			}
			modifier = {
				factor = 0.5
				NOT = { has_character_flag = content_with_small_dragon }
				FROM = { NOT = { martial = 50 } }
			}
			modifier = {
				factor = 0.5
				NOT = { has_character_flag = content_with_small_dragon }
				FROM = { NOT = { martial = 25 } }
			}
			modifier = {
				factor = 0.5
				NOT = { has_character_flag = content_with_small_dragon }
				FROM = { NOT = { martial = 10 } }
			}
			
			modifier = {
				factor = 25
				has_game_rule = { name = dragon_hatching_taming value = easy }
			}
			modifier = {
				factor = 5
				has_game_rule = { name = dragon_hatching_taming value = less_hard }
			}
			modifier = {
				factor = 0.33
				has_game_rule = { name = dragon_hatching_taming value = hard }
			}
			modifier = {
				factor = 5
				any_dynasty_member = { at_location = PREV is_alive = yes can_use_dragon_abilities_trigger = yes }
			}
			modifier = {
				factor = 3
				trait = brave
			}
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 3
				trait = genius
			}
			modifier = {
				factor = 1.5
				is_smart_trigger = yes
			}
			modifier = {
				factor = 2
				trait = lunatic
			}
			modifier = {
				factor = 5
				any_owned_bloodline = { has_bloodline_flag = blood_of_the_dragon }
			}
			modifier = {
				factor = 5
				OR = {			
					culture = high_valyrian 
					graphical_culture = valyriangfx
				}
			}
			modifier = {
				factor = 5
				OR = {
					culture_group = valyrian
					has_silver_hair_ethnicity_trigger = yes
				}
			}
			modifier = {
				factor = 5
				religion_group = valyrian_rel_group
			}
			modifier = {
				factor = 10
				has_character_flag = daenerys_targaryen
			}
			modifier = {
				factor = 3
				has_character_flag = dragon_intel_citadel 
			}
			modifier = {
				factor = 1.5
				religion = rhllor 
			}
			modifier = {
				factor = 3
				trait = favored_by_rhllor
			}
			modifier = {
				factor = 10
				trait = chosen_by_rhllor 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_harrenhal
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_dragonstone
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_dragonpit 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_old_ghis
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_volantis
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_smoking_sea
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_asshai
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_dynamic
			}
			modifier = {
				factor = 2
				has_character_flag = dragon_intel_rebirth
			}
			##Dragon Factors##		
			modifier = {
				factor = 5
				FROM = { has_character_flag = tamed_dragon }
			}			
		}
		FROM = {
			character_event = { id = dragon.1399 tooltip = TOOLTIPdragon.1399 }
		}	
	}
	option = {
		name = "EVTOPTBdragon.26" #kill the wild beast	
		ai_chance = {
			factor = 1
			
			modifier = {
				factor = 0.25
				has_character_flag = desires_large_dragon
			}		
			modifier = {
				factor = 0.25
				can_use_dragon_abilities_trigger = yes
			}
			modifier = {
				factor = 2
				trait = trained_warrior 
			}
			modifier = {
				factor = 4
				trait = skilled_warrior 
			}
			modifier = {
				factor = 8
				trait = master_warrior 
			}
			modifier = {
				factor = 5
				trait = dragon_slayer 
			}
			modifier = {
				factor = 2
				trait = proud 
			}
			modifier = {
				factor = 3
				trait = brave 
			}
			modifier = {
				factor = 3
				trait = lunatic 
			}
			modifier = {
				factor = 3
				trait = wroth
			}
			modifier = {
				factor = 0.5
				 trait = craven 
			}
			modifier = {
				factor = 0.5
				is_weak_trigger = yes
			}
		}
		FROM = {	
			character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 }
		}		
	}
	option = {
		name = "EVTOPTCdragon.26" #run		
		trigger = { NOT = { trait = berserker } }
		ai_chance = {
			factor = 20
			modifier = {
				factor = 2
				trait = craven
			}
			modifier = {
				factor = 2
				is_weak_trigger = yes
			}
			modifier = {
				factor = 2
				trait = content
			}
			##Dragon Factors##		
			modifier = {
				factor = 0.66
				FROM = { NOT = { martial = 20 } }
			}
			modifier = {
				factor = 1.1
				FROM = { martial = 40 } 
			}
			modifier = {
				factor = 1.25
				FROM = { martial = 60 } 
			}
			modifier = {
				factor = 1.33
				FROM = { martial = 80 } 
			}
			modifier = {
				factor = 0.5
				FROM = { trait = obedient_dragon }
			}	
			modifier = {
				factor = 2
				FROM = { trait = wroth_dragon }
			}
			modifier = {
				factor = 0.66
				FROM = { trait = playful_dragon }
			}
			modifier = {
				factor = 2
				FROM = { trait = lunatic_dragon }
			}	
			modifier = {
				factor = 0.66
				FROM = { trait = wounded_dragon }
			}			
			modifier = {
				factor = 0.5
				FROM = { trait = maimed_dragon }
			}
			modifier = {
				factor = 0.5
				FROM = { trait = sickly_dragon }
			}
			modifier = {
				factor = 0.66
				FROM = { trait = affectionate_dragon }
			}	
		}
		prestige = -25	
		if = {
			limit = {
				NOT = { can_use_dragon_abilities_trigger = yes }
				NOT = { has_character_flag = desires_large_dragon }
				can_press_claims_trigger = yes			
			}
			if = {
				limit = { 					
					NOT = { trait = craven } 
					NOT = { trait = brave }	
				}
				random = {
					chance = 15
					add_trait = craven
					hidden_tooltip = {
						character_event ={
							id = 38257 #Notify
						}
					}
				}
			}
			if = {
				limit = { 
					trait = brave 
				}
				remove_trait = brave
			}
			set_character_flag = ran_from_dragon
		}	
		clr_character_flag = found_wild_dragon
		FROM = { clr_character_flag = found_wild_dragon }		
	}	
	after = {
		clr_character_flag = desires_large_dragon
		clr_character_flag = desires_heir_dragon
		clr_character_flag = content_with_small_dragon
	}
}
# Citadel Determine fightign battle a dragon
character_event = { #scope to dragon
	id = dragon.2799
	
	is_triggered_only = yes
	hide_window = yes
	
	trigger = { trait = dragon }
	
	immediate = {
		hidden_tooltip = { c_the_citadel = { holder_scope = { character_event = { id = dragon.27 } } } }
	}
	
	option = {
		name = OK
	}
}	
character_event = {
	id = dragon.27
	is_triggered_only = yes
	desc = "EVTDESCdragon.27"
	
	# Nobody but the actual referee should ever get this
	trigger = { has_landed_title = c_the_citadel }
	
	immediate = {
		FROMFROM = {
			if = {
				limit = {
					has_character_flag = battle_dragon
					ROOT_FROM = { 
						OR = {
							is_alive = no
							NOT = { any_friend = { always = yes } }
						}	
					}
				}
				set_character_flag = skip_battle_dragon
			}
		}	
		clear_event_target = enemy_dragon_rider
		ROOT_FROM = {
			random_friend = {
				limit = {
					is_alive = yes
					NOT = { trait = dragon }
				}
				save_event_target_as = enemy_dragon_rider
			}
		}
	}
	
	#won
	option = {
		name = "WON"
		trigger = { 
			NOT = {
				FROMFROM = { has_character_flag = skip_battle_dragon }
			}
		}	
		ai_chance = {
			factor = 1
			
			modifier = { #slightly easier
				factor = 3
				FROMFROM = { has_character_flag = capture_dragon }
			}
			
			# Skill-at-Arms Effects
			modifier = {
				factor = 2
				FROMFROM = { trait = poor_warrior }
			}
			modifier = {
				factor = 4
				FROMFROM = { trait = trained_warrior }
			}
			modifier = {
				factor = 8
				FROMFROM = { trait = skilled_warrior }
			}
			modifier = {
				factor = 16
				FROMFROM = { trait = master_warrior }
			}

			# Weapon effects
			modifier = {
				factor = 2
				FROMFROM = {
					any_artifact = { 
						has_artifact_flag = combat_tier_4
						is_artifact_equipped = yes
					}
				}	
			}
			modifier = {
				factor = 1.5
				FROMFROM = {
					any_artifact = { 
						has_artifact_flag = combat_tier_3
						is_artifact_equipped = yes
					}
				}	
			}
			modifier = {
				factor = 1.35
				FROMFROM = {
					any_artifact = { 
						has_artifact_flag = combat_tier_2
						is_artifact_equipped = yes
					}
				}	
			}
			modifier = {
				factor = 1.2
				FROMFROM = {
					any_artifact = { 
						has_artifact_flag = combat_tier_1
						is_artifact_equipped = yes
					}
				}	
			}
			
			modifier = {
				factor = 2
				FROMFROM = {
					any_artifact = { 
						has_artifact_flag = armour_tier_4
						is_artifact_equipped = yes
					}
				}	
			}
			modifier = {
				factor = 1.5
				FROMFROM = {
					any_artifact = { 
						has_artifact_flag = armour_tier_3
						is_artifact_equipped = yes
					}
				}	
			}
			modifier = {
				factor = 1.35
				FROMFROM = {
					any_artifact = { 
						has_artifact_flag = armour_tier_2
						is_artifact_equipped = yes
					}
				}	
			}
			modifier = {
				factor = 1.2
				FROMFROM = {
					any_artifact = { 
						has_artifact_flag = armour_tier_1
						is_artifact_equipped = yes
					}
				}	
			}	
			# Physical Strength Effects
			modifier = {
				factor = 2
				FROMFROM = { is_strong_trigger = yes }
			}
			modifier = {
				factor = 0.5
				FROMFROM = { is_weak_trigger = yes }
			}
			
			# Cunning/Intelligence Effects
			modifier = {
				factor = 2
				FROMFROM = { trait = genius }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { is_smart_trigger = yes }
			}
			modifier = {
				factor = 0.5
				FROMFROM = { trait = imbecile }
			}
			modifier = {
				factor = 0.666
				FROMFROM = { is_dumb_trigger = yes }
			}
			
			# Personality Effects
			modifier = {
				factor = 2
				FROMFROM = { trait = brave }
			}
			modifier = {
				factor = 0.5
				FROMFROM = { trait = craven }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { trait = deceitful }
			}
			modifier = {
				factor = 0.666
				FROMFROM = { trait = honest }
			}
			modifier = {
				factor = 2
				FROMFROM = { trait = ruthless }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { trait = cannibal_trait }
			}
			
			# Wound Effects
			modifier = {
				factor = 0.5
				FROMFROM = { trait = wounded }
			}
			modifier = {
				factor = 0.25
				FROMFROM = { trait = maimed }
			}
			modifier = {
				factor = 0
				FROMFROM = { 
					OR = {
						trait = incapable 
						trait = crippled	
						trait = sick_incapable
					}	
				}
			}
			modifier = {
				factor = 0.25
				FROMFROM = { trait = one_eyed }
			}
			modifier = {
				factor = 0.125
				FROMFROM = { trait = one_handed }
			}
			modifier = {
				factor = 0.125
				FROMFROM = { trait = one_legged }
			}
			modifier = {
				factor = 0.05
				FROMFROM = { trait = mangled }
			}
			modifier = {
				factor = 0.125
				FROMFROM = { trait = severely_injured }
			}
			
			# Health Effects
			modifier = {
				factor = 0.5
				FROMFROM = { is_ill = yes }
			}	
			modifier = {
				factor = 0.25
				FROMFROM = { trait = infirm }
			}
			modifier = {
				factor = 0.166
				FROMFROM = { has_epidemic = yes }	
			}
			modifier = {
				factor = 0.033
				FROMFROM = {
					OR = {
						trait = blinded
						trait = blinded_age
					}
				}	
			}
			modifier = {
				factor = 0.75
				FROMFROM = { trait = drunkard }
			}
			
			# Body Shape Effects
			modifier = {
				factor = 3
				FROMFROM = { trait = tall }
			}
			modifier = {
				factor = 0.25
				FROMFROM = { trait = hunchback }
			}
			modifier = {
				factor = 0.25
				FROMFROM = { trait = dwarf }
			}
			modifier = {
				factor = 0.25
				FROMFROM = { trait = clubfooted }
			}
			
			# Age Effects
			modifier = {
				factor = 0.5
				FROMFROM = { age = 50 }
			}
			modifier = {
				factor = 0.333
				FROMFROM = { age = 70 }
			}
			
			modifier = {
				factor = 0.5
				NOT = { FROMFROM = { age = 16 } }
			}
			modifier = {
				factor = 0.5
				NOT = { FROMFROM = { age = 12 } }
			}
			modifier = {
				factor = 0.5
				NOT = { FROMFROM = { age = 8 } }
			}
			modifier = {
				factor = 0.5
				NOT = { FROMFROM = { age = 4 } }
			}
			
			# Way of Life war focus effects
			modifier = {
				factor = 1.5
				FROMFROM = { has_character_modifier = wol_duel_training }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { has_character_modifier = wol_war_fit }
			}
			
			
			# Magical Effects
			modifier = {
				factor = 2
				FROMFROM = { trait = direwolf }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { trait = wolf }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { trait = snowbear }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { trait = eagle }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { trait = shadowcat }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { trait = brownbear }
			}
			modifier = {
				factor = 1.25
				FROMFROM = { trait = dog }
			}
			modifier = {
				factor = 1.25
				FROMFROM = { trait = crow }
			}
			modifier = {
				factor = 1.25
				FROMFROM = { trait = boar }
			}
			modifier = {
				factor = 2
				FROMFROM = { trait = chosen_by_rhllor }
			}
			modifier = {
				factor = 4
				FROMFROM = { trait = resurrected_by_rhllor }
			}
			modifier = {
				factor = 1.25
				FROMFROM = { trait = favored_by_rhllor }
			}
			modifier = {
				factor = 0.8
				FROMFROM = { has_character_modifier = curse_of_harrenhal }
			}
			modifier = {
				factor = 2
				FROMFROM = { has_character_modifier = demon_child_non_pagan }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { trait = dragon_dreams } # Can see into the future-ish
			}
			modifier = {
				factor = 0.5
				FROMFROM = { trait = white_walker } # vulnerable to dragons
			}
			modifier = {
				factor = 4
				FROMFROM = { trait = immortal } # Counteract age effect
			}
			modifier = {
				factor = 4
				FROMFROM = { trait = undead }
			}
			
			# Misc character modifiers
			modifier = {
				factor = 1.25
				FROMFROM = { has_character_modifier = wolf_blood }
			}
			modifier = {
				factor = 1.25
				FROMFROM = { has_character_modifier = lycanthropy }
			}
			modifier = {
				factor = 1.25
				FROMFROM = { has_character_modifier = manly_skill_wrestling }
			}
			modifier = {
				factor = 4
				FROMFROM = { has_character_modifier = martially_ambidextrous }
			}
			modifier = {
				factor = 1.25
				FROMFROM = { has_character_modifier = iron_hand }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { has_character_modifier = prosthetic_leg }
			}
			modifier = {
				factor = 1.25
				FROMFROM = { has_character_modifier = peg_leg }
			}
			modifier = {
				factor = 0.5
				FROMFROM = { has_character_modifier = phantom_pain }
			}
			modifier = {
				factor = 0.5
				FROMFROM = { has_character_modifier = severe_illness }
			}
			modifier = {
				factor = 0.05
				FROMFROM = { has_character_modifier = bedridden_illness }
			}
			
			# Dragon slayer
			modifier = {
				factor = 5
				FROMFROM = { trait = dragon_slayer }
			}
			
			#Books
			modifier = {
				factor = 3
				FROMFROM = { any_artifact = { artifact_type = book_blood_and_fire is_artifact_active = yes } }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { any_artifact = { artifact_type = book_dragons_wyrms_and_wyverns is_artifact_active = yes } }
			}
			modifier = {
				factor = 1.5
				FROMFROM = { any_artifact = { artifact_type = book_fires_of_the_freehold is_artifact_active = yes } }
			}
			
			#my own dragon, easier to get close
			modifier = {
				factor = 4
				FROMFROM = { any_friend = { character = ROOT_FROM } }
			}	
			##Own Dragon Factors##		
			modifier = {
				factor = 250
				FROMFROM = { can_use_dragon_abilities_trigger = yes }
			}
			modifier = {
				factor = 0.66
				FROM = { 
					FROM = { 
						can_use_dragon_abilities_trigger = yes
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							NOT = { martial = 20 }
						}	
					} 
				}
			}
			modifier = {
				factor = 1.11
				FROM = { 
					FROM = { 
						can_use_dragon_abilities_trigger = yes
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							martial = 40
						}	
					} 
				}
			}
			modifier = {
				factor = 1.25
				FROM = { 
					FROM = { 
						can_use_dragon_abilities_trigger = yes
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							martial = 60
						}	
					} 
				}
			}
			modifier = {
				factor = 1.33
				FROM = { 
					FROM = { 
						can_use_dragon_abilities_trigger = yes
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							martial = 80
						}	
					} 
				}
			}
			modifier = {
				factor = 1.5
				FROM = { 
					FROM = { 
						can_use_dragon_abilities_trigger = yes
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							martial = 100
						}	
					} 
				}
			}
			modifier = {
				factor = 1.5
				FROM = { 
					FROM = { 
						can_use_dragon_abilities_trigger = yes
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							trait = obedient_dragon
						}	
					} 
				}
			}	
			modifier = {
				factor = 1.5
				FROM = { 
					FROM = { 
						can_use_dragon_abilities_trigger = yes
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							trait = wroth_dragon
						}	
					} 
				}
			}
			modifier = {
				factor = 1.5
				FROM = { 
					FROM = { 
						can_use_dragon_abilities_trigger = yes
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							trait = lunatic_dragon
						}	
					} 
				}
			}				
			##Dragon Factors##		
			modifier = {
				factor = 1.5
				FROM = { NOT = { martial = 20 } }
			}
			modifier = {
				factor = 0.9
				FROM = { martial = 40 } 
			}
			modifier = {
				factor = 0.8
				FROM = { martial = 60 } 
			}
			modifier = {
				factor = 0.75
				FROM = { martial = 80 } 
			}
			modifier = {
				factor = 0.66
				FROM = { martial = 100 } 
			}
			modifier = {
				factor = 1.5
				FROM = { trait = playful_dragon }
			}
			modifier = {
				factor = 1.5
				FROM = { trait = ravenous_dragon }
			}	
			modifier = {
				factor = 0.75
				FROM = { trait = nimble_dragon }
			}	
			modifier = {
				factor = 0.75
				FROM = { FROM = { has_character_flag = battle_dragon } }
				FROM = { trait = obedient_dragon }
			}			
			modifier = {
				factor = 0.75
				FROM = { trait = wroth_dragon }
			}
			modifier = {
				factor = 0.66
				FROM = { trait = lunatic_dragon }
			}	
			modifier = {
				factor = 2
				FROM = { trait = wounded_dragon }
			}			
			modifier = {
				factor = 3
				FROM = { trait = maimed_dragon }
			}
			modifier = {
				factor = 3
				FROM = { trait = sickly_dragon }
			}	
				
			##Enemy rider factors
			# Skill-at-Arms Effects
			# modifier = {
				# factor = 1
				# event_target:enemy_dragon_rider = { trait = poor_warrior }
			# }
			modifier = {
				factor = 0.75
				event_target:enemy_dragon_rider = { trait = trained_warrior }
			}
			modifier = {
				factor = 0.5
				event_target:enemy_dragon_rider = { trait = skilled_warrior }
			}
			modifier = {
				factor = 0.25
				event_target:enemy_dragon_rider = { trait = master_warrior }
			}
			# Armour Effects
			modifier = {
				factor = 0.9
				event_target:enemy_dragon_rider = {
					any_artifact = { 
						has_artifact_flag = armour_tier_1
						is_artifact_equipped = yes
					}
				}	
			}
			modifier = {
				factor = 0.825
				event_target:enemy_dragon_rider = {
					any_artifact = { 
						has_artifact_flag = armour_tier_2
						is_artifact_equipped = yes
					}
				}	
			}
			modifier = {
				factor = 0.75
				event_target:enemy_dragon_rider = {
					any_artifact = { 
						has_artifact_flag = armour_tier_3
						is_artifact_equipped = yes
					}
				}	
			}
			
			# Physical Strength Effects
			modifier = {
				factor = 0.75
				event_target:enemy_dragon_rider = { is_strong_trigger = yes }
			}
			modifier = {
				factor = 1.33
				event_target:enemy_dragon_rider = { is_weak_trigger = yes }
			}
			
			# Cunning/Intelligence Effects
			modifier = {
				factor = 0.75
				event_target:enemy_dragon_rider = { trait = genius }
			}
			modifier = {
				factor = 0.9
				event_target:enemy_dragon_rider = { is_smart_trigger = yes }
			}
			modifier = {
				factor = 1.33
				event_target:enemy_dragon_rider = { trait = imbecile }
			}
			modifier = {
				factor = 1.11
				event_target:enemy_dragon_rider = { is_dumb_trigger = yes }
			}
			
			# Personality Effects
			modifier = {
				factor = 0.75
				event_target:enemy_dragon_rider = { trait = brave }
			}
			modifier = {
				factor = 1.33
				event_target:enemy_dragon_rider = { trait = craven }
			}
			modifier = {
				factor = 0.75
				event_target:enemy_dragon_rider = { trait = ruthless }
			}
			
			# Wound Effects
			modifier = {
				factor = 1.33
				event_target:enemy_dragon_rider = { trait = wounded }
			}
			modifier = {
				factor = 2
				event_target:enemy_dragon_rider = { trait = maimed }
			}
			modifier = {
				factor = 25
				event_target:enemy_dragon_rider = { 
					OR = {
						trait = incapable 
						trait = crippled	
						trait = sick_incapable
					}	
				}
			}
			modifier = {
				factor = 2
				event_target:enemy_dragon_rider = { trait = one_eyed }
			}
			modifier = {
				factor = 4
				event_target:enemy_dragon_rider = { trait = one_handed }
			}
			modifier = {
				factor = 4
				event_target:enemy_dragon_rider = { trait = one_legged }
			}
			modifier = {
				factor = 10
				event_target:enemy_dragon_rider = { trait = mangled }
			}
			modifier = {
				factor = 4
				event_target:enemy_dragon_rider = { trait = severely_injured }
			}
			
			# Health Effects
			modifier = {
				factor = 1.33
				event_target:enemy_dragon_rider = { is_ill = yes }
			}	
			modifier = {
				factor = 2
				event_target:enemy_dragon_rider = { trait = infirm }
			}
			modifier = {
				factor = 3
				event_target:enemy_dragon_rider = { has_epidemic = yes }	
			}
			modifier = {
				factor = 15
				event_target:enemy_dragon_rider = {
					OR = {
						trait = blinded
						trait = blinded_age
					}
				}	
			}
		
			# Body Shape Effects
			modifier = {
				factor = 0.66
				event_target:enemy_dragon_rider = { trait = tall }
			}
			modifier = {
				factor = 2
				event_target:enemy_dragon_rider = { trait = hunchback }
			}
			modifier = {
				factor = 2
				event_target:enemy_dragon_rider = { trait = dwarf }
			}
			modifier = {
				factor = 2
				event_target:enemy_dragon_rider = { trait = clubfooted }
			}
			
			# Age Effects
			modifier = {
				factor = 1.33
				event_target:enemy_dragon_rider = { age = 50 }
			}
			modifier = {
				factor = 1.5
				event_target:enemy_dragon_rider = { age = 70 }
			}
			
			modifier = {
				factor = 1.33
				NOT = { event_target:enemy_dragon_rider = { age = 16 } }
			}
			modifier = {
				factor = 1.33
				NOT = { event_target:enemy_dragon_rider = { age = 12 } }
			}
			modifier = {
				factor = 1.33
				NOT = { event_target:enemy_dragon_rider = { age = 8 } }
			}
			modifier = {
				factor = 1.33
				NOT = { event_target:enemy_dragon_rider = { age = 4 } }
			}
					
			# Magical Effects
			modifier = {
				factor = 0.75
				event_target:enemy_dragon_rider = { trait = chosen_by_rhllor }
			}
			modifier = {
				factor = 0.5
				event_target:enemy_dragon_rider = { trait = resurrected_by_rhllor }
			}
			modifier = {
				factor = 0.75
				event_target:enemy_dragon_rider = { has_character_modifier = demon_child_non_pagan }
			}
			modifier = {
				factor = 0.5
				event_target:enemy_dragon_rider = { trait = immortal } # Counteract age effect
			}
			modifier = {
				factor = 0.5
				event_target:enemy_dragon_rider = { trait = undead }
			}
			
			# Misc character modifiers
			modifier = {
				factor = 0.5
				event_target:enemy_dragon_rider = { has_character_modifier = martially_ambidextrous }
			}
			modifier = {
				factor = 0.9
				event_target:enemy_dragon_rider = { has_character_modifier = prosthetic_leg }
			}
			modifier = {
				factor = 1.33
				event_target:enemy_dragon_rider = { has_character_modifier = phantom_pain }
			}
			modifier = {
				factor = 1.33
				event_target:enemy_dragon_rider = { has_character_modifier = severe_illness }
			}
			modifier = {
				factor = 10
				event_target:enemy_dragon_rider = { has_character_modifier = bedridden_illness }
			}			
		}	
		FROMFROM = {
			if = {
				limit = {
					has_character_flag = battle_dragon
				}
				character_event = { id = dragon.3410 }	
			}
			if = {
				limit = {
					any_friend = { character = ROOT_FROM }
					has_character_flag = tame_dragon 
				}
				character_event = { id = dragon.28 } 
				clr_character_flag = tame_dragon 	
			}
			if = {
				limit = {
					 has_character_flag = found_wild_dragon
				}	
				character_event = { id = dragon.28 } 
				location = { province_event = { id = dragon.24 } } #remove dragon lair
				clr_character_flag = found_wild_dragon 	
			}	
			if = {
				limit = {
					has_character_flag = capture_dragon
				}	
				character_event = { id = dragon.88 } 
				clr_character_flag = capture_dragon	
			}	
			if = {
				limit = {
					has_character_flag = valyrian_quest_dragon
				}	
				character_event = { id = wikid.103 } 
				clr_character_flag = valyrian_quest_dragon
			}
			if = {
				limit = {
					has_character_flag = valyrian_quest_dragon_companion
				}	
				character_event = { id = wikid.106 } 
				clr_character_flag = valyrian_quest_dragon_companion
			}
			if = {
				limit = {
					has_character_flag = dragon_white_walker_duel
				}	
				event_target:enemy_dragon_rider = {
					character_event = { id = cold_winds.1399 } 
				}
			}
		}	
	}
	#lost
	option = {
		name = "LOST"
		trigger = { 
			NOT = {
				FROMFROM = { has_character_flag = skip_battle_dragon }
			}
		}	
		ai_chance = {
			factor = 1000
		}
		FROMFROM = {
			if = {
				limit = {
					has_character_flag = battle_dragon
				}
				character_event = { id = dragon.3710 }	
			}
			if = {
				limit = {
					OR = {
						has_character_flag = tame_dragon 
						has_character_flag = found_wild_dragon
					}
				}
				clr_character_flag = battle_dragon
				set_character_flag = ran_from_dragon
				character_event = { id = dragon.30 } 
				ROOT_FROM = {
					clr_character_flag = found_wild_dragon
				}	
			}	
			if = {
				limit = {
					has_character_flag = capture_dragon
				}	
				character_event = { id = dragon.89 } 
			}	
			if = {
				limit = {
					has_character_flag = valyrian_quest_dragon
				}	
				character_event = { id = wikid.104 } 
				clr_character_flag = valyrian_quest_dragon
			}
			if = {
				limit = {
					has_character_flag = valyrian_quest_dragon_companion
				}	
				character_event = { id = wikid.107 } 
				clr_character_flag = valyrian_quest_dragon_companion
			}
			if = {
				limit = {
					has_character_flag = dragon_white_walker_duel
				}	
				event_target:enemy_dragon_rider = {
					character_event = { id = cold_winds.1398 } 
				}
			}
		}	
		#FROM= {
		#	FROM = {
		#		character_event = { id = 3370037 } #lost battle debug notification
		#	}
		#}	
	}
	#no contest, dragon already killed
	option = {
		name = "NO DRAGON"
		trigger = { 
			FROMFROM = { has_character_flag = skip_battle_dragon }
		}
		FROMFROM = {
			clr_character_flag = battle_dragon
			clr_character_flag = skip_battle_dragon
			character_event = { id = dragon.35 }
		}	
	}
}
#Inform battle against dragon won
character_event = {
	id = dragon.28
	desc = "EVTDESCdragon.28"
	picture = "GFX_evt_dragon_death_battle"
	
	is_triggered_only = yes
	
	show_from_from = yes
	
	option = {
		name = "EVTOPTAdragon.28"	
		FROM = { 
			FROM = { 
				tooltip = { death = yes }
				hidden_tooltip = { character_event = { id = dragon.2999 } }
			} 
		}
		if = {
			limit = { NOT = { can_use_dragon_abilities_trigger = yes } }
			add_trait = dragon_slayer
			if = {
				limit = { 
					has_nickname = no 
					NOT = { trait = dragon }
					NOT = { can_use_dragon_abilities_trigger = yes }
				}
				give_nickname = nick_the_dragonslayer
			}
			prestige = 300
		}	
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_SLAYED_WILD_DRAGON
				portrait = [FromFrom.GetID]
			}
		}
	}
}
character_event = { #set dragon scope
	id = dragon.2999
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		any_playable_ruler = { #inform world
			limit = { 
				ai = no 
				NOT = { character = FROM }
			}
			character_event = { id = dragon.29 }
		}	
		death = {
			death_reason = death_dragon_duel
			killer = FROM
		}
	}

	option = {
		name = OK
	}
}	
#World dragon slain wild notfication
character_event = {
	id = dragon.29
	desc = "EVTDESCdragon.29"
	picture = "GFX_evt_dragon_death_battle"
	
	is_triggered_only = yes
	show_from_from = yes
	
	trigger = {
		NOT = { has_character_flag = no_dragon_slaying_inform }
	}
	
	option = {
		name = "EVTOPTAdragon.29"
		FROM = {
			tooltip = { show_portrait = yes }
		}
		chronicle = {
			entry = CHRONICLE_SLAYED_WILD_DRAGON_FROM
			portrait = [FromFrom.GetID]
		}
	}
	option = {
		name = "EVTOPTBdragon.1198"	
		trigger = { ai = no }
		set_character_flag = no_dragon_slaying_inform
	}
}
#battle against dragon lost (wild)
character_event = {
	id = dragon.30
	desc = "EVTDESCdragon.30"
	picture = "GFX_evt_dragon_flame_death"
	
	is_triggered_only = yes
	
	show_from_from = yes

	option = {
		name = "EVTOPTAdragon.30"	
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_LOST_TO_WILD_DRAGON
				portrait = [FromFrom.GetID]
			}
		}
		if = {
			limit = {
				has_character_flag = tame_dragon
				any_friend = { character = FROMFROM }
			}
			clr_character_flag = tame_dragon
			FROM = {
				FROM = {
					tooltip = { remove_friend = ROOT }
					hidden_tooltip = { character_event = { id = dragon.1599 } }
				}
			}
		}
		if = {
			limit = {
				in_command = yes
			}
			morale = -0.5
		}	
		prestige = -100
		random_friend = {
			limit = {
				ROOT = { can_use_dragon_abilities_trigger = yes }
				trait = dragon
				is_alive = yes
				NOT = { character = FROMFROM }
			}
			random_list = {
				30 = {
				}
				50 = {
					if = {
						limit = { trait = wounded_dragon }
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
					if = {
						limit = { 
							NOT = { trait = wounded_dragon }
							NOT = { trait = maimed_dragon }
						}
						hidden_tooltip = { character_event = { id = dragon.91 } }
						add_trait = wounded_dragon
					}
				}
				20 = {
					death = {
						death_reason = death_dragon_duel
						killer = FROMFROM
					}
				}					
			}
		}
		random_list = {
			25 = {
				hidden_tooltip = { add_trait = fed_to_dragon }
				red_god_resurrect_effect = yes #check for rhllor resurrection
				death = {
					death_reason = death_dragon
					killer = FROMFROM
				}
			}
			25 = {
				add_trait = depressed
				hidden_tooltip = {
					character_event ={
						id = 38288 #Notify
					}
				}
			}
			20 = {
				add_trait_silently_wounded_effect = yes
				hidden_tooltip = {
					character_event ={
						id = 38280 #Notify
					}
				}
			}
			20 = {
				trigger = { NOT = { trait = burned } }
				add_trait = burned
				hidden_tooltip = { character_event = { id = trait_notification.23 } }					
			}
			10 = {
				add_maimed_trait_effect = yes
			}			
		}		
	}	
}
###Field of Fire###
character_event = { #AI pulse event trigger, player uses decision
	id = dragon.3199

	is_triggered_only = yes
	hide_window = yes
	ai = yes
	
	trigger = { #same conditions as field_of_fire_dec
		can_use_dragon_abilities_trigger = yes
		trigger_if = {
			limit = { can_use_dragon_abilities_trigger = yes }
			any_friend = {
				trait = dragon
				is_alive = yes
				age = 2
				NOT = { trait = maimed_dragon }
				martial = 20 #AI never use a young dragon in battle
			}	
		}	
		OR = {
			NOT = { has_character_flag = dragonduel }
			had_character_flag = { flag = dragonduel days = 10 }
		}
		OR = {
			had_character_flag = { flag = dragon_used_battle days = 15 } 
			NOT = { has_character_flag = dragon_used_battle }
		}
		NOT = {
			dragon_rider = {
				at_location = ROOT
				is_alive = yes											
				prisoner = no
				in_command = yes
				NOT = { character = ROOT }
				OR = {
					war_with = ROOT
					any_liege = { war_with = ROOT }
					AND = {
						ROOT = { war = no }
						OR = {
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { ROOT = { any_liege = { war_with = PREVPREV } } }
						}
					}
				}
			}
		}
		NOT = {
			dragon = {
				can_use_dragon_abilities_trigger = yes
				at_location = ROOT
				is_alive = yes											
				prisoner = no
				in_command = yes
				NOT = { character = ROOT }
				OR = {
					war_with = ROOT
					any_liege = { war_with = ROOT }
					AND = {
						ROOT = { war = no }
						OR = {
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { ROOT = { any_liege = { war_with = PREVPREV } } }
						}
					}
				}
			}
		}
		custom_tooltip = {
			text = TOOLTIPfield_of_fire_decTERRAIN
			hidden_tooltip = {
				NOT = {
					location = { 
						OR = {
							terrain = mountain 
							terrain = desert
						}	
					}
				}	
			}
		}	
		custom_tooltip = {
			text = TOOLTIPfield_of_fire_dec
			hidden_tooltip = {
				# location = {
					# any_province_character = {
						# at_location = ROOT
						# prisoner = no
						# in_command = yes
						# OR = {
							# war_with = ROOT
							# any_liege = { war_with = ROOT }
							# ROOT = { any_liege = { war_with = PREVPREV } }
							# any_liege = { ROOT = { any_liege = { war_with = PREVPREV } } }
						# }
					# }
				# }
				OR = {
					AND = {
						is_ruler = yes
						war = yes
						any_current_enemy = {
							#war_with = ROOT
							OR = {
								AND = {
									at_location = ROOT
									prisoner = no
									in_command = yes
								}
								any_realm_lord = {
									at_location = ROOT
									prisoner = no
									in_command = yes
								}
								any_courtier = {
									at_location = ROOT
									prisoner = no
									in_command = yes
								}
							}	
						}
					}
					AND = {
						#war = no # Your liege's wars still count
						any_liege = {
							any_current_enemy = {
								#war_with = PREV
								OR = {
									AND = {
										at_location = ROOT
										prisoner = no
										in_command = yes
									}
									any_realm_lord = {
										at_location = ROOT
										prisoner = no
										in_command = yes
									}
									any_courtier = {
										at_location = ROOT
										prisoner = no
										in_command = yes
									}
								}	
							}
						}
					}						
					any_independent_ruler = {
						mercenary = yes
						at_location = ROOT
						in_command = yes
						prisoner = no
					}				
				}	
			}
		}	
	}
	
	immediate = {
		set_character_flag = dragon_used_battle
		character_event = { id = dragon.31 tooltip = "EVTTOOLTIPdragon.31" }	
	}
}	
character_event = {
	id = dragon.31
	desc = "EVTDESCdragon.31"
	title = "EVTNAMEdragon.31"
	
	picture = "GFX_evt_dragon_riding_3"

	is_triggered_only = yes
	
	immediate = { #Determine Dragon Strength
		set_variable = { which = "dragon_strength" value = 0 }
		if = {
			limit = { can_use_dragon_abilities_trigger = yes	}
			random_friend = {
				limit = {
					trait = dragon
					is_alive = yes
				}
				save_event_target_as = the_dragon
				ROOT = {
					export_to_variable = {
					   which = dragon_strength
					   value = martial
					   who = PREV
					}
				}	
			}	
		}
		else_if = {
			limit = {
				graphical_culture = dragongfx
				OR = {
					has_alternate_start_parameter = { key = special_culture value = animal_kingdoms } 
					has_alternate_start_parameter = { key = special_culture value = animal_world }
					has_alternate_start_parameter = { key = special_culture value = all } 
				}
			}
			save_event_target_as = the_dragon
			export_to_variable = {
			   which = dragon_strength
			   value = martial
			   who = THIS
			}
		}
	}

	option = {
		name = "BURN_THEM_ALL"
		ai_chance = {
			factor = 75

			modifier = { 
				factor = 4
				trait = ruthless
			}
			modifier = { 
				factor = 3
				trait = wroth
			}
			modifier = { 
				factor = 3
				trait = brave
			}
			modifier = { 
				factor = 3
				trait = cruel
			}
			modifier = { 
				factor = 3
				trait = lunatic
			}
			modifier = { 
				factor = 0.25
				trait = honorable
			}
			modifier = { 
				factor = 0.33
				trait = patient
			}
			modifier = { 
				factor = 0.33
				trait = kind
			}
			modifier = { 
				factor = 0.33
				trait = craven
			}
			# modifier = { #AI never use a young dragon in battle CHECKED IN DECISION
				# factor = 0
				# ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 20 } } }
			# }
			modifier = { 
				factor = 0.33
				NOT = { check_variable = { which = "dragon_strength" value = 40 } }
			}
			modifier = { 
				factor = 1.33
				check_variable = { which = "dragon_strength" value = 80 }
			}
			modifier = { 
				factor = 1.5
				check_variable = { which = "dragon_strength" value = 100 }
			}
		}
		set_character_flag = dragon_intel_fof 
		pacifists_lose_piety_effect = yes
		event_target:the_dragon = {
			prestige = 50
			if = {
				limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 20 } } } }
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 5
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 10
						hidden_tooltip = { character_event = { id = dragon.91 } }
						add_trait = wounded_dragon
					}
				}
			}	
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 20 }
						NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 4
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 8
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 40 }
						NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 3
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 6
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 60 }
						NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 2
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 4
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 80 }
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 1
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 2
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
		}
		#hidden_tooltip = {
			# location = {
				# any_province_character = {
					# limit = {
						# at_location = ROOT
						# prisoner = no
						# in_command = yes
						# OR = {
							# war_with = ROOT
							# any_liege = { war_with = ROOT }
							# ROOT = { any_liege = { war_with = PREVPREV } }
							# any_liege = { ROOT = { any_liege = { war_with = PREVPREV } } }
						# }
					# }	
					# if = {
						# limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 10 } } } }
						# troops = -0.05
						# morale = -0.45
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 10 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 20 } } 
							# }
						# }
						# troops = -0.05
						# morale = -0.5
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 20 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 30 } } 
							# }
						# }
						# troops = -0.1
						# morale = -0.55
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 30 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
							# }
						# }
						# troops = -0.1
						# morale = -0.6
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 40 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 50 } } 
							# }
						# }
						# troops = -0.15
						# morale = -0.65
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 50 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
							# }
						# }
						# troops = -0.15
						# morale = -0.7
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 60 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 70 } } 
							# }
						# }
						# troops = -0.2
						# morale = -0.75
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 70 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
							# }
						# }
						# troops = -0.2
						# morale = -0.8
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 80 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 90 } } 
							# }
						# }
						# troops = -0.25
						# morale = -0.85
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 90 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 100 } } 
							# }
						# }
						# troops = -0.25
						# morale = -0.9
					# }
					# if = {
						# limit = { ROOT = { check_variable = { which = "dragon_strength" value = 100 } } }
						# troops = -0.3
						# morale = -0.95
					# }	
					# set_character_flag = dragon_fof_event
					# hidden_tooltip = { character_event = { id = dragon.32 } }
				# }
			# }
			if = {
				limit = { 
					is_ruler = yes
					war = yes
					OR = {
						is_primary_war_attacker = yes
						is_primary_war_defender = yes
						independent = yes
					}
				}
				any_current_enemy = {
					limit = { 
						at_location = ROOT
						in_command = yes
						prisoner = no
						NOT = { can_use_dragon_abilities_trigger = yes }
					}
					if = {
						limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 10 } } } }
						troops = -0.025
						morale = -0.15
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 10 } 
								NOT = { check_variable = { which = "dragon_strength" value = 20 } } 
							}
						}
						troops = -0.025
						morale = -0.2
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 20 } 
								NOT = { check_variable = { which = "dragon_strength" value = 30 } } 
							}
						}
						troops = -0.05
						morale = -0.25
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 30 } 
								NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
							}
						}
						troops = -0.05
						morale = -0.3
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 40 } 
								NOT = { check_variable = { which = "dragon_strength" value = 50 } } 
							}
						}
						troops = -0.1
						morale = -0.35
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 50 } 
								NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
							}
						}
						troops = -0.1
						morale = -0.4
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 60 } 
								NOT = { check_variable = { which = "dragon_strength" value = 70 } } 
							}
						}
						troops = -0.15
						morale = -0.45
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 70 } 
								NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
							}
						}
						troops = -0.15
						morale = -0.5
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 80 } 
								NOT = { check_variable = { which = "dragon_strength" value = 90 } } 
							}
						}
						troops = -0.2
						morale = -0.55
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 90 } 
								NOT = { check_variable = { which = "dragon_strength" value = 100 } } 
							}
						}
						troops = -0.2
						morale = -0.6
					}
					if = {
						limit = { ROOT = { check_variable = { which = "dragon_strength" value = 100 } } }
						troops = -0.25
						morale = -0.65
					}	
					if = {
						limit = { NOT = { has_character_flag = dragon_fof_event } }
						set_character_flag = dragon_fof_event
						hidden_tooltip = { character_event = { id = dragon.32 } }
					}	
				}	
				any_current_enemy = {
					any_realm_character = {
						limit = { 
							at_location = ROOT
							in_command = yes
							prisoner = no
							NOT = { can_use_dragon_abilities_trigger = yes }
							NOT = { has_character_flag = dragon_fof_event }
						}
						if = {
							limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 10 } } } }
							troops = -0.025
							morale = -0.15
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 10 } 
									NOT = { check_variable = { which = "dragon_strength" value = 20 } } 
								}
							}
							troops = -0.025
							morale = -0.2
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 20 } 
									NOT = { check_variable = { which = "dragon_strength" value = 30 } } 
								}
							}
							troops = -0.05
							morale = -0.25
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 30 } 
									NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
								}
							}
							troops = -0.05
							morale = -0.3
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 40 } 
									NOT = { check_variable = { which = "dragon_strength" value = 50 } } 
								}
							}
							troops = -0.1
							morale = -0.35
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 50 } 
									NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
								}
							}
							troops = -0.1
							morale = -0.4
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 60 } 
									NOT = { check_variable = { which = "dragon_strength" value = 70 } } 
								}
							}
							troops = -0.15
							morale = -0.45
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 70 } 
									NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
								}
							}
							troops = -0.15
							morale = -0.5
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 80 } 
									NOT = { check_variable = { which = "dragon_strength" value = 90 } } 
								}
							}
							troops = -0.2
							morale = -0.55
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 90 } 
									NOT = { check_variable = { which = "dragon_strength" value = 100 } } 
								}
							}
							troops = -0.2
							morale = -0.6
						}
						if = {
							limit = { ROOT = { check_variable = { which = "dragon_strength" value = 100 } } }
							troops = -0.25
							morale = -0.65
						}	
						if = {
							limit = { NOT = { has_character_flag = dragon_fof_event } }
							set_character_flag = dragon_fof_event
							hidden_tooltip = { character_event = { id = dragon.32 } }
						}				
					}			
				}
			}	
			any_liege = {
				limit = {
					NOT = { character = ROOT }
					war = yes
					OR = {
						is_primary_war_attacker = yes
						is_primary_war_defender = yes
						independent = yes
					}
				}
				any_current_enemy = {
					limit = { 
						at_location = ROOT
						in_command = yes
						prisoner = no
						NOT = { can_use_dragon_abilities_trigger = yes }
						NOT = { has_character_flag = dragon_fof_event }
					}
					if = {
						limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 10 } } } }
						troops = -0.025
						morale = -0.15
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 10 } 
								NOT = { check_variable = { which = "dragon_strength" value = 20 } } 
							}
						}
						troops = -0.025
						morale = -0.2
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 20 } 
								NOT = { check_variable = { which = "dragon_strength" value = 30 } } 
							}
						}
						troops = -0.05
						morale = -0.25
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 30 } 
								NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
							}
						}
						troops = -0.05
						morale = -0.3
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 40 } 
								NOT = { check_variable = { which = "dragon_strength" value = 50 } } 
							}
						}
						troops = -0.1
						morale = -0.35
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 50 } 
								NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
							}
						}
						troops = -0.1
						morale = -0.4
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 60 } 
								NOT = { check_variable = { which = "dragon_strength" value = 70 } } 
							}
						}
						troops = -0.15
						morale = -0.45
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 70 } 
								NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
							}
						}
						troops = -0.15
						morale = -0.5
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 80 } 
								NOT = { check_variable = { which = "dragon_strength" value = 90 } } 
							}
						}
						troops = -0.2
						morale = -0.55
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 90 } 
								NOT = { check_variable = { which = "dragon_strength" value = 100 } } 
							}
						}
						troops = -0.2
						morale = -0.6
					}
					if = {
						limit = { ROOT = { check_variable = { which = "dragon_strength" value = 100 } } }
						troops = -0.25
						morale = -0.65
					}	
					if = {
						limit = { NOT = { has_character_flag = dragon_fof_event } }
						set_character_flag = dragon_fof_event
						hidden_tooltip = { character_event = { id = dragon.32 } }
					}
				}	
				any_current_enemy = {
					any_realm_character = {
						limit = { 
							at_location = ROOT
							in_command = yes
							prisoner = no
							NOT = { can_use_dragon_abilities_trigger = yes }
							NOT = { has_character_flag = dragon_fof_event }
						}
						if = {
							limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 10 } } } }
							troops = -0.025
							morale = -0.15
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 10 } 
									NOT = { check_variable = { which = "dragon_strength" value = 20 } } 
								}
							}
							troops = -0.025
							morale = -0.2
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 20 } 
									NOT = { check_variable = { which = "dragon_strength" value = 30 } } 
								}
							}
							troops = -0.05
							morale = -0.25
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 30 } 
									NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
								}
							}
							troops = -0.05
							morale = -0.3
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 40 } 
									NOT = { check_variable = { which = "dragon_strength" value = 50 } } 
								}
							}
							troops = -0.1
							morale = -0.35
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 50 } 
									NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
								}
							}
							troops = -0.1
							morale = -0.4
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 60 } 
									NOT = { check_variable = { which = "dragon_strength" value = 70 } } 
								}
							}
							troops = -0.15
							morale = -0.45
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 70 } 
									NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
								}
							}
							troops = -0.15
							morale = -0.5
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 80 } 
									NOT = { check_variable = { which = "dragon_strength" value = 90 } } 
								}
							}
							troops = -0.2
							morale = -0.55
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 90 } 
									NOT = { check_variable = { which = "dragon_strength" value = 100 } } 
								}
							}
							troops = -0.2
							morale = -0.6
						}
						if = {
							limit = { ROOT = { check_variable = { which = "dragon_strength" value = 100 } } }
							troops = -0.25
							morale = -0.65
						}	
						if = {
							limit = { NOT = { has_character_flag = dragon_fof_event } }
							set_character_flag = dragon_fof_event
							hidden_tooltip = { character_event = { id = dragon.32 } }
						}			
					}			
				}
			}
			# any_independent_ruler = {
				# limit = {
					# mercenary = yes
					# at_location = ROOT
					# in_command = yes
					# prisoner = no
					# NOT = { can_use_dragon_abilities_trigger = yes }
					# NOT = { has_character_flag = dragon_fof_event }
				# }
				# if = {
					# limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 10 } } } }
					# troops = -0.05
					# morale = -0.45
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 10 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 20 } } 
						# }
					# }
					# troops = -0.05
					# morale = -0.5
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 20 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 30 } } 
						# }
					# }
					# troops = -0.1
					# morale = -0.55
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 30 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
						# }
					# }
					# troops = -0.1
					# morale = -0.6
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 40 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 50 } } 
						# }
					# }
					# troops = -0.15
					# morale = -0.65
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 50 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
						# }
					# }
					# troops = -0.15
					# morale = -0.7
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 60 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 70 } } 
						# }
					# }
					# troops = -0.2
					# morale = -0.75
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 70 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
						# }
					# }
					# troops = -0.2
					# morale = -0.8
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 80 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 90 } } 
						# }
					# }
					# troops = -0.25
					# morale = -0.85
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 90 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 100 } } 
						# }
					# }
					# troops = -0.25
					# morale = -0.9
				# }
				# if = {
					# limit = { ROOT = { check_variable = { which = "dragon_strength" value = 100 } } }
					# troops = -0.3
					# morale = -0.95
				# }				
				# if = {
					# limit = { NOT = { has_character_flag = dragon_fof_event } }
					# set_character_flag = dragon_fof_event
					# hidden_tooltip = { character_event = { id = dragon.32 } }
				# }
			# }
			random = {
				chance = 33
				location = { province_event = { id = dragon.25 } }
			}
		#}	
	}
	option = {
		name = "not_now_dracarys"
		ai_chance = {
			factor = 5
		}
		if = {
			limit = { ai = no }
			clr_character_flag = dragon_used_battle
		}	
	}
}
#attacked by dragon during battle
character_event = {
	id = dragon.32
	desc = "getting_burned" #fieldoffire
	title = "EVTNAMEdragon.31"
	
	picture = "GFX_fieldoffire"

	is_triggered_only = yes
	min_age = 14
	capable_only = yes
	prisoner = no

	trigger = {
		NOT = { can_use_dragon_abilities_trigger = yes }
		FROM = {
			NOT = { character = ROOT }
			can_use_dragon_abilities_trigger = yes
		}
	}
	
	#run
	option = {
		name = "your_host_just_got_burned_by_dragons"
		trigger = { NOT = { trait = white_walker } }
		prestige = -30
		ai_chance = {
			factor = 25
			modifier = {
				factor = 4
				in_command = no
			}
			modifier = {
				factor = 2
				trait = craven 
			}
			modifier = {
				factor = 1.5
				is_weak_trigger = yes 
			}	
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 martial = 40 } }
			}
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 martial = 60 } }
			}
			modifier = {
				factor = 2
				FROM = { any_friend = { trait = dragon age = 2 martial = 80 } }
			}
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 martial = 100 } }
			}
			modifier = {
				factor = 1.5
				FROM = { graphical_culture = dragongfx martial = 40 }
			}
			modifier = {
				factor = 1.5
				FROM = { graphical_culture = dragongfx martial = 60 }
			}
			modifier = {
				factor = 2
				FROM = { graphical_culture = dragongfx martial = 80 }
			}
			modifier = {
				factor = 1.5
				FROM = { graphical_culture = dragongfx martial = 100 }
			}
		}
		clr_character_flag = dragon_fof_event	
		set_character_flag = ran_from_dragon			
	}
	#stand
	option = {
		name = "stand_and_fight"
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				trait = trained_warrior 
			}
			modifier = {
				factor = 4
				trait = skilled_warrior 
			}
			modifier = {
				factor = 8
				trait = master_warrior 
			}
			modifier = {
				factor = 5
				trait = dragon_slayer 
			}
			modifier = {
				factor = 2
				trait = proud 
			}
			modifier = {
				factor = 3
				trait = brave 
			}
			modifier = {
				factor = 3
				trait = lunatic 
			}
			modifier = {
				factor = 3
				trait = wroth
			}
			modifier = {
				factor = 2
				NOT = { trait = craven }
			}	
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 trait = wounded_dragon } }
			}
			modifier = {
				factor = 2
				FROM = { any_friend = { trait = dragon age = 2 trait = maimed_dragon } }
			}	
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 trait = sickly_dragon } }
			}	
			modifier = {
				factor = 1.5
				FROM = { graphical_culture = dragongfx trait = wounded_dragon }
			}
			modifier = {
				factor = 2
				FROM = { graphical_culture = dragongfx trait = maimed_dragon }
			}	
			modifier = {
				factor = 1.5
				FROM = { graphical_culture = dragongfx trait = sickly_dragon }
			}			
		}
		clr_character_flag = dragon_fof_event	
		set_character_flag = battle_dragon
		event_target:the_dragon = {
			character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 }
		}				
	}
}
#Meeting a dragonrider in battle
character_event = { 
	id = dragon.33
	border = "GFX_event_normal_frame_war"
	desc = "getting_burned" #fieldoffire
	title = "EVTNAMEdragon.31"
	picture = "GFX_evt_dragon_riding_2"

	is_triggered_only = yes
	
	trigger = {
		in_battle = yes
		NOT = { has_character_flag = battle_dragon }
		OR = {
			NOT = { has_character_flag = ran_from_dragon }
			had_character_flag = { flag = ran_from_dragon days = 90 } 
		}
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		can_use_dragon_abilities_trigger = no
	}
	
	#run
	option = {
		name = "your_host_just_got_burned_by_dragons"
		prestige = -30
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2
				trait = craven 
			}
			modifier = {
				factor = 1.5
				is_weak_trigger = yes 
			}	
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 martial = 40 } }
			}
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 martial = 60 } }
			}
			modifier = {
				factor = 2
				FROM = { any_friend = { trait = dragon age = 2 martial = 80 } }
			}
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 martial = 100 } }
			}
			modifier = {
				factor = 1.5
				FROM = { graphical_culture = dragongfx martial = 40 }
			}
			modifier = {
				factor = 1.5
				FROM = { graphical_culture = dragongfx martial = 60 }
			}
			modifier = {
				factor = 2
				FROM = { graphical_culture = dragongfx martial = 80 }
			}
			modifier = {
				factor = 1.5
				FROM = { graphical_culture = dragongfx martial = 100 }
			}
		}
		set_character_flag = ran_from_dragon			
	}
	#stand
	option = {
		name = "stand_and_fight"
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				trait = trained_warrior 
			}
			modifier = {
				factor = 4
				trait = skilled_warrior 
			}
			modifier = {
				factor = 8
				trait = master_warrior 
			}
			modifier = {
				factor = 5
				trait = dragon_slayer 
			}
			modifier = {
				factor = 2
				trait = proud 
			}
			modifier = {
				factor = 3
				trait = brave 
			}
			modifier = {
				factor = 3
				trait = lunatic 
			}
			modifier = {
				factor = 3
				trait = wroth
			}
			modifier = {
				factor = 2
				NOT = { trait = craven }
			}	
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 trait = wounded_dragon } }
			}
			modifier = {
				factor = 2
				FROM = { any_friend = { trait = dragon age = 2 trait = maimed_dragon } }
			}	
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 trait = sickly_dragon } }
			}		
			modifier = {
				factor = 1.5
				FROM = { graphical_culture = dragongfx trait = wounded_dragon }
			}
			modifier = {
				factor = 2
				FROM = { graphical_culture = dragongfx trait = maimed_dragon }
			}	
			modifier = {
				factor = 1.5
				FROM = { graphical_culture = dragongfx trait = sickly_dragon }
			}
		}
		morale = 0.1	
		set_character_flag = battle_dragon
		event_target:the_dragon = {
			character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 }
		}		
	}	
}
#Inform I killed dragon in battle
character_event = {
	id = dragon.3410
	desc = "EVTDESCdragon.3410"
	picture = "GFX_evt_dragon_death_battle"
	
	is_triggered_only = yes
	show_from_from = yes
	
	option = {
		name = "EVTOPTAdragon.28"
		tooltip = {
			FROM = {
				FROM = {
					death = yes
				}
			}
		}
		add_trait = dragon_slayer
		if = {
			limit = { 
				has_nickname = no 
				NOT = { trait = dragon }
				NOT = { can_use_dragon_abilities_trigger = yes }
			}
			give_nickname = nick_the_dragonslayer
		}
		prestige = 300
		morale = 0.5
		FROMFROM = {
			if = {
				limit = {
					is_blood_relative_of_root_trigger = yes
					ROOT = { 
						is_any_kinslayer_trigger = no 
						NOT = { trait = suspected_kinslayer }
						NOT = { has_cutthroat_religion_trigger = yes }
					}					
				}
				ROOT = { add_trait = suspected_kinslayer }
			}
			hidden_tooltip = {
				character_event = { id = dragon.3499 }		
			}
		}	
		if = {
			limit = { ai = no }
			FROMFROM = {
				random_friend = {
					save_event_target_as = dragons_rider #for localisation
				}
			}
			chronicle = {
				entry = CHRONICLE_SLAYED_DRAGON_IN_BATTLE
				portrait = [FromFrom.GetID]
			}
		}
	}
}
character_event = { #set dragon scope
	id = dragon.3499
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random_friend = { character_event = { id = dragon.34 } }
		any_playable_ruler = { #inform world
			limit = { 
				ai = no  
				NOT = { character = FROM }
				NOT = { is_friend = ROOT }
			}	
			character_event = { id = dragon.36 } #slain combat
		}
		death = {
			death_reason = death_battle
			killer = FROM
		}
	}

	option = {
		name = OK
	}
}	
character_event = {
	id = dragon.34
	desc = "EVTDESCdragon.34"
	picture = "GFX_evt_dragon_death_battle"
	
	show_from_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.34"
		remove_trait = dragon_rider
		if = { #Check dragon riding dynasty status
			limit = {
				NOT = { dynasty = 0 }
				has_dynasty_flag = dragon_riding_dynasty
				NOT = { any_dynasty_member = { can_use_dragon_abilities_trigger = yes	is_alive = yes } }
			}
			clr_dynasty_flag = dragon_riding_dynasty
		}
		
		random_list = {
			35 = {
			}
			25 = {
				add_trait = depressed
				hidden_tooltip = {
					character_event ={
						id = 38288 #Notify
					}
				}
			}
			15 = {
				add_trait_silently_wounded_effect = yes
				hidden_tooltip = {
					character_event ={
						id = 38280 #Notify
					}
				}
			}
			10 = {
				trigger = { NOT = { trait = burned } }
				add_trait = burned
				hidden_tooltip = { character_event = { id = trait_notification.23 } }					
			}
			10 = {
				add_maimed_trait_effect = yes
			}
			5 = {
				red_god_resurrect_effect = yes #check for rhllor resurrection
				death = {
					death_reason = death_battle
					killer = FROMFROM
				}
			}
		}
	}
}

#Inform dragon already dead
character_event = {
	id = dragon.35
	desc = "EVTDESCdragon.35"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes

	show_from_from = yes
		
	option = {
		name = "EVTOPTAdragon.35"
		prestige = 25
	}
}
#World dragon slain battle notification
character_event = {
	id = dragon.36
	desc = "EVTDESCdragon.36"
	picture = "GFX_evt_dragon_death_battle"
	
	is_triggered_only = yes
	
	show_from_from = yes
	
	trigger = {
		NOT = { has_character_flag = no_dragon_battle_slain_inform }
	}
	
	option = {
		name = "EVTOPTAdragon.36"
		chronicle = {
			entry = CHRONICLE_SLAYED_DRAGON_IN_BATTLE_FROM
			portrait = [FromFrom.GetID]
		}
		FROM = {
			FROM = {
				tooltip = { show_portrait = yes }
			}
		}
		FROM = {
			tooltip = { show_portrait = yes }
		}	
	}	
	option = {
		name = "EVTOPTBdragon.1198"	
		trigger = { ai = no }
		set_character_flag = no_dragon_battle_slain_inform
	}
}
#battle against dragon lost (dragon rider)
character_event = {
	id = dragon.3710
	desc = "EVTDESCdragon.3710"
	picture = "GFX_evt_dragon_flame_death"
	
	is_triggered_only = yes
	show_from_from = yes

	option = {
		name = "EVTOPTAdragon.30"	
		hidden_tooltip = {
			FROM = {
				FROM = {
					random_friend = {
						character_event = { id = dragon.37 }
					}
				}
			}
			if = {
				limit = { ai = no }
				FROMFROM = {
					random_friend = {
						save_event_target_as = dragons_rider #for localisation
					}
				}
				chronicle = {
					entry = CHRONICLE_LOST_TO_DRAGON_IN_BATTLE
					portrait = [FromFrom.GetID]
				}
			}
		}
		if = {
			limit = {
				in_command = yes
			}
			morale = -0.5
		}	
		prestige = -25
		random_list = {
			25 = {
				set_character_flag = death
				tooltip = {
					death = {
						death_reason = death_battle_dragon_fire
						killer = FROM
					}
				}	
			}
			25 = {
				set_character_flag = depressed
				add_trait = depressed
				hidden_tooltip = {
					character_event ={
						id = 38288 #Notify
					}
				}
			}
			20 = {
				set_character_flag = wounded
				add_trait_silently_wounded_effect = yes
				hidden_tooltip = {
					character_event ={
						id = 38280 #Notify
					}
				}
			}
			20 = {
				trigger = { NOT = { trait = burned } }
				set_character_flag = burned
				add_trait = burned
				hidden_tooltip = { character_event = { id = trait_notification.23 } }					
			}
			10 = {
				set_character_flag = maimed
				add_maimed_trait_effect = yes
			}
		}
	}	
}
#Inform Rider enemy KIA against dragon
character_event = {
	id = dragon.37
	picture = "GFX_evt_dragon_flame_death"
	
	desc = {
		text = "EVTDESCAdragon.37"
		trigger = { FROM = { NOT = { has_character_flag = death } } }
	}
	desc = {
		text = "EVTDESCBdragon.37"
		trigger = { FROM = { has_character_flag = death } }
	}
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.37"
		FROM = {
			if = {
				limit = { has_character_flag = death }
				ROOT_murder_red_god_resurrect_effect = yes #check for rhllor resurrection
				if = {
					limit = {
						is_blood_relative_of_root_trigger = yes
						ROOT = { 
							is_any_kinslayer_trigger = no 
							NOT = { trait = suspected_kinslayer }
							NOT = { has_cutthroat_religion_trigger = yes }
						}					
					}
					ROOT = { add_trait = suspected_kinslayer }
				}
				death = {
					death_reason = death_battle_dragon_fire
					killer = ROOT
				}
			}
			if = {
				limit = { has_character_flag = depressed }
				tooltip = {
					add_trait = depressed
				}
				clr_character_flag = depressed
			}
			if = {
				limit = { has_character_flag = wounded }
				tooltip = {
					add_trait_silently_wounded_effect = yes
				}
				clr_character_flag = wounded
			}
			if = {
				limit = { has_character_flag = burned }
				tooltip = {
					add_trait = burned
				}
				clr_character_flag = burned
			}
			if = {
				limit = { has_character_flag = maimed }
				tooltip = {
					add_maimed_trait_effect = yes
				}
				clr_character_flag = maimed
			}
		}
	}
}


# #Lord defeated by dragon
# character_event = {
	# id = 3370037
	# desc = "EVTDESC3370037"
	# picture = "GFX_valyria_dragon"
	# is_triggered_only = yes
	# hide_from = yes
	# show_from_from = yes
	# option = {
		# name = "EVTOPTA3370037"
		# FROM = {
			# FROM = {
				# hidden_tooltip = {
					# prestige = 0
				# }
			# }
		# }
	# }
# }
###Siege of fire###
character_event = {
	id = dragon.38
	desc = "siege_of_fire"
	picture = "GFX_siegeoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes

	trigger = {
		can_use_dragon_abilities_trigger = yes
	}
	
	immediate = { #Determine Dragon Strength
		set_variable = { which = "dragon_strength" value = 0 }
		if = {
			limit = { can_use_dragon_abilities_trigger = yes	}
			random_friend = {
				limit = {
					trait = dragon
					is_alive = yes
				}
				save_event_target_as = riders_dragon
				ROOT = {
					export_to_variable = {
					   which = dragon_strength
					   value = martial
					   who = PREV
					}
				}	
			}	
		}
		else_if = {
			limit = {
				graphical_culture = dragongfx
				OR = {
					has_alternate_start_parameter = { key = special_culture value = animal_kingdoms } 
					has_alternate_start_parameter = { key = special_culture value = animal_world }
					has_alternate_start_parameter = { key = special_culture value = all } 
				}
			}
			save_event_target_as = riders_dragon
			export_to_variable = {
			   which = dragon_strength
			   value = martial
			   who = THIS
			}
		}	
	}
	
	option = {
		name = "BURN_THEM_ALL"
		ai_chance = {
			factor = 75
			modifier = { #Don't burn own/liege's castle
				factor = 0
				location = {
					any_province_lord = {
						OR = {
							character = ROOT
							ROOT = { is_liege_or_above = PREV }
						}	
					}
				}
			}
			modifier = { #Reluctant to burn same realm castles, unless ruthless
				factor = 0.2
				NOT = { trait = ruthless }
				location = {
					any_province_lord = {
						same_realm = ROOT
					}
				}
			}
			modifier = { #Enemy's castle
				factor = 2
				location = {
					any_province_lord = {
						any_current_enemy = { character = ROOT }	
					}
				}
			}
			modifier = { 
				factor = 0.2 #My family is in castle
				location = {
					any_province_character = {
						is_close_relative = ROOT
						in_command = no					
						at_location = ROOT		
						NOT = { character = ROOT }	
						NOT = { educator = { character = ROOT } }
					}
				}
			}
			modifier = { 
				factor = 4
				trait = ruthless
			}
			modifier = { 
				factor = 3
				trait = wroth
			}
			modifier = { 
				factor = 3
				trait = cruel
			}
			modifier = { 
				factor = 3
				trait = ambitious
			}
			modifier = { 
				factor = 3
				trait = lunatic
			}
			# modifier = { #AI never use a young dragon in siege CHECKED IN DECISION
				# factor = 0
				# ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 20 } } }
			# }
			modifier = { 
				factor = 0.66
				ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 40 } } }
			}
			modifier = { 
				factor = 1.33
				ROOT = { check_variable = { which = "dragon_strength" value = 80 } } 
			}
			modifier = { 
				factor = 1.5
				ROOT = { check_variable = { which = "dragon_strength" value = 100 } } 
			}
		}
		trigger = {
			NOT = {
				dragon_rider = {
					OR = {
						NOT = { has_character_flag = stayed_castle_dd }
						had_character_flag = { flag = stayed_castle_dd days = 10 }
					}				
					at_location = ROOT
					any_friend = { trait = dragon age = 2 }
					in_command = no
					prisoner = no
					NOT = { trait = incapable }
					NOT = { is_inaccessible_trigger = yes }
					OR = {
						war_with = ROOT
						ROOT = { any_liege = { war_with = PREVPREV } }
						any_liege = { 
							OR = {
								war_with = ROOT 
								ROOT = { any_liege = { war_with = PREVPREV } }
							}	
						}
					}
					NOT = {
						OR = {
							is_liege_or_above = ROOT
							ROOT = { is_liege_or_above = PREV }
						}
					}				
				}
			}
			NOT = {
				dragon = {
					OR = {
						NOT = { has_character_flag = stayed_castle_dd }
						had_character_flag = { flag = stayed_castle_dd days = 10 }
					}				
					at_location = ROOT
					can_use_dragon_abilities_trigger = yes
					in_command = no
					prisoner = no
					NOT = { trait = incapable }
					NOT = { is_inaccessible_trigger = yes }
					OR = {
						war_with = ROOT
						ROOT = { any_liege = { war_with = PREVPREV } }
						any_liege = { 
							OR = {
								war_with = ROOT 
								ROOT = { any_liege = { war_with = PREVPREV } }
							}	
						}
					}
					NOT = {
						OR = {
							is_liege_or_above = ROOT
							ROOT = { is_liege_or_above = PREV }
						}
					}				
				}
			}
		}
		pacifists_lose_piety_effect = yes
		set_character_flag = dragon_intel_harrenhal
		siege = {
			enemy = {
				if = {
					limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 10 } } } }
					morale = -0.2
					troops = -0.2
					hidden_tooltip = { event_target:siege_of_fire_target = { character_event = { id = dragon.32 } } }
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 10 } 
							NOT = { check_variable = { which = "dragon_strength" value = 20 } } 
						}
					}
					morale = -0.25
					troops = -0.25
					hidden_tooltip = { event_target:siege_of_fire_target = { character_event = { id = dragon.32 } } }
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 20 } 
							NOT = { check_variable = { which = "dragon_strength" value = 30 } } 
						}
					}
					morale = -0.3
					troops = -0.3
					hidden_tooltip = { event_target:siege_of_fire_target = { character_event = { id = dragon.32 } } }
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 30 } 
							NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
						}
					}
					morale = -0.35
					troops = -0.35
					hidden_tooltip = { event_target:siege_of_fire_target = { character_event = { id = dragon.32 } } }
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 40 } 
							NOT = { check_variable = { which = "dragon_strength" value = 50 } } 
						}
					}
					morale = -0.4
					troops = -0.4
					hidden_tooltip = { event_target:siege_of_fire_target = { character_event = { id = dragon.32 } } }
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 50 } 
							NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
						}
					}
					morale = -0.5
					troops = -0.5
					hidden_tooltip = { event_target:siege_of_fire_target = { character_event = { id = dragon.32 } } }
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 60 } 
							NOT = { check_variable = { which = "dragon_strength" value = 70 } } 
						}
					}
					morale = -0.6
					troops = -0.6
					event_target:siege_of_fire_target = {
						random_list = {
							99 = { character_event = { id = dragon.32 tooltip = TOOLTIPdragon.32B } }
							1 = { character_event = { id = dragon.40 tooltip = TOOLTIPdragon.40 } }
						}	
					}
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 70 } 
							NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
						}
					}
					morale = -0.7
					troops = -0.7
					event_target:siege_of_fire_target = {
						random_list = {
							98 = { character_event = { id = dragon.32 tooltip = TOOLTIPdragon.32B } }
							2 = { character_event = { id = dragon.40 tooltip = TOOLTIPdragon.40 } }
						}	
					}
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 80 } 
							NOT = { check_variable = { which = "dragon_strength" value = 90 } } 
						}
					}
					morale = -0.8
					troops = -0.8
					event_target:siege_of_fire_target = {
						random_list = {
							95 = { character_event = { id = dragon.32 tooltip = TOOLTIPdragon.32B } }
							5 = { character_event = { id = dragon.40 tooltip = TOOLTIPdragon.40 } }
						}	
					}
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 90 } 
							NOT = { check_variable = { which = "dragon_strength" value = 100 } } 
						}
					}
					morale = -0.9
					troops = -0.9
					event_target:siege_of_fire_target = {
						random_list = {
							90 = { character_event = { id = dragon.32 tooltip = TOOLTIPdragon.32B } }
							10 = { character_event = { id = dragon.40 tooltip = TOOLTIPdragon.40 } }
						}	
					}
				}
				if = {
					limit = { ROOT = { check_variable = { which = "dragon_strength" value = 100 } } }
					morale = -1.0
					troops = -1.0
					event_target:siege_of_fire_target = {
						random_list = {
							80 = { character_event = { id = dragon.32 tooltip = TOOLTIPdragon.32 } }
							20 = { character_event = { id = dragon.40 tooltip = TOOLTIPdragon.40 } }
						}	
					}
				}
			}
		}
		hidden_tooltip = { event_target:siege_of_fire_target = { clear_event_target = siege_of_fire_target } }
		event_target:riders_dragon = {
			prestige = 50
			if = {
				limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 20 } } } }
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 5
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 10
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}	
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 20 }
						NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 4
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 8
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 40 }
						NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 3
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 6
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 60 }
						NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 2
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 4
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 80 }
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 1
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 2
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
		}
		location = { 
			province_event = { id = dragon.25 } 
			if = {
				limit = { 
					province_id = 107 
					has_global_flag = aegons_conquest
					ROOT = { check_variable = { which = "dragon_strength" value = 90 } }
				}
				hidden_tooltip = { remove_province_modifier = completeharren3 }
				b_kingharren1 = { add_building = ca_harrenhal_ruins }
				b_kingharren2 = { add_building = ca_harrenhal_ruins }
				b_kingharren3 = { add_building = ca_harrenhal_ruins }
			}
		}
		set_character_flag = dragon_used		
	}
	#enemy dragonrider is in castle, duel him
	option = { 
		name = "EVTOPTBdragon.38"
		trigger = {
			dragon_rider = {
				OR = {
					NOT = { has_character_flag = stayed_castle_dd }
					had_character_flag = { flag = stayed_castle_dd days = 10 }
				}
				at_location = ROOT
				any_friend = { trait = dragon age = 2 }
				in_command = no
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				OR = {
					war_with = ROOT
					ROOT = { any_liege = { war_with = PREVPREV } }
					any_liege = { 
						OR = {
							war_with = ROOT 
							ROOT = { any_liege = { war_with = PREVPREV } }
						}	
					}
				}
				NOT = {
					OR = {
						is_liege_or_above = ROOT
						ROOT = { is_liege_or_above = PREV }
					}
				}				
			}
		}
		ai_chance = {
			factor = 75
			modifier = { 
				factor = 4
				trait = brave
			}
			modifier = { 
				factor = 0.25
				trait = craven
			}
			modifier = { 
				factor = 3
				trait = wroth
			}
			modifier = { 
				factor = 3
				trait = ambitious
			}
			modifier = { 
				factor = 3
				trait = lunatic
			}
		}	
		hidden_tooltip = { event_target:siege_of_fire_target = { clear_event_target = siege_of_fire_target clr_character_flag = siege_leader } }
		dragon_rider = {
			limit = {
				OR = {
					NOT = { has_character_flag = stayed_castle_dd }
					had_character_flag = { flag = stayed_castle_dd days = 10 }
				}
				at_location = ROOT
				any_friend = { trait = dragon age = 2 }
				in_command = no
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				OR = {
					war_with = ROOT
					ROOT = { any_liege = { war_with = PREVPREV } }
					any_liege = { 
						OR = {
							war_with = ROOT 
							ROOT = { any_liege = { war_with = PREVPREV } }
						}	
					}
				}
				NOT = {
					OR = {
						is_liege_or_above = ROOT
						ROOT = { is_liege_or_above = PREV }
					}
				}			
			}
			character_event = { id = dragon.42 }
		}	
	}
	#enemy dragon!!
	option = { 
		name = "EVTOPTBdragon.38"
		trigger = {
			dragon = {
				can_use_dragon_abilities_trigger = yes
				OR = {
					NOT = { has_character_flag = stayed_castle_dd }
					had_character_flag = { flag = stayed_castle_dd days = 10 }
				}
				at_location = ROOT
				in_command = no
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				OR = {
					war_with = ROOT
					ROOT = { any_liege = { war_with = PREVPREV } }
					any_liege = { 
						OR = {
							war_with = ROOT 
							ROOT = { any_liege = { war_with = PREVPREV } }
						}	
					}
				}
				NOT = {
					OR = {
						is_liege_or_above = ROOT
						ROOT = { is_liege_or_above = PREV }
					}
				}				
			}
		}
		ai_chance = {
			factor = 75
			modifier = { 
				factor = 4
				trait = brave
			}
			modifier = { 
				factor = 0.25
				trait = craven
			}
			modifier = { 
				factor = 3
				trait = wroth
			}
			modifier = { 
				factor = 3
				trait = ambitious
			}
			modifier = { 
				factor = 3
				trait = lunatic
			}
		}	
		hidden_tooltip = { event_target:siege_of_fire_target = { clear_event_target = siege_of_fire_target clr_character_flag = siege_leader } }
		dragon = {
			limit = {
				can_use_dragon_abilities_trigger = yes
				OR = {
					NOT = { has_character_flag = stayed_castle_dd }
					had_character_flag = { flag = stayed_castle_dd days = 10 }
				}
				at_location = ROOT
				in_command = no
				prisoner = no
				NOT = { trait = incapable }
				NOT = { is_inaccessible_trigger = yes }
				OR = {
					war_with = ROOT
					ROOT = { any_liege = { war_with = PREVPREV } }
					any_liege = { 
						OR = {
							war_with = ROOT 
							ROOT = { any_liege = { war_with = PREVPREV } }
						}	
					}
				}
				NOT = {
					OR = {
						is_liege_or_above = ROOT
						ROOT = { is_liege_or_above = PREV }
					}
				}			
			}
			set_character_flag = cannot_flee_battle_duel
			character_event = { id = battle.2 tooltip = "EVTTOOLTIPbattle.2" }
		}	
	}
	option = {
		name = "not_now_dracarys"
		ai_chance = {
			factor = 25
			modifier = { 
				factor = 4
				trait = honorable
			}
			modifier = { 
				factor = 3
				trait = patient
			}
			modifier = { 
				factor = 3
				trait = kind
			}
			modifier = { 
				factor = 3
				trait = content
			}
		}
		if = {
			limit = { ai = no }
			clr_character_flag = dragon_used
		}	
		hidden_tooltip = { event_target:siege_of_fire_target = { clear_event_target = siege_of_fire_target clr_character_flag = siege_leader } }
	}	
}
#Many courtiers fried
# character_event = {
	# id = dragon.39
	# desc = "EVTDESCdragon.39"
	# picture = "GFX_siegeoffire"
	# border = "GFX_event_normal_frame_war"
	
	# is_triggered_only = yes
	
	# immediate = {
		# random = {
			# chance = 25
			# set_character_flag = no_effect
		# }
		# if = {
			# limit = {
				# NOT = { has_character_flag = no_effect }
			# }
			# random = {
				# chance = 33
				# set_character_flag = wounded_dragon
			# }
		# }	
		# if = {
			# limit = {
				# NOT = { has_character_flag = no_effect }
				# NOT = { has_character_flag = wounded_dragon }
			# }
			# random = {
				# chance = 50
				# set_character_flag = maimed
			# }
		# }	
		# if = {
			# limit = {
				# NOT = { has_character_flag = no_effect }
				# NOT = { has_character_flag = wounded_dragon }
				# NOT = { has_character_flag = maimed }
			# }
			# set_character_flag = death
		# }
	# }
	
	# option = {
		# name = "EVTOPTAdragon.39"
		# if = {
			# limit = {
				# has_character_flag = wounded_dragon 
			# }
			# add_trait = wounded_dragon
			# clr_character_flag = wounded_dragon 
		# }
		# if = {
			# limit = {
				# has_character_flag = maimed
			# }
			# add_trait = maimed_dragon
			# clr_character_flag = maimed
		# }			
		# if = {
			# limit = {
				# has_character_flag = death
			# }
			# clr_character_flag = death
			# if = {
				# limit = {
					# OR = {
						# demesne_size = 1
						# in_command = yes
						# liege = { 
							# dynasty = ROOT
							# is_close_relative = ROOT		
						# }
					# }
				# }
				# hidden_tooltip = { FROM = { character_event = { id = dragon.37 } } }
			# }
			# death = {
				# death_reason = death_battle
				# killer = FROM
			# }
			# recalc_succession = yes
		# }	
	# }
# }
#Castle decimated
character_event = {
	id = dragon.40
	desc = "EVTDESCdragon.40"
	picture = "GFX_siegeoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { ai = no }
			FROM = {
				random_friend = {
					limit = { trait = dragon }
					save_event_target_as = riders_dragon #for localisation
				}
			}
			chronicle = {
				entry = CHRONICLE_SIEGE_OF_FIRE_VICTIM
				portrait = [From.GetID]
				picture = GFX_siegeoffire
			}
		}
		hidden_tooltip = {
			if = {
				limit = { 
					NOT = { is_inaccessible_trigger = yes } 
					at_location = FROM
					# OR = {
						# in_command = no
						# has_character_flag = siege_leader
					# }
				}
				set_character_flag = death
				mother = {
					if = {
						limit = { NOT = { is_close_relative = FROM } }
						opinion = {
							modifier = opinion_burned_closed_relative
							who = FROM
							years = 25
						}
					}	
				}
				father = {
					if = {
						limit = { NOT = { is_close_relative = FROM } }
						opinion = {
							modifier = opinion_burned_closed_relative
							who = FROM
							years = 25
						}
					}	
				}
				any_child = {
					limit = {
						NOT = { is_close_relative = FROM }
						NOT = {
							has_opinion_modifier = {
								who = FROM
								modifier = opinion_burned_closed_relative
							}						
						}
					}
					opinion = {
						modifier = opinion_burned_closed_relative
						who = FROM
						years = 25
					}
				}
				any_sibling = {
					limit = {
						NOT = { is_close_relative = FROM }
						NOT = {
							has_opinion_modifier = {
								who = FROM
								modifier = opinion_burned_closed_relative
							}						
						}
					}
					opinion = {
						modifier = opinion_burned_closed_relative
						who = FROM
						years = 25
					}
				}
				spouse = {
					if = {
						limit = {
							NOT = {
								has_opinion_modifier = {
									who = FROM
									modifier = opinion_burned_closed_relative
								}						
							}
						}
						opinion = {
							modifier = opinion_burned_closed_relative
							who = FROM
							years = 25
						}				
					}
				}
				any_dynasty_member = {
					limit = {
						is_close_relative = ROOT
						NOT = { is_close_relative = FROM }
						NOT = {
							has_opinion_modifier = {
								who = FROM
								modifier = opinion_burned_closed_relative
							}						
						}
					}
					opinion = {
						modifier = opinion_burned_closed_relative
						who = FROM
						years = 25
					}				
				}
			}	
		}
	}
	
	option = {
		name = "EVTOPTAdragon.40"
		hidden_tooltip = {
			FROM = { 
				if = {
					limit = { ai = no }
					character_event = { id = dragon.41 } 
				}	
			}
			FROM = {
				location = {
					owner = {
						any_courtier = {
							limit = {
								NOT = { character = ROOT }
								NOT = { character = ROOT_FROM }
								NOT = { in_command = yes }
								at_location = ROOT_FROM
								NOT = { is_inaccessible_trigger = yes }
								NOT = { educator = { character = ROOT_FROM } }
								NOT_mythical_creature_trigger = yes
							}
							character_event = { id = dragon.4010 }
						}
						if = {
							limit = {
								NOT = { character = ROOT }
								NOT = { character = ROOT_FROM }
								NOT = { in_command = yes }
								at_location = ROOT_FROM
								NOT = { is_inaccessible_trigger = yes }
								NOT = { educator = { character = ROOT_FROM } }
								NOT_mythical_creature_trigger = yes
							}
							character_event = { id = dragon.4010 }
						}
					}
				}	
			}	
			recalc_succession = yes
		}
		tooltip = {
			if = {
				limit = { 
					NOT = { is_inaccessible_trigger = yes } 
					at_location = FROM
					# OR = {
						# in_command = no
						# has_character_flag = siege_leader
					# }
				}
				death = {
					death_reason = death_battle_dragon_fire
					killer = FROM
				}
				FROM = { 
					random_friend = {
						limit = { trait = dragon age = 2 }
						tooltip = { show_portrait = yes }
					}
				}
			}	
		}
		hidden_tooltip = {
			if = {
				limit = { has_character_flag = death }
				FROM_murder_red_god_resurrect_effect = yes #check for rhllor resurrection
				if = {
					limit = {
						is_close_relative = FROM
						FROM = { 
							is_any_kinslayer_trigger = no 
							NOT = { trait = suspected_kinslayer }
							NOT = { has_cutthroat_religion_trigger = yes }
						}					
					}
					FROM = { add_trait = suspected_kinslayer }
				}
				death = {
					death_reason = death_battle_dragon_fire
					killer = FROM
				}
			}
		}	
	}
}
#Inform i was fried in castle
character_event = {
	id = dragon.4010
	desc = "EVTDESCdragon.4010"
	picture = "GFX_siegeoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_SIEGE_OF_FIRE_VICTIM_COURTIER
				portrait = [FromFrom.GetID]
				picture = GFX_siegeoffire
			}
		}
		hidden_tooltip = {
			mother = {
				if = {
					limit = { NOT = { is_close_relative = FROMFROM } }
					opinion = {
						modifier = opinion_burned_closed_relative
						who = FROMFROM
						years = 25
					}
				}
			}
			father = {
				if = {
					limit = { NOT = { is_close_relative = FROMFROM } }
					opinion = {
						modifier = opinion_burned_closed_relative
						who = FROMFROM
						years = 25
					}
				}
			}
			any_child = {
				limit = {
					NOT = { is_close_relative = FROMFROM }
					NOT = {
						has_opinion_modifier = {
							who = FROMFROM
							modifier = opinion_burned_closed_relative
						}						
					}
				}
				opinion = {
					modifier = opinion_burned_closed_relative
					who = FROMFROM
					years = 25
				}
			}
			any_sibling = {
				limit = {
					NOT = { is_close_relative = FROMFROM }
					NOT = {
						has_opinion_modifier = {
							who = FROMFROM
							modifier = opinion_burned_closed_relative
						}						
					}
				}
				opinion = {
					modifier = opinion_burned_closed_relative
					who = FROMFROM
					years = 25
				}
			}
			spouse = {
				if = {
					limit = {
						NOT = { is_close_relative = FROMFROM }
						NOT = {
							has_opinion_modifier = {
								who = FROMFROM
								modifier = opinion_burned_closed_relative
							}						
						}
					}
					opinion = {
						modifier = opinion_burned_closed_relative
						who = FROMFROM
						years = 25
					}				
				}
			}
			any_dynasty_member = {
				limit = {
					is_close_relative = ROOT
					NOT = { is_close_relative = FROMFROM }
					NOT = {
						has_opinion_modifier = {
							who = FROMFROM
							modifier = opinion_burned_closed_relative
						}						
					}
				}
				opinion = {
					modifier = opinion_burned_closed_relative
					who = FROMFROM
					years = 25
				}				
			}
		}
	}
	
	option = {
		name = "EVTOPTAdragon.40"
		red_god_resurrect_effect = yes #check for rhllor resurrection
		FROMFROM = {
			if = {
				limit = {
					is_blood_relative_of_root_trigger = yes
					is_any_kinslayer_trigger = no 
					NOT = { trait = suspected_kinslayer }	
					NOT = { has_cutthroat_religion_trigger = yes }
				}
				add_trait = suspected_kinslayer
			}
		}	
		death = {
			death_reason = death_battle_dragon_fire
			killer = FROMFROM
		}
		FROM = { 
			FROM = { 
				random_friend = {
					limit = { trait = dragon age = 2 }
					tooltip = { show_portrait = yes }
				}
			}
		}	
	}
}
#Inform castle decimated
character_event = {
	id = dragon.41
	desc = "EVTDESCdragon.41"
	picture = "GFX_siegeoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.41"
		random_friend = {
			limit = { trait = dragon }
			save_event_target_as = riders_dragon #for localisation
		}
		chronicle = {
			entry = CHRONICLE_SIEGE_OF_FIRE
			portrait = [From.GetID]
			picture = GFX_siegeoffire
		}
	}
}
#Siege of fire dragon duel
character_event = {
	id = dragon.42
	desc = "EVTDESCdragon.42"
	picture = "GFX_evt_dragon_riding_3"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	#stand
	option = {
		name = "EVTOPTAdragon.42"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 2
				OR = {
					trait = brave
					trait = wroth
					trait = lunatic
				}
			}			
		}	
		set_global_flag = dragonduel1
		set_character_flag = dragonduel	
		set_character_flag = dragonduel_siege	
		set_character_flag = dragonduel_team_leader_a
		clr_character_flag = dragonduel_team_leader_b	
		FROM = {	
			hidden_tooltip = {
				clr_character_flag = dragonduel_team_leader_a
				set_character_flag = dragonduel_team_leader_b
				
				##Strength of each team is calculated by summing the martial score of each dragon and combat rating of each dragon rider
				calculate_dragon_team_strength_effect = yes
			}	
			set_character_flag = dragonduel		
			tooltip = { show_portrait = yes }	
			hidden_tooltip = { 
				character_event = { id = dragon.44 days = 1 }  #say hello to my dragon	
				opinion = { who = ROOT modifier = opinion_dragon_duel }
				reverse_opinion = { who = ROOT modifier = opinion_dragon_duel }
			} 
			random_friend = {
				limit = {
					trait = dragon
					is_alive = yes
					age = 2
				}	
				custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
			}
			top_liege = {
				any_realm_character = {
					limit = {
						can_use_dragon_abilities_trigger = yes
						at_location = ROOT
						in_command = yes
						NOT = { character = PREVPREV }
						OR = {
							war_with = ROOT
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { 
								OR = {
									war_with = ROOT 
									ROOT = { any_liege = { war_with = PREVPREV } }
								}	
							}
						}
						NOT = {
							OR = {
								is_liege_or_above = ROOT
								ROOT = { is_liege_or_above = PREV }
							}
						}
					}
					set_character_flag = dragonduel		
					tooltip = { show_portrait = yes }	
					hidden_tooltip = { 
						character_event = { id = dragon.44 }  #say hello to my dragon	
						opinion = { who = ROOT modifier = opinion_dragon_duel }
						reverse_opinion = { who = ROOT modifier = opinion_dragon_duel }
					} 			
					random_friend = {
						limit = {
							trait = dragon
							is_alive = yes
							age = 2
						}	
						custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
					}
				}
			}
		}	
		top_liege = {
			any_realm_character = { #allies
				limit = {
					can_use_dragon_abilities_trigger = yes
					at_location = ROOT
					NOT = { character = ROOT }
					NOT = { is_inaccessible_trigger = yes }
					NOT = {
						OR = {
							war_with = ROOT
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { 
								OR = {
									war_with = ROOT 
									ROOT = { any_liege = { war_with = PREVPREV } }
								}	
							}
						}
					}	
				}
				set_character_flag = dragonduel	
				set_character_flag = dragonduel_siege	
				tooltip = { show_portrait = yes }	
				hidden_tooltip = { character_event = { id = dragon.4498 } }			
				random_friend = {
					limit = {
						trait = dragon
						is_alive = yes
						age = 2
					}	
					custom_tooltip = { text = TOOLTIPdragon.43ALLY }
				}	
			}
		}	
		hidden_tooltip = { #Determine dragon team strength
			##Strength of each team is calculated by summing the martial score of each dragon and combat rating of each dragon rider
			calculate_dragon_team_strength_effect = yes
		}		
	}
	#hide in castle
	option = {
		name = "EVTOPTBdragon.42"
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				trait = craven
			}		
		}
		prestige = -20
		set_character_flag = stayed_castle_dd
		FROM = { clr_character_flag = dragon_used character_event = { id = dragon.56 } }
	}
}
###Dragon Duels###
#Dragon vs Dragon Clash
character_event = { 
	id = dragon.43
	border = "GFX_event_normal_frame_war"
	desc = "EVTDESCdragon.43" 
	title = "EVTNAMEdragon.43"
	picture = "GFX_evt_dragons_flying"
	
	is_triggered_only = yes
	in_command = yes
	
	trigger = {
		NOT = { has_global_flag = dragonduel1 }
		can_use_dragon_abilities_trigger = yes	
		#fixes crash
		NOT = { is_at_sea = yes }
		NOT = { has_character_flag = battle_dragon }
		OR = {
			NOT = { has_character_flag = dragonduel }
			had_character_flag = { flag = dragonduel days = 15 }
		}
		dragon_rider = {
			at_location = ROOT
			in_command = yes
			OR = {
				NOT = { has_character_flag = dragonduel }
				had_character_flag = { flag = dragonduel days = 7 }
			}
			OR = {
				war_with = ROOT
				ROOT = { any_liege = { war_with = PREVPREV } }
				any_liege = { 
					OR = {
						war_with = ROOT 
						ROOT = { any_liege = { war_with = PREVPREV } }
					}	
				}
			}
			NOT = {
				OR = {
					is_liege_or_above = ROOT
					ROOT = { is_liege_or_above = PREV }
				}
			}			
		}	
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
	}
	
	immediate = {
		set_global_flag = dragonduel1
		set_character_flag = dragonduel	
		set_character_flag = dragonduel_team_leader_a
		clr_character_flag = dragonduel_team_leader_b
		hidden_tooltip = { #Determine dragon team strength
			##Strength of each team is calculated by summing the martial score of each dragon and combat rating of each dragon rider
			calculate_dragon_team_strength_effect = yes
		}
		dragon_rider = { #Choose enemy team leader
			limit = {
				at_location = ROOT
				in_command = yes
				OR = {
					NOT = { has_character_flag = dragonduel }
					had_character_flag = { flag = dragonduel days = 7 }
				}
				OR = {
					war_with = ROOT
					ROOT = { any_liege = { war_with = PREVPREV } }
					any_liege = { 
						OR = {
							war_with = ROOT 
							ROOT = { any_liege = { war_with = PREVPREV } }
						}	
					}
				}
				NOT = {
					OR = {
						is_liege_or_above = ROOT
						ROOT = { is_liege_or_above = PREV }
					}
				}
			}	
			clr_character_flag = dragonduel_team_leader_a
			set_character_flag = dragonduel_team_leader_b
			##Strength of each team is calculated by summing the martial score of each dragon and combat rating of each dragon rider
			calculate_dragon_team_strength_effect = yes
		}
	}

	option = {
		name = "EVTOPTAdragon.43"
		dragon_rider = { #enemies
			limit = {
				in_command = yes
				at_location = ROOT
				has_character_flag = dragonduel_team_leader_b
				OR = {
					NOT = { has_character_flag = dragonduel }
					had_character_flag = { flag = dragonduel days = 7 }
				}
				OR = {
					war_with = ROOT
					ROOT = { any_liege = { war_with = PREVPREV } }
					any_liege = { 
						OR = {
							war_with = ROOT 
							ROOT = { any_liege = { war_with = PREVPREV } }
						}	
					}
				}
				NOT = {
					OR = {
						is_liege_or_above = ROOT
						ROOT = { is_liege_or_above = PREV }
					}
				}
			}
			set_character_flag = dragonduel		
			tooltip = { show_portrait = yes }	
			hidden_tooltip = { 
				character_event = { id = dragon.44 }  #say hello to my dragon	
				opinion = { who = ROOT modifier = opinion_dragon_duel }
				reverse_opinion = { who = ROOT modifier = opinion_dragon_duel }
			} 			
			random_friend = {
				limit = {
					trait = dragon
					is_alive = yes
					age = 2
				}	
				custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
			}
			top_liege = {
				any_realm_character = {
					limit = {
						can_use_dragon_abilities_trigger = yes
						in_command = yes
						at_location = ROOT
						NOT = { character = PREVPREV }
						OR = {
							NOT = { has_character_flag = dragonduel }
							had_character_flag = { flag = dragonduel days = 7 }
						}
						OR = {
							war_with = ROOT
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { 
								OR = {
									war_with = ROOT 
									ROOT = { any_liege = { war_with = PREVPREV } }
								}	
							}
						}
						NOT = {
							OR = {
								is_liege_or_above = ROOT
								ROOT = { is_liege_or_above = PREV }
							}
						}
					}
					set_character_flag = dragonduel		
					tooltip = { show_portrait = yes }	
					hidden_tooltip = { 
						character_event = { id = dragon.44 }  #say hello to my dragon	
						opinion = { who = ROOT modifier = opinion_dragon_duel }
						reverse_opinion = { who = ROOT modifier = opinion_dragon_duel }
					} 			
					random_friend = {
						limit = {
							trait = dragon
							is_alive = yes
							age = 2
						}	
						custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
					}
				}
			}	
		}
		top_liege = {
			any_realm_character = { #allies
				limit = {
					can_use_dragon_abilities_trigger = yes
					in_command = yes
					at_location = ROOT
					OR = {
						NOT = { has_character_flag = dragonduel }
						had_character_flag = { flag = dragonduel days = 7 }
					}
					NOT = { character = ROOT }
					NOT = {
						OR = {
							war_with = ROOT
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { 
								OR = {
									war_with = ROOT 
									ROOT = { any_liege = { war_with = PREVPREV } }
								}	
							}
						}
					}	
				}
				set_character_flag = dragonduel				
				tooltip = { show_portrait = yes }	
				hidden_tooltip = { character_event = { id = dragon.4498 } }			
				random_friend = {
					limit = {
						trait = dragon
						is_alive = yes
						age = 2
					}	
					custom_tooltip = { text = TOOLTIPdragon.43ALLY }
				}	
			}
		}		
	}
	#no target
	# option = {
		# name = "EVTOPTBdragon.43"			
		# ai_chance = {
			# factor = 1
			# modifier = {
				# factor = 2
				# trait = craven
			# }
			# modifier = {
				# factor = 2
				# NOT = { trait = poor_warrior_dragon }
				# NOT = { trait = trained_warrior_dragon } 
				# NOT = { trait = skilled_warrior_dragon } 
				# NOT = { trait = master_warrior_dragon }
			# }		 
		# }
		# clr_global_flag = dragonduel1
		# clr_character_flag = dragonduel_team_leader_a
		# hidden_tooltip = { set_variable = { which = "dragon_strength" value = 0 } }
		# dragon_rider = {
			# limit = {
				# has_character_flag = dragonduel_team_leader_b
			# }
			# clr_character_flag = dragonduel_team_leader_b
			# hidden_tooltip = { set_variable = { which = "dragon_strength" value = 0 } }
		# }
	# }
}
# Scope to Allied dragon rider
character_event = { 
	id = dragon.4498
	border = "GFX_event_normal_frame_war"
	desc = "EVTDESCdragon.4498" 
	title = "EVTNAMEdragon.43"
	picture = "GFX_evt_dragons_flying"
	
	is_triggered_only = yes
	
	immediate = {
		hidden_tooltip = { #Determine dragon team strength
			##Strength of each team is calculated by summing the martial score of each dragon and combat rating of each dragon rider
			calculate_dragon_team_strength_effect = yes
			#Add score to team leader's score
			FROM = { change_variable = { which = "dragon_strength" which = ROOT } }
		}	
	}
	
	option = {
		name = EVTOPTAdragon.4498
		dragon_rider = { #enemies
			limit = {
				OR = {
					has_character_flag = dragonduel_siege	
					in_command = yes
				}	
				at_location = ROOT
				OR = {
					war_with = ROOT
					ROOT = { any_liege = { war_with = PREVPREV } }
					any_liege = { 
						OR = {
							war_with = ROOT 
							ROOT = { any_liege = { war_with = PREVPREV } }
						}	
					}
				}
				NOT = {
					OR = {
						is_liege_or_above = ROOT
						ROOT = { is_liege_or_above = PREV }
					}
				}
			}
			top_liege = {
				any_realm_character = {
					limit = {
						can_use_dragon_abilities_trigger = yes
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						at_location = ROOT
						OR = {
							war_with = ROOT
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { 
								OR = {
									war_with = ROOT 
									ROOT = { any_liege = { war_with = PREVPREV } }
								}	
							}
						}
						NOT = {
							OR = {
								is_liege_or_above = ROOT
								ROOT = { is_liege_or_above = PREV }
							}
						}
					}
					tooltip = { show_portrait = yes }	
					hidden_tooltip = {
						opinion = { who = ROOT modifier = opinion_dragon_duel }
						reverse_opinion = { who = ROOT modifier = opinion_dragon_duel }	
					}	
					random_friend = {
						limit = {
							trait = dragon
							is_alive = yes
							age = 2
						}	
						custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
					}
				}
			}	
		}
		if = {
			limit = { ai = no }
			top_liege = {
				any_realm_character = { #allies
					limit = {
						can_use_dragon_abilities_trigger = yes
						in_command = yes
						at_location = ROOT
						NOT = { character = ROOT }
						NOT = {
							OR = {
								war_with = ROOT
								ROOT = { any_liege = { war_with = PREVPREV } }
								any_liege = { 
									OR = {
										war_with = ROOT 
										ROOT = { any_liege = { war_with = PREVPREV } }
									}	
								}
							}
						}	
					}
					tooltip = { show_portrait = yes }			
					random_friend = {
						limit = {
							trait = dragon
							is_alive = yes
							age = 2
						}	
						custom_tooltip = { text = TOOLTIPdragon.43ALLY }
					}	
				}
			}
		}	
	}	
}	
# Dragon vs Dragon Step 2 
character_event = { 
	id = dragon.44
	border = "GFX_event_normal_frame_war"
	desc = "EVTDESCdragon.44" 
	title = "EVTNAMEdragon.43"
	picture = "GFX_evt_dragons_flying"

	is_triggered_only = yes
	
	trigger = {
		has_character_flag = dragonduel
	}

	#stand
	option = {
		name = "EVTOPTAdragon.44"
		if = {
			limit = { ai = no }
			dragon_rider = { #enemies
				limit = {
					OR = {
						in_command = yes
						has_character_flag = dragonduel_siege
					}	
					at_location = ROOT
					OR = {
						war_with = ROOT
						ROOT = { any_liege = { war_with = PREVPREV } }
						any_liege = { 
							OR = {
								war_with = ROOT 
								ROOT = { any_liege = { war_with = PREVPREV } }
							}	
						}
					}
					NOT = {
						OR = {
							is_liege_or_above = ROOT
							ROOT = { is_liege_or_above = PREV }
						}
					}
				}
				top_liege = {
					any_realm_character = {
						limit = {
							can_use_dragon_abilities_trigger = yes
							OR = {
								in_command = yes
								has_character_flag = dragonduel_siege
							}	
							at_location = ROOT
							OR = {
								war_with = ROOT
								ROOT = { any_liege = { war_with = PREVPREV } }
								any_liege = { 
									OR = {
										war_with = ROOT 
										ROOT = { any_liege = { war_with = PREVPREV } }
									}	
								}
							}
							NOT = {
								OR = {
									is_liege_or_above = ROOT
									ROOT = { is_liege_or_above = PREV }
								}
							}
						}
						tooltip = { show_portrait = yes }			
						random_friend = {
							limit = {
								trait = dragon
								is_alive = yes
								age = 2
							}	
							custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				OR = {
					ai = no
					has_character_flag = dragonduel_team_leader_b
				}
			}
			top_liege = {
				any_realm_character = { #allies
					limit = {
						can_use_dragon_abilities_trigger = yes
						in_command = yes
						at_location = ROOT
						NOT = { character = ROOT }
						NOT = {
							OR = {
								war_with = ROOT
								ROOT = { any_liege = { war_with = PREVPREV } }
								any_liege = { 
									OR = {
										war_with = ROOT 
										ROOT = { any_liege = { war_with = PREVPREV } }
									}	
								}
							}
						}	
					}	
					tooltip = { show_portrait = yes }			
					random_friend = {
						limit = {
							trait = dragon
							is_alive = yes
							age = 2
						}	
						custom_tooltip = { text = TOOLTIPdragon.43ALLY }
					}	
					if = {
						limit = { ROOT = { has_character_flag = dragonduel_team_leader_b } }
						hidden_tooltip = { #Determine dragon team strength
							##Strength of each team is calculated by summing the martial score of each dragon and combat rating of each dragon rider
							calculate_dragon_team_strength_effect = yes
							#Add score to team leader's score
							ROOT = { change_variable = { which = "dragon_strength" which = PREV } }
						}
					}	
				}
			}	
		}	
		# ai_chance = {
			# factor = 2
			# modifier = {
				# factor = 2
				# OR = {
					# trait = brave
					# trait = wroth
					# trait = lunatic
				# }
			# }
			# modifier = {
				# factor = 2
				# trait = poor_warrior_dragon
			# }
			# modifier = {
				# factor = 3
				# trait = trained_warrior_dragon
			# }
			# modifier = {
				# factor = 4
				# trait = skilled_warrior_dragon
			# }
			# modifier = {
				# factor = 5
				# trait = master_warrior_dragon
			# }
			# modifier = {
				# factor = 2
				# FROM = {
					# NOT = { trait = poor_warrior_dragon }
					# NOT = { trait = trained_warrior_dragon } 
					# NOT = { trait = skilled_warrior_dragon } 
					# NOT = { trait = master_warrior_dragon }
				# }
			# }
				
		# }
		#any_playable_ruler  = {
		#	limit = { 
		#		ai = no
		#	}	
		#	character_event = { id = 3370110 }
		#}
		if = {
			limit = { has_character_flag = dragonduel_team_leader_b } #Team leader initiates first round
			hidden_tooltip = { c_the_citadel = { holder_scope = { character_event = { id = dragon.4597 days = 1 } } } }
		}	
	}
	# #run
	# option = {
		# name = "EVTOPTBdragon.44"
		# trigger = {
			# NOT = {
				# siege = {
					# is_attacker = no
				# }
			# }
		# }
		# ai_chance = {
			# factor = 1
			# modifier = {
				# factor = 2
				# trait = craven
			# }
			# modifier = {
				# factor = 2
				# NOT = { trait = poor_warrior_dragon }
				# NOT = { trait = trained_warrior_dragon } 
				# NOT = { trait = skilled_warrior_dragon } 
				# NOT = { trait = master_warrior_dragon }
			# }
			 
		# }
		# random_list = {
			# #escaped
			# 50 = {
				# prestige = -50
				# FROM = { set_character_flag = dragon_duel_resolved character_event = { id = dragon.53 } }
				# set_character_flag = dragon_duel_resolved
				# character_event = { id = dragon.57 }
				# #clean relations
				# hidden_tooltip = {
					# FROM = { remove_opinion = { who = ROOT modifier = rel_dragon} }
					# remove_opinion = { who = FROM modifier = rel_dragon}
				# }
			# }
			# #dontescape
			# 50 = {
				# #any_playable_ruler  = {
				# #	limit = { 
				# #		ai = no
				# #	}
				# #	character_event = { id = 3370110 }
				# #}
				# set_character_flag = tried_escape_dd
				# FROM = { set_character_flag = dragon_duel_resolved character_event = { id = dragon.54 } }
				# set_character_flag = dragon_duel_resolved
				# character_event = { id = dragon.55 }
				# hidden_tooltip = { c_the_citadel = { holder_scope = { character_event = { id = dragon.45 days = 1} } } }
				# prestige = 50
			# }
		# }
		
	# }
	# #hide in castle
	# option = {
	# name = "EVTOPTCdragon.44"
		# trigger = {
			# siege = {
				# is_attacker = no
			# }
		# }
		# ai_chance = {
			# factor = 2
			# modifier = {
				# factor = 2
				# trait = craven
			# }
			# modifier = {
				# factor = 2
				# NOT = { trait = poor_warrior_dragon }
				# NOT = { trait = trained_warrior_dragon } 
				# NOT = { trait = skilled_warrior_dragon } 
				# NOT = { trait = master_warrior_dragon }
			# }
			
		# }
		# prestige = -20
		# FROM = { set_character_flag = dragon_duel_resolved character_event = { id = dragon.56 } }
	# }	
}
# ROUND START
# scope to team leaders from previous round
character_event = {
	id = dragon.4595
	is_triggered_only = yes
	hide_window = yes
		
	immediate = {
		set_character_flag = dragon.4595
		##Strength of each team is calculated by summing the martial score of each dragon and combat rating of each dragon rider
		calculate_dragon_team_strength_effect = yes
		top_liege = {
			any_realm_character = { #allies
				limit = {
					can_use_dragon_abilities_trigger = yes
					OR = {
						has_character_flag = dragonduel_siege	
						in_command = yes
					}
					NOT = { character = ROOT }
					at_location = ROOT
					NOT = {
						OR = {
							war_with = ROOT
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { 
								OR = {
									war_with = ROOT 
									ROOT = { any_liege = { war_with = PREVPREV } }
								}	
							}
						}
					}	
				}	
				##Strength of each team is calculated by summing the martial score of each dragon and combat rating of each dragon rider
				calculate_dragon_team_strength_effect = yes
				#Add score to team leader's score
				ROOT = { change_variable = { which = "dragon_strength" which = PREV } }
			}
		}	
		dragon_rider = { #scope to enemy team leader
			limit = {
				at_location = ROOT
				has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel }
				OR = {
					has_character_flag = dragonduel_team_leader_a 
					has_character_flag = dragonduel_team_leader_b
				}
			}	
			ROOT = { set_character_flag = enemy_dragon_found }
			character_event = { id = dragon.4594 }
		}
		if = { #If no enemy dragon riders left the duel is won
			limit = { NOT = { has_character_flag = enemy_dragon_found } }
			character_event = { id = dragon.48 days = 2 }
		}
		clr_character_flag = enemy_dragon_found
	}
	
	option = {
		name = OK
	}
}	
character_event = {
	id = dragon.4594
	
	is_triggered_only = yes
	hide_window = yes
	
	trigger = { can_use_dragon_abilities_trigger = yes }
		
	immediate = {
		##Strength of each team is calculated by summing the martial score of each dragon and combat rating of each dragon rider
		calculate_dragon_team_strength_effect = yes
		#Add score to team leader's score
		FROM = { change_variable = { which = "dragon_strength" which = ROOT } }
		top_liege = {
			any_realm_character = { #allies
				limit = {
					can_use_dragon_abilities_trigger = yes
					OR = {
						has_character_flag = dragonduel_siege	
						in_command = yes
					}
					NOT = { character = ROOT }
					at_location = ROOT
					NOT = {
						OR = {
							war_with = ROOT
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { 
								OR = {
									war_with = ROOT 
									ROOT = { any_liege = { war_with = PREVPREV } }
								}	
							}
						}
					}	
				}	
				##Strength of each team is calculated by summing the martial score of each dragon and combat rating of each dragon rider
				calculate_dragon_team_strength_effect = yes
				#Add score to team leader's score
				ROOT = { change_variable = { which = "dragon_strength" which = PREV } }
			}
		}	
		c_the_citadel = { holder_scope = { character_event = { id = dragon.4597 days = 1 } } }
	}
	
	option = {
		name = OK
	}
}
# This event starts a new round of combat after resolving the previous one
character_event = {
	id = dragon.4597
	is_triggered_only = yes
	hide_window = yes
	
	# Nobody but the actual referee should ever get this
	trigger = { has_landed_title = c_the_citadel }
	
	immediate = {
		FROM = { FROM = { character_event = { id = dragon.4598 } } }	
		clr_global_flag = dragonduel1
	}
	
	option = {
		name = OK
	}
}
# MAIN LOOP
character_event = { #Team A leader
	id = dragon.4598
	desc = "EVTDESCdragon.4598"
	picture = "GFX_evt_dragon_duel"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	hide_from = yes
	show_from_from = yes
	
	trigger = { 
		can_use_dragon_abilities_trigger = yes 
		
		#Double check the combatants are valid
		NOT = { character = FROMFROM }
		NAND = {
			is_ruler = yes
			OR = {
				is_liege_or_above = FROMFROM
				is_vassal_or_below = FROMFROM
			}
		}	
		NAND = {
			is_ruler = no
			liege = {
				OR = {
					is_liege_or_above = FROMFROM
					is_vassal_or_below = FROMFROM
				}
			}	
		}
	}
	
	immediate = {
		# Set a target lock with the other duelist so that they can eventually be found via a search
		FROM = {
			FROM = {
				opinion = { who = ROOT modifier = opinion_duel_target }
				reverse_opinion = { who = ROOT modifier = opinion_duel_target }
			}
		}
	}
	
	option = {
		name = "EVTOPTAdragon.4598"
		if = { #Display participating riders if human
			limit = { ai = no }
			dragon_rider = { #enemies
				limit = {
					at_location = ROOT
					OR = {
						has_character_flag = dragonduel_siege	
						in_command = yes
					}
					has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel }
				}		
				top_liege = {
					any_realm_character = {
						limit = {
							can_use_dragon_abilities_trigger = yes
							at_location = ROOT
							OR = {
								has_character_flag = dragonduel_siege	
								in_command = yes
							}
							has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel }
						}
						tooltip = { show_portrait = yes }			
						random_friend = {
							limit = {
								trait = dragon
								is_alive = yes
								age = 2
							}	
							custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
						}
					}
				}	
			}
			top_liege = {			
				any_realm_character = { #allies
					limit = {
						can_use_dragon_abilities_trigger = yes
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						NOT = { character = ROOT }
						at_location = ROOT
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }	
					}	
					tooltip = { show_portrait = yes }			
					random_friend = {
						limit = {
							trait = dragon
							is_alive = yes
							age = 2
						}	
						custom_tooltip = { text = TOOLTIPdragon.43ALLY }
					}	
				}
			}	
		}
		hidden_tooltip = { FROM = { FROM = { character_event = { id = dragon.4599 } } } }
	}
}
character_event = { #Team B leader
	id = dragon.4599
	desc = "EVTDESCdragon.4598"
	picture = "GFX_evt_dragon_duel"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	trigger = { can_use_dragon_abilities_trigger = yes }
	
	option = {
		name = "EVTOPTAdragon.4598"
		if = { #Display participating riders if human
			limit = { ai = no }
			dragon_rider = { #enemies
				limit = {
					at_location = ROOT
					OR = {
						has_character_flag = dragonduel_siege	
						in_command = yes
					}
					has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel }
				}		
				top_liege = {
					any_realm_character = {
						limit = {
							can_use_dragon_abilities_trigger = yes
							at_location = ROOT
							OR = {
								has_character_flag = dragonduel_siege	
								in_command = yes
							}
							has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel }
						}
						tooltip = { show_portrait = yes }			
						random_friend = {
							limit = {
								trait = dragon
								is_alive = yes
								age = 2
							}	
							custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
						}
					}
				}	
			}
			top_liege = {			
				any_realm_character = { #allies
					limit = {
						can_use_dragon_abilities_trigger = yes
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						NOT = { character = ROOT }
						at_location = ROOT
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }	
					}	
					tooltip = { show_portrait = yes }			
					random_friend = {
						limit = {
							trait = dragon
							is_alive = yes
							age = 2
						}	
						custom_tooltip = { text = TOOLTIPdragon.43ALLY }
					}	
				}
			}	
		}
		hidden_tooltip = { c_the_citadel = { holder_scope = { character_event = { id = dragon.45 days = 1 } } } }
	}
}
# RESOLVE ROUND - WINNER
# Determine who "won" the round by weighting stats
character_event = {
	id = dragon.45
	is_triggered_only = yes
	desc = "EVTDESCdragon.45"
	
	# Nobody but the actual referee should ever get this
	trigger = { has_landed_title = c_the_citadel }
	
	# FROM/Team B wins
	option = {
		name = "FROM wins"
		ai_chance = {
			factor = 10
			
			modifier = {
				factor = 1.5
				FROM = { check_variable = { which = "dragon_strength" value = 10 } }
			}	
			modifier = {
				factor = 1.4
				FROM = { check_variable = { which = "dragon_strength" value = 20 } }
			}	
			modifier = {
				factor = 1.3
				FROM = { check_variable = { which = "dragon_strength" value = 30 } }
			}	
			modifier = {
				factor = 1.3
				FROM = { check_variable = { which = "dragon_strength" value = 40 } }
			}	
			modifier = {
				factor = 1.25
				FROM = { check_variable = { which = "dragon_strength" value = 50 } }
			}	
			modifier = {
				factor = 1.25
				FROM = { check_variable = { which = "dragon_strength" value = 60 } }
			}	
			modifier = {
				factor = 1.25
				FROM = { check_variable = { which = "dragon_strength" value = 70 } }
			}	
			modifier = {
				factor = 1.25
				FROM = { check_variable = { which = "dragon_strength" value = 80 } }
			}	
			modifier = {
				factor = 1.25
				FROM = { check_variable = { which = "dragon_strength" value = 90 } }
			}	
			modifier = {
				factor = 1.25
				FROM = { check_variable = { which = "dragon_strength" value = 100 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 110 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 120 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 130 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 140 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 150 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 160 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 170 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 180 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 190 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 200 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 210 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 220 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 230 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 240 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 250 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 260 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 270 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 280 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 290 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 300 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 310 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 320 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 330 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 340 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 350 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 360 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 370 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 380 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 390 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 400 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 410 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 420 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 430 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 440 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 450 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 460 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 470 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 480 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 490 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 500 } }
			}					
		}
		FROM = { FROM = { character_event = { id = dragon.4699 } } }
	}
	#lost
	# FROMFROM /Team A wins
	option = {
		name = "FROMFROM wins"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 1.5
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 10 } } }
			}	
			modifier = {
				factor = 1.4
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 20 } } }
			}	
			modifier = {
				factor = 1.3
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 30 } } }
			}	
			modifier = {
				factor = 1.3
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 40 } } }
			}	
			modifier = {
				factor = 1.25
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 50 } } }
			}	
			modifier = {
				factor = 1.25
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 60 } } }
			}	
			modifier = {
				factor = 1.25
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 70 } } }
			}	
			modifier = {
				factor = 1.25
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 80 } } }
			}	
			modifier = {
				factor = 1.25
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 90 } } }
			}	
			modifier = {
				factor = 1.25
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 100 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 110 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 120 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 130 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 140 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 150 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 160 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 170 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 180 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 190 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 200 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 210 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 220 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 230 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 240 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 250 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 260 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 270 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 280 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 290 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 300 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 310 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 320 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 330 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 340 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 350 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 360 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 370 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 380 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 390 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 400 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 410 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 420 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 430 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 440 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 450 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 460 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 470 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 480 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 490 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 500 } } }
			}				
		}
		FROM = { character_event = { id = dragon.4699 } } 
	}
	# option = {
		# name = "Invalid Duel"
		# trigger = {
			# NOT = {
				# FROM = { trait = dragon}
				# FROM = { FROM = { trait = dragon} }
			# }
		# }
		# ai_chance = {
			# factor = 0.1
		# }
		# if = {
			# limit = {
				# NOT = { FROM = { trait = dragon} }
			# }
			# FROM = { FROM = { character_event = { id = dragon.59 } }}
		# }
		# if = {
			# limit = {
				# NOT = { FROM = { FROM = { trait = dragon} } }
			# }
			 # FROM = { character_event = { id = dragon.59 } }
		# }
		# #cleanup
		# FROM = { clr_character_flag = tried_escape_dd FROM = { clr_character_flag = tried_escape_dd}}
	# }
}
# Winning team attacks!
character_event = {
	id = dragon.4698
	desc = "EVTDESCdragon.4698"
	picture = "GFX_evt_dragon_duel"
	border = "GFX_event_normal_frame_war"
		
	is_triggered_only = yes
	
	immediate = {
		remove_opinion = { who = FROM modifier = opinion_duel_target }
		reverse_remove_opinion = { who = FROM modifier = opinion_duel_target }
	}
	
	option = {
		name = "EVTOPTAdragon.4698"
		hidden_tooltip = { # Determine attack outcome
			random_list = {
				75 = { #death
					modifier = {
						factor = 0.66
						event_target:dragon_duel_round_winner = {
							event_target:dragon_duel_round_loser = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 20
								}
							}
						}	
					}
					modifier = {
						factor = 0.66
						event_target:dragon_duel_round_winner = {
							event_target:dragon_duel_round_loser = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 40
								}
							}
						}	
					}
					modifier = {
						factor = 0.66
						event_target:dragon_duel_round_winner = {
							event_target:dragon_duel_round_loser = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 60
								}
							}
						}	
					}
					modifier = {
						factor = 0.66
						event_target:dragon_duel_round_winner = {
							event_target:dragon_duel_round_loser = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 80
								}
							}
						}	
					}
					modifier = {
						factor = 1.5
						event_target:dragon_duel_round_loser = {
							event_target:dragon_duel_round_winner = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 20
								}
							}
						}	
					}
					modifier = {
						factor = 1.5
						event_target:dragon_duel_round_loser = {
							event_target:dragon_duel_round_winner = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 40
								}
							}
						}	
					}
					modifier = {
						factor = 1.5
						event_target:dragon_duel_round_loser = {
							event_target:dragon_duel_round_winner = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 60
								}
							}
						}	
					}
					modifier = {
						factor = 1.5
						event_target:dragon_duel_round_loser = {
							event_target:dragon_duel_round_winner = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 80
								}
							}
						}	
					}
					event_target:dragon_duel_round_loser = { character_event = { id = dragon.47 } }
				}
				100 = { #wound
					event_target:dragon_duel_round_loser = { character_event = { id = dragon.4794 } }
				}
			}		
		}
				
		hidden_tooltip = {
			top_liege = {
				any_realm_character = { #inform allies
					limit = {
						ai = no
						can_use_dragon_abilities_trigger = yes
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						NOT = { character = ROOT }
						at_location = ROOT
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }	
					}
					character_event = { id = dragon.4697 }		
				}
			}	
		}
	}
}
character_event = {
	id = dragon.4697
	desc = "EVTDESCdragon.4697"
	picture = "GFX_evt_dragon_duel"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	show_from_from = yes
	
	option = {
		name = "EVTOPTAdragon.4698"
	}
}
# Losing team is attacked!
character_event = {
	id = dragon.4699
	desc = "EVTDESCdragon.4699"
	picture = "GFX_evt_dragon_duel"
	border = "GFX_event_normal_frame_war"	
	
	is_triggered_only = yes
	hide_from = yes
	
	immediate = {
		hidden_tooltip = {
			#select random dragon to lose
			top_liege = { 
				random_realm_character = {
					limit = {
						can_use_dragon_abilities_trigger = yes
						OR = {
							character = ROOT
							AND = {
								OR = {
									has_character_flag = dragonduel_siege	
									in_command = yes
								}
								at_location = ROOT
								NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }
							}
						}	
					}
					random_friend = {
						limit = {
							trait = dragon
							age = 2
							is_alive = yes
						}
						save_event_target_as = dragon_duel_round_loser
						ROOT = { set_character_flag = losing_dragon_found }
					}					
				}
			}
			if = {
				limit = { NOT = { has_character_flag = losing_dragon_found } }
				random_friend = {
					limit = {
						trait = dragon
						age = 2
						is_alive = yes
					}
					save_event_target_as = dragon_duel_round_loser
					ROOT = { set_character_flag = losing_dragon_found }
				}
			}
			clr_character_flag = losing_dragon_found
			dragon_rider = { #select random dragon to win
				limit = { has_opinion_modifier = { who = ROOT modifier = opinion_duel_target } }
				top_liege = { 
					random_realm_character = {
						limit = {
							can_use_dragon_abilities_trigger = yes
							OR = {
								has_character_flag = dragonduel_siege	
								in_command = yes
							}
							at_location = ROOT
							NOT = { has_opinion_modifier = { who = PREVPREV modifier = opinion_dragon_duel } }	
						}
						random_friend = {
							limit = {
								trait = dragon
								age = 2
								is_alive = yes
							}
							save_event_target_as = dragon_duel_round_winner
							ROOT = { set_character_flag = winning_dragon_found }
						}					
					}
				}
				if = {
					limit = { NOT = { ROOT = { has_character_flag = winning_dragon_found } } }
					random_friend = {
						limit = {
							trait = dragon
							age = 2
							is_alive = yes
						}
						save_event_target_as = dragon_duel_round_winner
						ROOT = { set_character_flag = winning_dragon_found }
					}
				}
			}
			clr_character_flag = winning_dragon_found
		}
	}
	
	option = {
		name = "EVTOPTAdragon.4699"	
		dragon_rider = {
			limit = { has_opinion_modifier = { who = ROOT modifier = opinion_duel_target } }
			character_event = { id = dragon.4698 tooltip = "EVTTOOLTIPdragon.4698" }
		}
		hidden_tooltip = {
			top_liege = {
				any_realm_character = { #inform allies
					limit = {
						ai = no
						can_use_dragon_abilities_trigger = yes
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						NOT = { character = ROOT }
						at_location = ROOT
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }	
					}
					character_event = { id = dragon.4696 }		
				}
			}	
		}
	}
}
character_event = {
	id = dragon.4696
	desc = "EVTDESCdragon.4699"
	picture = "GFX_evt_dragon_duel"
	border = "GFX_event_normal_frame_war"	
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.4699"
		dragon_rider = {
			limit = { has_opinion_modifier = { who = FROM modifier = opinion_duel_target } }
			tooltip = { character_event = { id = dragon.4698 tooltip = "EVTTOOLTIPdragon.4698" } }
		}
	}
}
### DRAGON DEATH OUTCOMES
character_event = { #scope to dead dragon
	id = dragon.47

	is_triggered_only = yes
	hide_window = yes
	friends = yes
	
	trigger = {
		any_friend = { 
			OR = {
				has_character_flag = dragonduel_siege	
				in_command = yes
			} 
		}
	}

	immediate = {
		set_character_flag = dragon.47	
		event_target:dragon_duel_round_winner = { character_event = { id = dragon.4790 } }
		clear_event_target = dragon_duel_round_loser
	}
	
	option = {
		name = OK
	}
}
character_event = { #scope to killer dragon
	id = dragon.4790

	is_triggered_only = yes
	hide_window = yes

	immediate = {
		set_character_flag = dragon.4790
		clear_event_target = dragon_duel_round_winner
		hidden_tooltip = {
			any_playable_ruler = { #inform world
				limit = { 
					ai = no 
					NOT = { is_friend = FROM }
					NOT = { has_character_flag = dragonduel }
					NOT = { has_character_flag = no_dragon_duel_information }
				}
				character_event = { id = dragon.5801 }
			}
		}
		random_friend = {
			top_liege = {
				any_realm_character = { #inform other participants
					limit = {
						can_use_dragon_abilities_trigger = yes
						ai = no
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						has_character_flag = dragonduel
						at_location = PREVPREV
						NOT = { character = PREVPREV }
						NOT = { has_opinion_modifier = { who = PREVPREV modifier = opinion_dragon_duel } }	
					}
					character_event = { id = dragon.4793 }
				}	
			}	
			character_event = { id = dragon.4792 }			
		}
		FROM = {
			random_friend = {		
				top_liege = {
					any_realm_character = { #inform other participants
						limit = {
							can_use_dragon_abilities_trigger = yes
							ai = no
							OR = {
								has_character_flag = dragonduel_siege	
								in_command = yes
							}
							has_character_flag = dragonduel
							at_location = PREVPREV
							NOT = { character = PREVPREV }
							NOT = { has_opinion_modifier = { who = PREVPREV modifier = opinion_dragon_duel } }	
						}
						character_event = { id = dragon.4793 }
					}	
				}
				character_event = { id = dragon.4791 }			
			}
			death = {
				death_reason = death_dragon_duel
				killer = ROOT
			}
		}	
	}
	
	option = {
		name = OK
	}
}
character_event = { #My dragon was killed
	id = dragon.4791
	desc = "EVTDESCddragon.4791"
	picture = "GFX_evt_dragon_duel_death"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	immediate = {
		set_character_flag = dragon.4791
		clr_character_flag = dragonduel	
		clr_character_flag = dragonduel_siege	
		dragon_rider = {
			limit = { at_location = ROOT has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }
			remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
			reverse_remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
			top_liege = {
				any_realm_character = {
					limit = { can_use_dragon_abilities_trigger = yes }
					remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
					reverse_remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
				}
			}	
		}
		#If team leader pick a new team leader
		if = {
			limit = { 
				OR = {
					has_character_flag = dragonduel_team_leader_a 
					has_character_flag = dragonduel_team_leader_b
				}	
			} 
			top_liege = {
				random_realm_character = {
					limit = {
						can_use_dragon_abilities_trigger = yes
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						NOT = { character = ROOT }
						at_location = ROOT
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }	
					}
					if = {
						limit = { ROOT = { has_character_flag = dragonduel_team_leader_a } }
						set_character_flag = dragonduel_team_leader_a
					}
					if = {
						limit = { ROOT = { has_character_flag = dragonduel_team_leader_b } }
						set_character_flag = dragonduel_team_leader_b
					}	
				}
			}
		}
		clr_character_flag = dragonduel_team_leader_a 
		clr_character_flag = dragonduel_team_leader_b
	}

	option = {
		name = "EVTOPTAdragon.4791"
		remove_trait = dragon_rider
		if = { #Check dragon riding dynasty status
			limit = {
				NOT = { dynasty = 0 }
				has_dynasty_flag = dragon_riding_dynasty
				NOT = { any_dynasty_member = { can_use_dragon_abilities_trigger = yes	is_alive = yes } }
			}
			clr_dynasty_flag = dragon_riding_dynasty
		}
		if = {
			limit = { ai = no }
			FROM = { random_friend = { save_event_target_as = dragons_rider_duel } }
			chronicle = {
				entry = CHRONICLE_LOST_DRAGON_DUEL_DIED
				portrait = [From.GetID]
				picture = GFX_evt_dragon_duel_death
			}
		}
		FROM = {
			FROM = {
				tooltip = {
					death = {
						death_reason = death_dragon_duel
						killer = FROM
					}
				}	
			}
		}
		random_list = {
			20 = {
				
			}
			10 = {
				trigger = { NOT = { trait = burned } }
				add_trait = burned
				hidden_tooltip = { character_event = { id = trait_notification.23 } }					
			}
			16 = {
				if = {
					limit = { trait = wounded }			
					hidden_tooltip = { remove_trait = wounded }
					add_maimed_trait_effect = yes
				}
				if = {
					limit = { 
						NOT = { trait = wounded } 
						NOT = { is_maimed_trigger = yes }
					}
					add_trait_silently_wounded_effect = yes
				}
			}
			20 = {
				add_crippled_trait_effect = yes
			}
			34 = {
				red_god_resurrect_effect = yes #check for rhllor resurrection
				FROM = {
					random_friend = {
						if = {
							limit = {
								is_blood_relative_of_root_trigger = yes
								is_any_kinslayer_trigger = no 
								NOT = { trait = suspected_kinslayer }
								NOT = { has_cutthroat_religion_trigger = yes }
							}
							add_trait = suspected_kinslayer
						}
						ROOT = {							
							death = {
								death_reason = death_dragon_duel
								killer = PREV
							}
						}
					}
				}
			}
		}		
		random = {
			chance = 50 
			set_character_flag = captured_in_battle
			if = {
				limit = {
					FROM = { any_friend = { is_ruler = yes } }
					is_alive = yes
				}
				FROM = { 
					random_friend = {
						ROOT = { imprison = PREV }
					}	
				}
			}
			if = {
				limit = {
					FROM = { any_friend = { is_ruler = no } }
					is_alive = yes
				}
				FROM = { 
					random_friend = {
						liege = {
							ROOT = { imprison = PREV }
							hidden_tooltip = { character_event = { id = dragon.5800 days = 2 } }
						}	
					}	
				}
			}
		}	
	}
}
character_event = { #I killed an enemy dragon
	id = dragon.4792
	desc = "EVTDESCddragon.4792"
	picture = "GFX_evt_dragon_duel_death"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	show_from_from = yes
	
	option = {
		name = "EVTOPTAdragon.4792"
		set_character_flag = dragon.4792
		if = {
			limit = { ai = no }
			FROMFROM = { random_friend = { save_event_target_as = dragons_rider_duel } }
			chronicle = {
				entry = CHRONICLE_WON_DRAGON_DUEL_DIED
				portrait = [FromFrom.GetID]
				picture = GFX_evt_dragon_duel_death
			}
		}
		FROMFROM = {
			tooltip = {
				death = {
					death_reason = death_dragon_duel
					killer = ROOT_FROM
				}
			}
		}			
		if = {
			limit = { FROMFROM = { NOT = { martial = 20 } } }
			ROOT = { prestige = 20 }
			FROM = { prestige = 20 }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 15
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 20
					NOT = { martial = 40 } 
				}	
			}
			ROOT = { prestige = 40 }
			FROM = { prestige = 40 }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 20
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 40
					NOT = { martial = 60 } 
				}	
			}
			ROOT = { prestige = 70 }
			FROM = { prestige = 70 }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 30
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 60
					NOT = { martial = 80 }
				}	
			}
			ROOT = { prestige = 100 }
			FROM = { prestige = 100 }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 40
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 80
					NOT = { martial = 100 } 
				}	
			}
			ROOT = { prestige = 150 }
			FROM = { prestige = 150 }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 50
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = { FROMFROM = { martial = 100 } }
			ROOT = { prestige = 200 }
			FROM = { prestige = 200 }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 65
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}	
		random_list = {
			79 = {
				
			}
			10 = {
				trigger = { NOT = { trait = burned } }
				add_trait = burned
				hidden_tooltip = { character_event = { id = trait_notification.23 } }					
			}
			10 = {
				if = {
					limit = { trait = wounded }			
					hidden_tooltip = { remove_trait = wounded }
					add_maimed_trait_effect = yes
				}
				if = {
					limit = { 
						NOT = { trait = wounded } 
						NOT = { is_maimed_trigger = yes }
					}
					add_trait_silently_wounded_effect = yes
				}
			}
			1 = {
				add_crippled_trait_effect = yes
			}
		}
		hidden_tooltip = { #Scope back to team leader
			if = { 
				limit = {
					OR = {
						has_character_flag = dragonduel_team_leader_a 
						has_character_flag = dragonduel_team_leader_b
					}	
				}
				character_event = { id = dragon.4595 days = 1 }
			}
			top_liege = {
				random_realm_character = {
					limit = {
						can_use_dragon_abilities_trigger = yes
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						NOT = { character = ROOT }
						at_location = ROOT	
						OR = {
							has_character_flag = dragonduel_team_leader_a 
							has_character_flag = dragonduel_team_leader_b
						}
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }							
					}
					character_event = { id = dragon.4595 days = 1 }
				}
			}
		}
	}
}	
character_event = { #Inform other riders of killed dragon
	id = dragon.4793
	desc = "EVTDESCddragon.4793"
	picture = "GFX_evt_dragon_duel_death"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	show_from_from = yes
	
	option = {
		name = "EVTOPTAdragon.4792"
		FROM = { 
			tooltip = { show_portrait = yes } 
			random_friend = { tooltip = { show_portrait = yes } }
		}
		FROMFROM = {
			tooltip = { 
				death = {
					death_reason = death_dragon_duel
					killer = FROM
				}
			}
			random_friend = { tooltip = { show_portrait = yes } }
		}
	}
}	
#Inform liege Dragon rider captured
character_event = {
	id = dragon.5800
	desc = "EVTDESCdragon.5800"
	picture = "GFX_dracarys"
	
	is_triggered_only = yes	
	
	option = {
		name = OK
		FROM = { 
			imprison = ROOT
			tooltip = { show_portrait = yes } 
		}
		FROMFROM = {
			tooltip = { show_portrait = yes }
			random_friend = { tooltip = { show_portrait = yes } }
		}
	}
}
#Inform world of dragon death in duel
character_event = {
	id = dragon.5801
	desc = "EVTDESCdragon.5801"
	picture = "GFX_evt_dragon_duel_death"
	
	is_triggered_only = yes	
	
	show_from_from = yes
	
	trigger = {
		NOT = { has_character_flag = no_dragon_duel_information }
	}
	
	immediate = {
		FROM = { random_friend = { save_event_target_as = dragons_rider_FROM } }
		FROMFROM = { random_friend = { save_event_target_as = dragons_rider_FROMFROM } }
	}
	
	option = {
		name = "EVTOPTAdragon.5801"
		if = {
			limit = { 
				OR = {
					FROM = {
						any_friend = {
							OR = {
								liege = { character = ROOT }
								is_close_relative = ROOT
							}
						}
					}
					FROMFROM = {
						any_friend = {
							OR = {
								liege = { character = ROOT }
								is_close_relative = ROOT
							}
						}
					}
				}
			}			
			chronicle = {
				entry = CHRONICLE_DRAGON_DUEL
				portrait = [FromFrom.GetID]
			}
		}
		FROM = { #killer
			tooltip = { show_portrait = yes } 
			random_friend = { tooltip = { show_portrait = yes } }
		}
		FROMFROM = { #dead
			tooltip = { show_portrait = yes }
			random_friend = { tooltip = { show_portrait = yes } }
		}
	}
	
	option = {
		name = "EVTOPTBdragon.5801" #do not inform me of this
		trigger = { ai = no }
		set_character_flag = no_dragon_duel_information
	}
}	
### DRAGON WOUNDING OUTCOMES
character_event = { #scope to wounded dragon
	id = dragon.4794

	is_triggered_only = yes
	hide_window = yes
	friends = yes
	
	trigger = {
		any_friend = {
			OR = {
				has_character_flag = dragonduel_siege	
				in_command = yes
			}
		}
	}

	immediate = {
		set_character_flag = dragon.4794	
		event_target:dragon_duel_round_winner = { character_event = { id = dragon.4795 } }
		clear_event_target = dragon_duel_round_loser
	}
	
	option = {
		name = OK
	}
}
character_event = { #scope to killer dragon
	id = dragon.4795

	is_triggered_only = yes
	hide_window = yes

	immediate = {
		set_character_flag = dragon.4795	
		clear_event_target = dragon_duel_round_winner
		random_friend = {
			character_event = { id = dragon.4797 }
			top_liege = {
				any_realm_character = { #inform other participants
					limit = {
						can_use_dragon_abilities_trigger = yes
						ai = no
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						has_character_flag = dragonduel
						at_location = PREVPREV
						NOT = { character = PREVPREV }
						NOT = { has_opinion_modifier = { who = PREVPREV modifier = opinion_dragon_duel } }	
					}
					character_event = { id = dragon.4798 }
				}	
			}		
		}
		FROM = {
			random_friend = {
				top_liege = {
					any_realm_character = { #inform other participants
						limit = {
							can_use_dragon_abilities_trigger = yes
							ai = no
							OR = {
								has_character_flag = dragonduel_siege	
								in_command = yes
							}
							has_character_flag = dragonduel
							at_location = PREVPREV
							NOT = { character = PREVPREV }
							NOT = { has_opinion_modifier = { who = PREVPREV modifier = opinion_dragon_duel } }	
						}
						character_event = { id = dragon.4798 }
					}	
				}
				character_event = { id = dragon.4796 }			
			}
		}
	}
	
	option = {
		name = OK
	}
}
character_event = { #My dragon was wounded
	id = dragon.4796
	desc = "EVTDESCddragon.4796"
	picture = "GFX_evt_dragon_duel"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.4796"
		set_character_flag = dragon.4796
		FROM = {
			FROM = {
				if = {
					limit = { trait = wounded_dragon }
					hidden_tooltip = { remove_trait = wounded_dragon }
					add_trait = maimed_dragon
				}
				if = {
					limit = { 
						NOT = { trait = wounded_dragon }
						NOT = { trait = maimed_dragon }
					}
					add_trait = wounded_dragon
				}
			}
		}
		random_list = {
			60 = {
				
			}
			15 = {
				trigger = { NOT = { trait = burned } }
				add_trait = burned
				hidden_tooltip = { character_event = { id = trait_notification.23 } }					
			}
			25 = {
				if = {
					limit = { trait = wounded }			
					hidden_tooltip = { remove_trait = wounded }
					add_maimed_trait_effect = yes
				}
				if = {
					limit = { 
						NOT = { trait = wounded } 
						NOT = { is_maimed_trigger = yes }
					}
					add_trait_silently_wounded_effect = yes
				}
			}
		}		
	}
}
character_event = { #I wounded an enemy dragon
	id = dragon.4797
	desc = "EVTDESCddragon.4797"
	picture = "GFX_evt_dragon_duel"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	show_from_from = yes
	
	option = {
		name = "EVTOPTAdragon.4797"
		set_character_flag = dragon.4797
		random_list = {
			92 = {
				
			}
			4 = {
				trigger = { NOT = { trait = burned } }
				add_trait = burned
				hidden_tooltip = { character_event = { id = trait_notification.23 } }					
			}
			4 = {
				if = {
					limit = { trait = wounded }			
					hidden_tooltip = { remove_trait = wounded }
					add_maimed_trait_effect = yes
				}
				if = {
					limit = { 
						NOT = { trait = wounded } 
						NOT = { is_maimed_trigger = yes }
					}
					add_trait_silently_wounded_effect = yes
				}
			}
		}
		if = {
			limit = { FROMFROM = { NOT = { martial = 20 } } }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 15
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 20
					NOT = { martial = 40 } 
				}	
			}
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 20
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 40
					NOT = { martial = 60 } 
				}	
			}
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 30
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 60
					NOT = { martial = 80 }
				}	
			}
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 40
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 80
					NOT = { martial = 100 } 
				}	
			}
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 50
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = { FROMFROM = { martial = 100 } }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 65
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		hidden_tooltip = { #Scope back to team leader
			if = { 
				limit = {
					OR = {
						has_character_flag = dragonduel_team_leader_a 
						has_character_flag = dragonduel_team_leader_b
					}	
				}
				character_event = { id = dragon.4595 }
				break = yes
			}		
			top_liege = {
				random_realm_character = {
					limit = {
						can_use_dragon_abilities_trigger = yes
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						at_location = ROOT	
						OR = {
							has_character_flag = dragonduel_team_leader_a 
							has_character_flag = dragonduel_team_leader_b
						}	
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }	
					}
					character_event = { id = dragon.4595 }
				}
			}
		}
	}
}	
character_event = { #Inform other riders of wounded dragon
	id = dragon.4798
	desc = "EVTDESCddragon.4798"
	picture = "GFX_evt_dragon_duel"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	show_from_from = yes
	
	option = {
		name = "EVTOPTAdragon.4798"
		FROM = { 
			tooltip = { show_portrait = yes } 
			random_friend = { tooltip = { show_portrait = yes } }
		}
		FROMFROM = {
			tooltip = { show_portrait = yes }
			random_friend = { tooltip = { show_portrait = yes } }
		}
	}
}	
#WE WON THE DUEL
character_event = {
	id = dragon.48
	desc = "EVTDESCdragon.48"
	picture = "GFX_evt_dragons_flying"
	
	is_triggered_only = yes	
	show_from_from = yes
	
	immediate = {	
		hidden_tooltip = {
			top_liege = {
				any_realm_character = { #inform allies
					limit = {
						can_use_dragon_abilities_trigger = yes
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						NOT = { character = ROOT }
						at_location = ROOT
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }	
					}
					character_event = { id = dragon.4890 }		
				}
			}	
		}
		clr_character_flag = dragonduel	
		clr_character_flag = dragonduel_siege	
		set_character_flag = dragon.48
		dragon_rider = {
			limit = { at_location = ROOT has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }
			remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
			reverse_remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
			top_liege = {
				any_realm_character = {
					limit = { can_use_dragon_abilities_trigger = yes }
					remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
					reverse_remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
				}
			}	
		}
		clr_character_flag = dragonduel_team_leader_a 
		clr_character_flag = dragonduel_team_leader_b		
	}
	
	option = {
		name = "EVTOPTAdragon.48"			
	}
}
character_event = {
	id = dragon.4890
	desc = "EVTDESCdragon.48"
	picture = "GFX_evt_dragons_flying"
	
	is_triggered_only = yes	
	
	immediate = {	
		clr_character_flag = dragonduel	
		clr_character_flag = dragonduel_siege	
		dragon_rider = {
			limit = { at_location = ROOT has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }
			remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
			reverse_remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
			top_liege = {
				any_realm_character = {
					limit = { can_use_dragon_abilities_trigger = yes }
					remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
					reverse_remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
				}
			}	
		}
		clr_character_flag = dragonduel_team_leader_a 
		clr_character_flag = dragonduel_team_leader_b
	}
	
	option = {
		name = "EVTOPTAdragon.48"			
	}
}

# #Inform opponent escaped
# character_event = {
	# id = dragon.53
	# desc = "EVTDESCdragon.53"
	# picture = "GFX_valyria_dragon"
	
	# is_triggered_only = yes	
	
	# trigger = { has_character_flag = dragon_duel_resolved }
	
	# immediate = {	
		# clr_character_flag = dragon_duel_resolved
	# }
	
	# option = {
		# name = "EVTOPTAdragon.53"  
	# }
# }
# #Inform opponent not escaped
# character_event = {
	# id = dragon.54
	# desc = "EVTDESCdragon.54"
	# picture = "GFX_valyria_dragon"
	
	# is_triggered_only = yes	
	
	# trigger = { has_character_flag = dragon_duel_resolved }
	
	# immediate = {	
		# clr_character_flag = dragon_duel_resolved
	# }

	# option = {
		# name = "EVTOPTAdragon.54"  		
	# }
# }
# #Inform you didnt escape
# character_event = {
	# id = dragon.55
	# desc = "EVTDESCdragon.55"
	# picture = "GFX_valyria_dragon"
	
	# is_triggered_only = yes	
	
	# trigger = { has_character_flag = dragon_duel_resolved }
	
	# immediate = {	
		# clr_character_flag = dragon_duel_resolved
	# }

	# option = {
		# name = "EVTOPTAdragon.55"  	
	# }
# }
#Inform opponent stays in castle
character_event = {
	id = dragon.56
	desc = "EVTDESCdragon.56"
	
	is_triggered_only = yes	
	
	trigger = { has_character_flag = dragon_duel_resolved }
	
	immediate = {	
		clr_character_flag = dragon_duel_resolved
	}

	option = {
		name = "EVTOPTAdragon.56"  
		
	}
}
# #Inform you escaped
# character_event = {
	# id = dragon.57
	# desc = "EVTDESCdragon.57"
	# picture = "GFX_valyria_dragon"
	
	# is_triggered_only = yes	
	
	# trigger = { has_character_flag = dragon_duel_resolved }
	
	# immediate = {	
		# clr_character_flag = dragon_duel_resolved
	# }

	# option = {
		# name = "EVTOPTAdragon.57"  	
	# }
# }
# #Inform dragon vs dragon opponent gone
# character_event = {
	# id = dragon.59
	# desc = "EVTDESCdragon.59"
	# picture = "GFX_valyria_dragon"
	
	# is_triggered_only = yes	
	
	# trigger = {
		# trait = dragon		
	# }
	
	# option = {
		# name = "EVTOPTAdragon.59"  
		# if = {
			# limit = { 
				# NOT = { trait = poor_warrior_dragon }
				# NOT = { trait = trained_warrior_dragon } 
				# NOT = { trait = skilled_warrior_dragon } 
				# NOT = { trait = master_warrior_dragon } 
			# }
			# add_trait = poor_warrior_dragon
		# }
	# }
# }
###INTEL###
#dragon pit intel
character_event = {
	id = dragon.60
	
	min_age = 12
	picture = "GFX_evt_dragonpit_storming" 
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	desc = {
		text = "dragon_intel_dragonpit_desc"
		trigger = {
			NOR = {
				trait = dragon_rider
				has_global_flag = age_of_dragons
			}
		}
	}
	desc = {
		text = "dragon_intel_dragonpit_descB"
		trigger = {
			OR = {
				trait = dragon_rider
				has_global_flag = age_of_dragons
			}
		}
	}
	
	trigger = {
		OR = {
			has_artifact = dragon_egg
			trait = scholar
		}	
		NOT = { has_character_flag = dragon_intel_dragonpit }
		location = {
			county = {
				title = c_kings_landing
			}
		}
		b_red_keep = { has_building = ca_dragon_pit }
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		NOT = { graphical_culture = dragongfx }
		has_pilgrimage_trait_trigger = no
	}
	mean_time_to_happen = {
		days = 1		
	}
	
	option = {
		name = "dragon_intel_dragonpit_opt"
		ai_chance = {
			factor = 100
		}
		
		set_character_flag = dragon_intel_dragonpit	
		prestige = 25
	}		
}
#dragonstone intel
character_event = {
	id = dragon.61
	min_age = 12
	picture = "GFX_evt_valyria" 
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	desc = {
		text = "dragon_intel_dragonstone_desc"
		trigger = {
			NOR = {
				trait = dragon_rider
				has_global_flag = age_of_dragons
			}
		}
	}
	desc = {
		text = "dragon_intel_dragonstone_descB"
		trigger = {
			OR = {
				trait = dragon_rider
				has_global_flag = age_of_dragons
			}
		}
	}
	
	trigger = {
		OR = {
			has_artifact = dragon_egg
			trait = scholar
		}	
		NOT = { has_character_flag = dragon_intel_dragonstone }
		location = {
			county = {
				title = c_dragonstone
			}
		}
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		NOT = { graphical_culture = dragongfx }
		has_pilgrimage_trait_trigger = no
	}
	mean_time_to_happen = {
		days = 1	
	}
	
	option = {
		name = "dragon_intel_dragonstone_opt"
		ai_chance = {
			factor = 100
		}	
		set_character_flag = dragon_intel_dragonstone
		prestige = 25
	}		
}
#citadel intel
character_event = {
	id = dragon.62
	desc = "dragon_intel_citadel_desc"
	picture = GFX_evt_library
	min_age = 12

	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		OR = {
			has_artifact = dragon_egg
			trait = scholar
		}	
		NOT = { has_character_flag = dragon_intel_citadel }
		location = {
			county = {
				title = c_oldtown
			}
		}
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		NOT = { graphical_culture = dragongfx }
		has_pilgrimage_trait_trigger = no
	}
	
	mean_time_to_happen = {
		days = 1	
	}
	
	option = {
		name = "dragon_intel_citadel_opt"
		ai_chance = {
			factor = 100
		}
	
		set_character_flag = dragon_intel_citadel
		prestige = 25
	}		
}
#fof intel
character_event = {
	id = dragon.63
	desc = "dragon_intel_fof_desc"
	picture = "GFX_fieldoffire"
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		OR = {
			has_artifact = dragon_egg
			trait = scholar
		}	
		NOT = { has_character_flag = dragon_intel_fof }
		start_date = 8000.1.1
		location = {
			county = {
				title = c_bramsfort
			}
		}
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		NOT = { graphical_culture = dragongfx }
		has_pilgrimage_trait_trigger = no
	}
	
	mean_time_to_happen = {
		days = 1	
	}
	
	option = {
		name = "dragon_intel_fof_opt"
		ai_chance = {
			factor = 100
		}	
		set_character_flag = dragon_intel_fof
		prestige = 25
	}		
}
#harrenhal intel
character_event = {
	id = dragon.64
	desc = "dragon_intel_harrenhal_desc"
	picture = "GFX_fallofharrenhal"
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		OR = {
			has_artifact = dragon_egg
			trait = scholar
		}	
		NOT = { has_character_flag = dragon_intel_harrenhal }
		location = {
			county = {
				title = c_harrenhal
			}		
		}
		b_kingharren1 = { has_building = ca_harrenhal_ruins }
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		NOT = { graphical_culture = dragongfx }
		has_pilgrimage_trait_trigger = no
	}
	mean_time_to_happen = {
		days = 1		
	}
	
	option = {
		name = "dragon_intel_harrenhal_opt"
		ai_chance = {
			factor = 100
		}	
		set_character_flag = dragon_intel_harrenhal
		prestige = 25
	}		
}
#summerhall intel
character_event = {
	id = dragon.65
	desc = "dragon_intel_summerhall_desc"
	picture = "GFX_summerhall"
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	has_global_flag = summerhall_established
	
	trigger = {
		OR = {
			has_artifact = dragon_egg
			trait = scholar
		}	
		NOT = { has_character_flag = dragon_intel_summerhall }	
		location = {
			county = {
				title = c_summerhall
			}
		}
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		NOT = { graphical_culture = dragongfx }
		has_pilgrimage_trait_trigger = no
	}
	mean_time_to_happen = {
		days = 1
		
	}
	
	option = {
		name = "dragon_intel_summerhall_opt"
		ai_chance = {
			factor = 100
		}
		
		set_character_flag = dragon_intel_summerhall
		prestige = 25
	}		
}
#dragon eggs intel
character_event = {
	id = dragon.66
	desc = "dragon_intel_eggs_desc"
	picture = "GFX_targaryen_eggs"
	
	min_age = 6
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		has_artifact = dragon_egg
		NOT = { has_character_flag = dragon_intel_eggs }
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		NOT = { graphical_culture = dragongfx }
	}
	
	mean_time_to_happen = {
		years = 8
		modifier = {
			factor = 0.75
			liege = { is_close_relative = ROOT can_use_dragon_abilities_trigger = yes }
		}	
		modifier = {
			factor = 0.75
			liege = { dynasty = ROOT can_use_dragon_abilities_trigger = yes }
		}	
		modifier = {
			factor = 0.5
			has_dragonpit_trigger = yes 
		}		
	}
	
	option = {
		name = "dragon_intel_eggs_opt"	
		set_character_flag = dragon_intel_eggs
		prestige = 10
	}		
}
#smoking sea intel
character_event = {
	id = dragon.6501
	desc = "dragon_intel_smoking_sea_desc"
	picture = "GFX_evt_merchant_ship_at_sea_republic"
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		OR = {
			has_artifact = dragon_egg
			trait = scholar
		}	
		NOT = { has_character_flag = dragon_intel_smoking_sea }
		location = {
			province_id = 1010
		}
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		NOT = { graphical_culture = dragongfx }
		has_pilgrimage_trait_trigger = no
	}
	
	mean_time_to_happen = {
		days = 7	
	}
	
	option = {
		name = "dragon_intel_smoking_sea_opt"	
		set_character_flag = dragon_intel_smoking_sea
		prestige = 10
	}		
}
#Old Ghis intel
character_event = {
	id = dragon.6502
	desc = "dragon_intel_old_ghis_desc"
	picture = "GFX_evt_dragon_battle"
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		OR = {
			has_artifact = dragon_egg
			trait = scholar
		}	
		NOT = { has_character_flag = dragon_intel_old_ghis }
		location = {
			province_id = 619
		}
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		NOT = { graphical_culture = dragongfx }
		has_pilgrimage_trait_trigger = no
	}
	
	mean_time_to_happen = {
		days = 1		
	}
	
	option = {
		name = "dragon_intel_old_ghis_opt"
		set_character_flag = dragon_intel_old_ghis
		prestige = 10
	}		
}
#Volantis intel
character_event = {
	id = dragon.6503
	desc = "dragon_intel_volantis_desc"
	picture = GFX_evt_volantis
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		OR = {
			has_artifact = dragon_egg
			trait = scholar
		}	
		NOT = { has_character_flag = dragon_intel_volantis }
		location = {
			province_id = 419
		}
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		NOT = { graphical_culture = dragongfx }
		has_pilgrimage_trait_trigger = no
	}
	
	mean_time_to_happen = {
		days = 1		
	}
	
	option = {
		name = "dragon_intel_volantis_opt"
		set_character_flag = dragon_intel_volantis
		prestige = 10
	}		
}
#Asshai intel
character_event = {
	id = dragon.6504
	desc = "dragon_intel_asshai_desc"
	picture = GFX_valyria_dragon
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		OR = {
			has_artifact = dragon_egg
			trait = scholar
		}	
		NOT = { has_character_flag = dragon_intel_asshai }
		location = {
			province_id = 795
		}
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		NOT = { graphical_culture = dragongfx }
		has_pilgrimage_trait_trigger = no
	}
	
	mean_time_to_happen = {
		days = 1		
	}
	
	option = {
		name = "dragon_intel_asshai_opt"
		set_character_flag = dragon_intel_asshai
		prestige = 10
	}		
}
#Dynamic intel
character_event = {
	id = dragon.6505
	desc = "dragon_intel_dynamic_desc"
	picture = "GFX_fieldoffire"
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		OR = {
			has_artifact = dragon_egg
			trait = scholar
		}	
		NOT = { has_character_flag = dragon_intel_dynamic }
		location = {
			has_province_flag = dragon_intel
		}
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		NOT = { graphical_culture = dragongfx }
		has_pilgrimage_trait_trigger = no
	}
	
	mean_time_to_happen = {
		days = 1		
	}
	
	option = {
		name = "dragon_intel_dynamic_opt"
		set_character_flag = dragon_intel_dynamic
		prestige = 10
	}		
}
#Rebirth intel
character_event = {
	id = dragon.6506
	desc = "dragon_intel_rebirth_desc"
	picture = GFX_targaryen_hatching
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		OR = {
			has_artifact = dragon_egg
			trait = scholar
		}
		NOT = { has_character_flag = dragon_intel_rebirth }
		location = {
			has_province_flag = dragon_intel_rebirth
		}
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		NOT = { graphical_culture = dragongfx }
		has_pilgrimage_trait_trigger = no
	}
	
	mean_time_to_happen = {
		days = 1		
	}
	
	option = {
		name = "dragon_intel_rebirth_opt"
		set_character_flag = dragon_intel_rebirth
		prestige = 10
	}		
}
###Dragon Conquest CB###
#Dragon Conquest Surrender Demand
character_event = {
	id = dragon.67
	desc = "EVTDESCdragon.67"
	picture = "GFX_targaryen_balerion"
	#hide_from = yes
	is_triggered_only = yes
		
	immediate = {
		if = {
			limit = {
				tier = EMPEROR
				is_feudal = yes
				has_nickname = no
				age = 16
				is_female = no
				NOT = {
					any_playable_ruler = { has_nickname = the_king_who_knelt }
				}
			}
			random = {
				chance = 50
				set_character_flag = the_king_who_knelt
			}
		}
	}
	
	option = {
		name = "EVTOPTCdragon.67" #War invalid
		trigger = { 
			NOT = { war_with = FROM }
		}
		clr_character_flag = considering_surrender
		clr_character_flag = the_king_who_knelt
	}	
	
	option = {
		name = "EVTOPTAdragon.67" #Surrender
		trigger = {
			war_with = FROM
		}
		ai_chance = {
			factor = 20
			
			#Motives for surrender
			modifier = { 
				factor = 0				
				relative_power = { who = FROM power = 0.5 } #Powerful enemy
				NOT = { FROM = { OR = {
					OR = {
					any_friend = { trait = dragon martial = 60 }
					AND = {  graphical_culture = dragongfx martial = 60 }
				}
					AND = {  graphical_culture = dragongfx martial = 60 }
				} } } #Powerful dragon
				NAND = {
					graphical_culture = dragongfx
					martial = 60
					can_use_dragon_abilities_trigger = yes
				}
				OR = { #Desirable liege
					trait = proud
					NOT = { opinion = { who = FROM value = 25 } }
					NOT = { religion_group = FROM }
					NOR = {
						culture_group = FROM
						FROM = { culture = high_valyrian }
					}
				}
			}
			
			#Reason's to never surrender
			modifier = { 
				factor = 0
				OR = {
					government = alliance_government #Alliance
					has_landed_title = k_dorne #Dornish attrition/Braavosi resistance
					has_landed_title = e_dorne
					culture = braavosi
					NOT = { is_within_diplo_range = FROM } #far away
					capital_scope = { FROM = { capital_scope = { distance = { where = PREVPREV value = 1150 } } } }
					AND = { #I have my own powerful dragon
						can_use_dragon_abilities_trigger = yes
						any_friend = { trait = dragon martial = 60 NOT = { trait = maimed_dragon } }
					}
					AND = { #I AM a powerful dragon
						graphical_culture = dragongfx
						martial = 60
						can_use_dragon_abilities_trigger = yes
					}
					relative_power = { who = FROM power = 4 } #I am powerful
					AND = { #Ambitious/proud king
						higher_tier_than = DUKE
						has_regent = no
						trait = proud
						trait = ambitious
					}
					AND = { #Religious zeal
						trait = zealous
						NOT = { religion = FROM }
					}
				}	
			}
			modifier = { #Aegon's first conquest
				factor = 0
				has_global_flag = aegons_conquest
				NOT = { culture_group = free_cities }
				FROM = { NOT = { check_variable = { which = "kingdoms_conquered" value = 1 } } }
			}
			
			modifier = {
				factor = 1.5
				has_regent = yes
			}
			modifier = {
				factor = 2
				trait = content
			}
			modifier = {
				factor = 2
				trait = craven
			}
			modifier = {
				factor = 2
				trait = humble
			}
			modifier = {
				factor = 1.5
				trait = diligent
			}
			modifier = {
				factor = 1.5
				trait = patient
			}
			modifier = {
				factor = 1.5
				tier = COUNT
			}
			modifier = {
				factor = 1.5
				NOT = { relative_power = { who = FROM power = 0.8 } }	
			}
			modifier = {
				factor = 2
				NOT = { relative_power = { who = FROM power = 0.5 } }		
			}
			modifier = {
				factor = 2
				NOT = { relative_power = { who = FROM power = 0.25 } }		
			}
			modifier = {
				factor = 2
				NOT = { relative_power = { who = FROM power = 0.1 } }		
			}
			
			modifier = {
				factor = 1.5
				FROM = { check_variable = { which = "kingdoms_conquered" value = 1 } }
			}
			modifier = {
				factor = 1.5
				FROM = { check_variable = { which = "kingdoms_conquered" value = 2 } }
			}
			modifier = {
				factor = 1.5
				FROM = { check_variable = { which = "kingdoms_conquered" value = 3 } }
			}
			modifier = {
				factor = 1.5
				FROM = { check_variable = { which = "kingdoms_conquered" value = 4 } }
			}
			
			##Take into account dragon size
			modifier = {
				factor = 2
				FROM = {				
					any_friend = {
						trait = dragon
						martial = 80
					}	
				}	
			}
			modifier = {
				factor = 2
				FROM = {				
					graphical_culture = dragongfx
					martial = 80
					can_use_dragon_abilities_trigger = yes
				}	
			}
		}
		clr_character_flag = considering_surrender
		tooltip = {
			any_war = {
				if = {
					limit = {
						using_cb = dragon_conquest
						defender = { character = ROOT }
						attacker = { character = FROM }
					}	
					thirdparty_title_scope = { set_title_flag = war_title }
					end_war = success
				}	
			}
		}	
		if = {
			limit = { has_character_flag = the_king_who_knelt }
			give_nickname = the_king_who_knelt
			clr_character_flag = the_king_who_knelt
		}
		any_realm_lord = {
			if = {
				limit = {
					liege = { character = ROOT }
					OR = {
						trait = proud
						trait = wroth
						trait = brave
					}
				}
				opinion = {
					who = ROOT
					modifier = opinion_surrendered
					years = 10
				}
			}	
			if = {
				limit = { ai = no }
				hidden_tooltip = { character_event = { id = dragon.682 } }
			}	
		}
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_SURRENDERED_TO_DRAGON
				portrait = [From.GetID]
			}
		}
		e_rebels = {
			persistent_event_target:chronicle_player = {
				if = {
					limit = {
						OR = {		
							dynasty = ROOT
							is_liege_or_above = ROOT
							is_close_relative = ROOT
						}
						NOR = {	
							character = ROOT
							character = FROM
							dynasty = FROM
							is_close_relative = FROM
						}
					}
					chronicle = {
						entry = CHRONICLE_SURRENDERED_TO_DRAGON
						portrait = [Root.GetID]
					}
				}
			}
		}	
		FROM = {
			hidden_tooltip = { letter_event = { id = dragon.68 } }
		}
	}
	
	option = {
		name = "EVTOPTBdragon.67" #Never!
		trigger = {
			war_with = FROM
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.2
				martial = 15
			}
			modifier = {
				factor = 1.2
				martial = 18
			}
			modifier = {
				factor = 1.2
				martial = 21
			}
			modifier = {
				factor = 1.2
				martial = 24
			}
			modifier = {
				factor = 2.5
				trait = ambitious
			}
			modifier = {
				factor = 2.5
				trait = brave
			}
			modifier = {
				factor = 2.5
				trait = proud
			}
			modifier = {
				factor = 2
				trait = zealous
			}
			modifier = {
				factor = 2
				trait = wroth
			}
			modifier = {
				factor = 1.5
				tier = KING
			}
			modifier = {
				factor = 2
				tier = EMPEROR
			}
			modifier = {
				factor = 2
				relative_power = { who = FROM power = 2 }
			}
			modifier = {
				factor = 3
				relative_power = { who = FROM power = 3 }	
			}
			modifier = {
				factor = 1.5
				FROM = { NOT = { check_variable = { which = "kingdoms_conquered" value = 1 } } }
			}
				
			##Take into account dragon size
			modifier = {
				factor = 2
				FROM = {
					NOT = {					
						any_friend = {
							trait = dragon
							martial = 20
						}	
					}
				}	
			}
			modifier = {
				factor = 1.5
				FROM = {
					NOT = {					
						any_friend = {
							trait = dragon
							martial = 40
						}	
					}
				}	
			}
			modifier = {
				factor = 2
				FROM = {
					graphical_culture = dragongfx
					NOT = { martial = 20 }
					can_use_dragon_abilities_trigger = yes
				}	
			}
			modifier = {
				factor = 1.5
				FROM = {
					graphical_culture = dragongfx
					NOT = { martial = 40 }
					can_use_dragon_abilities_trigger = yes
				}	
			}
			
			##I have my own dragon
			modifier = {
				factor = 1.5
				can_use_dragon_abilities_trigger = yes
				any_friend = { trait = dragon martial = 20 NOT = { trait = maimed_dragon } }
			}
			modifier = {
				factor = 1.5
				can_use_dragon_abilities_trigger = yes
				any_friend = { trait = dragon martial = 40 NOT = { trait = maimed_dragon } }
			}
			modifier = {
				factor = 1.5
				graphical_culture = dragongfx
				martial = 20
				can_use_dragon_abilities_trigger = yes
			}
			modifier = {
				factor = 1.5
				graphical_culture = dragongfx
				martial = 40
				can_use_dragon_abilities_trigger = yes
			}
		}
		clr_character_flag = the_king_who_knelt
		clr_character_flag = considering_surrender
		hidden_tooltip = { FROM = { character_event = { id = mega_wars.2 } } }
	}	
}
#Inform Surrender
letter_event = {
	id = dragon.68
	desc = "EVTDESCdragon.68"

	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_DRAGON_CONQUEST_SURRENDER
				portrait = [From.GetID]
			}
		}
		e_rebels = {
			persistent_event_target:chronicle_player = {
				if = {
					limit = {
						NOT = { character = ROOT }
						OR = {		
							dynasty = ROOT
							is_liege_or_above = ROOT
							is_close_relative = ROOT
						}
					}
					chronicle = {
						entry = CHRONICLE_DRAGON_CONQUEST_SURRENDER
						portrait = [From.GetID]
					}
				}
			}
		}	
		hidden_tooltip = { 
			remove_character_modifier = mega_war_no_levies 
		}
	}
		
	option = {
		name = "EVTOPTAdragon.68" 
		any_war = {
			if = {
				limit = {
					using_cb = dragon_conquest
					defender = { character = FROM }
					attacker = { character = ROOT }
				}	
				thirdparty_title_scope = { set_title_flag = war_title }
				end_war = success
			}	
		}
	}
}	
#Inform vassal of Surrender
character_event = {
	id = dragon.682
	desc = "EVTDESCdragon.682"

	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.682" 		
		FROM = { FROM = { tooltip = { show_portrait = yes } } }
	}
}
#Inform defender dies with no heir
character_event = {
	id = dragon.69
	desc = "EVTDESCdragon.69"

	is_triggered_only = yes
	
	only_rulers = yes
	
	trigger = {
		NOT = { can_use_dragon_abilities_trigger = yes }
		NOT = { graphical_culture = dragongfx }
		OR = {
			is_tribal = yes
			is_feudal = yes
		}	
		any_war = {
			using_cb = dragon_conquest
			attacker = { can_use_dragon_abilities_trigger = yes }
			defender = { character = ROOT }
		}	
		current_heir = {
			OR = {
				AND = {
					is_female = yes
					NOT = { 
						ROOT = { 
							primary_title = {
								OR = {
									has_law = true_cognatic_succession 
									has_law = enatic_succession
									has_law = enatic_cognatic_succession
								}	
							} 
						} 
					}
				}	
				NOT = { dynasty = ROOT }
			}
		}
	}
	
	immediate = {
		if = {
			limit = { ai = no }
			current_heir = { set_character_flag = banish_me }
		}
		if = {
			limit = { ai = yes }
			any_war = {
				if = {
					limit = {
						#using_cb = dragon_conquest
						attacker = { can_use_dragon_abilities_trigger = yes }
						defender = { character = ROOT }
					}
					#end_war = success
					attacker = {
						ROOT = {
							if = {
								limit = { ai = no }
								chronicle = {
									entry = CHRONICLE_DRAGON_CONQUEST_NO_HEIR
									portrait = [Prev.GetID]
								}
							}
						}	
						e_rebels = {
							persistent_event_target:chronicle_player = {
								if = {
									limit = {
										OR = {		
											dynasty = ROOT
											is_liege_or_above = ROOT
											is_close_relative = ROOT
										}
										NOR = {	
											character = ROOT
											character = PREVPREV
											dynasty = PREVPREV
											is_close_relative = PREVPREV
										}
									}
									chronicle = {
										entry = CHRONICLE_DRAGON_CONQUEST_NO_HEIR
										portrait = [PrevPrev.GetID]
									}
								}
							}
						}	
						if = {
							limit = { ROOT = { tier = EMPEROR } }
							set_character_flag = king_has_died
						}
						ROOT = {
							any_courtier = {
								limit = { dynasty = ROOT }
								set_character_flag = banish_me
							}
							any_artifact = { #transfer artifacts					
								limit = {	
									OR = {
										NOT = { has_artifact_flag = combat_weapon }
										has_artifact_flag = combat_tier_3
									}	
									NOT = { has_artifact_flag = no_usurp_transfer }
									NOT = { has_artifact_flag = valyrian_steel }
									NOT = { has_artifact_flag = valyrian_armour }
								}
								transfer_artifact = {				
									from = ROOT		
									to = PREVPREV
								}
							}
							if = {
								limit = {
									PREV = { has_landed_title = e_iron_throne }
								}
								any_vassal = {
									set_defacto_liege = PREVPREV
								}
								any_demesne_title = {
									limit = { 
										tier = EMPEROR 
										NOT = { title = e_iron_throne }
										OR = {
											capital_scope = { region = world_westeros }
											title = e_iron_isles #These titles dont have capitals
											title = e_riverlands
										}
									}
									destroy_landed_title = THIS
								}	
								any_demesne_title = {
									limit = { NOT = { tier = EMPEROR } }
									usurp_title = { target = PREVPREV type = invasion }
								}	
							}
							if = {
								limit = {
									NOT = { PREV = { has_landed_title = e_iron_throne } }
								}	
								any_demesne_title = {
									usurp_title = { target = PREVPREV type = invasion }
								}	
							}						
						}	
						character_event = { id = dragon.70 }
					}	
				}	
			}
		}	
	}
	
	option = {
		name = "EVTOPTAdragon.69" 
		if = {
			limit = { ai = no }
			any_war = {
				if = {
					limit = {
						#using_cb = dragon_conquest
						attacker = { can_use_dragon_abilities_trigger = yes }
						defender = { has_character_flag = banish_me }
					}
					ROOT = {
						if = {
							limit = { ai = no }
							chronicle = {
								entry = CHRONICLE_DRAGON_CONQUEST_NO_HEIR
								portrait = [Prev.GetID]
							}
						}
					}	
					e_rebels = {
						persistent_event_target:chronicle_player = {
							if = {
								limit = {
									OR = {		
										dynasty = ROOT
										is_liege_or_above = ROOT
										is_close_relative = ROOT
									}
									NOR = {	
										character = ROOT
										character = PREVPREV
										dynasty = PREVPREV
										is_close_relative = PREVPREV
									}
								}
								chronicle = {
									entry = CHRONICLE_DRAGON_CONQUEST_NO_HEIR
									portrait = [PrevPrev.GetID]
								}
							}
						}
					}	
					#end_war = success
					attacker = {
						if = {
							limit = { ROOT = { tier = EMPEROR } }
							set_character_flag = king_has_died
						}
						ROOT = {
							any_artifact = { #transfer crown jewells					
								limit = {	
									OR = {
										NOT = { has_artifact_flag = combat_weapon }
										has_artifact_flag = combat_tier_3
									}	
									NOT = { has_artifact_flag = no_usurp_transfer }
									NOT = { has_artifact_flag = valyrian_steel }
									NOT = { has_artifact_flag = valyrian_armour }
								}
								transfer_artifact = {				
									from = THIS			
									to = PREVPREV
								}
							}
						}
						random_playable_ruler = {
							limit = {
								dynasty = ROOT
								has_character_flag = banish_me
							}
							any_artifact = { #transfer crown jewells					
								limit = {	
									OR = {
										NOT = { has_artifact_flag = combat_weapon }
										has_artifact_flag = combat_tier_3
									}	
									NOT = { has_artifact_flag = no_usurp_transfer }
									NOT = { has_artifact_flag = valyrian_steel }
									NOT = { has_artifact_flag = valyrian_armour }
								}
								transfer_artifact = {				
									from = PREV		
									to = PREVPREV
								}
							}
							any_courtier = {
								limit = { dynasty = ROOT }
								set_character_flag = banish_me
							}
							if = {
								limit = {
									PREV = { has_landed_title = e_iron_throne }
								}
								any_vassal = {
									set_defacto_liege = PREVPREV
								}
								any_demesne_title = {
									limit = { 
										tier = EMPEROR 
										NOT = { title = e_iron_throne }
										OR = {
											capital_scope = { region = world_westeros }
											title = e_iron_isles #These titles dont have capitals
											title = e_riverlands
										}
									}
									destroy_landed_title = THIS
								}	
								any_demesne_title = {
									limit = { NOT = { tier = EMPEROR } }
									usurp_title = { target = PREVPREV type = invasion }
								}	
							}
							if = {
								limit = {
									NOT = { PREV = { has_landed_title = e_iron_throne } }
								}	
								any_demesne_title = {
									usurp_title = { target = PREVPREV type = invasion }
								}	
							}						
						}
						
						character_event = { id = dragon.70 }
					}	
				}	
			}
		}	
	}
}	
#Inform defender dies with no heir
character_event = {
	id = dragon.70
	desc = "EVTDESCdragon.70"

	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.70" 
		any_realm_character = {
			limit = {
				dynasty = FROM
				has_character_flag = banish_me
			}
			ROOT = { reverse_banish = PREV }
			clr_character_flag = banish_me
		}
		any_independent_ruler = {
			any_realm_character = {
				limit = {
					dynasty = FROM
					has_character_flag = banish_me
				}
				ROOT = { reverse_banish = PREV }
				clr_character_flag = banish_me
			}
		}
		if = {
			limit = { ROOT = { tier = EMPEROR } }	
			if = {
				limit = { has_character_flag = king_has_died }
				hidden_tooltip = {
					ROOT = {
						if = {
							limit = { NOT = { check_variable = { which = "kingdoms_conquered" value = 0 } } }
							set_variable = { which = "kingdoms_conquered" value = 1 }
						}
						if = {
							limit = { check_variable = { which = "kingdoms_conquered" value = 0 } } 
							change_variable = { which = "kingdoms_conquered" value = 1 }
						}
						if = {
							limit = { has_global_flag = aegons_conquest } 
							character_event = { id = aegons_landing.4 days = 1 }
							character_event = { id = aegons_landing.5 days = 1 }
							narrative_event = { id = aegons_landing.6 days = 1 }
							narrative_event = { id = aegons_landing.61 days = 1 }
							narrative_event = { id = aegons_landing.9 days = 1 }
						}
					}	
				}
			}
		}
		ROOT = {
			if = {
				limit = {
					check_variable = { which = "kingdoms_conquered" value = 5 }
					NOT = { has_nickname = nick_the_conqueror }
				}
				give_nickname = nick_the_conqueror
			}
		}
		if = {
			limit = {
				has_character_flag = king_has_died
			}
			prestige = 300
			clr_character_flag = king_has_died
		}
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_DRAGON_CONQUEST_NO_HEIR_WINNER
				portrait = [From.GetID]
			}
		}	
		e_rebels = {
			persistent_event_target:chronicle_player = {
				if = {
					limit = {
						NOT = { character = ROOT }
						OR = {		
							dynasty = ROOT
							is_liege_or_above = ROOT
							is_close_relative = ROOT
						}
					}
					chronicle = {
						entry = CHRONICLE_DRAGON_CONQUEST_NO_HEIR_WINNER
						portrait = [From.GetID]
					}
				}
			}	
		}	
	}
}
###Feed to Dragon on execution?###
character_event = {
	id = dragon.71
	desc = "EVTDESCdragon.71"
	picture = "GFX_evt_dragon_flame_death"
	
	is_triggered_only = yes	
	show_from_from = yes
	
	immediate = {
		random_friend = {
			limit = { trait = dragon }
			save_event_target_as = dragon_feed
		}
	}
	
	option = {
		name = "EVTOPTAdragon.71"  #Feed
		FROMFROM = {
			death = {
				death_reason = death_execution_dragon
				killer = ROOT
			}	
		}	
	}
}
#Inform relative
character_event = {
	id = dragon.72
	desc = "EVTDESCdragon.72"
	picture = "GFX_evt_dragon_flame_death"
	
	is_triggered_only = yes	
	
	option = {
		name = "EVTOPTA999900082" 		
		FROMFROM = { tooltip = { show_portrait = yes } }
	}
}
###Show me the dragons###
character_event = {
	id = dragon.73
	desc = "EVTDESCdragon.73"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes	
	
	trigger = { has_character_flag = show_me_the_dragons }
	
	option = {
		name = "EVTOPTAdragon.73" #Dragon Riders
		custom_tooltip = { text = TOOLTIPGETDRAGONRIDERS }
		any_character = {
			limit = { 
				trait = dragon
				is_alive = yes
				any_friend = {
					is_alive = yes
					can_use_dragon_abilities_trigger = yes
				}
			}
			tooltip = { show_portrait = yes }
			random_friend = { character_event = { id = dragon.73 days = 1 tooltip = TOOLTIPGETNAME } }	
		}
		clr_character_flag = show_me_the_dragons
	}
	option = {
		name = "EVTOPTBdragon.73" #Untamed Dragon
		custom_tooltip = { text = TOOLTIPGETUNTAMEDDRAGONS }
		any_character = {
			limit = { 
				trait = dragon
				is_alive = yes
				any_friend = {
					is_alive = yes
					NOT = { can_use_dragon_abilities_trigger = yes }
				}
			}
			tooltip = { show_portrait = yes }
			random_friend = { character_event = { id = dragon.73 days = 1 tooltip = TOOLTIPGETNAME } }
		}
		clr_character_flag = show_me_the_dragons
	}
	option = {
		name = "EVTOPTCdragon.73" #Wild Dragon
		custom_tooltip = { text = TOOLTIPGETWILDDRAGONS }
		any_character = {
			limit = {
				trait = dragon
				is_alive = yes
				NOT = { any_friend = { is_alive = yes } }
			}
			tooltip = { show_portrait = yes }
			custom_tooltip = { text = TOOLTIPGETWILDDRAGON }
		}
	}
	option = {
		name = "EVTOPTDdragon.73" #Dragon Egg
		custom_tooltip = { text = TOOLTIPGETDRAGONEGGS }
		any_character = {
			limit = { 
				has_artifact = dragon_egg
				is_alive = yes
			}
			tooltip = { show_portrait = yes }
			character_event = { id = dragon.73 days = 1 tooltip = TOOLTIPGETNAMEEGG }	
		}
		clr_character_flag = show_me_the_dragons		
	}
}
###AI dragon rider takes to the field###
character_event = {
	id = dragon.74
	desc = "AI_dragon.74"

	capable_only = yes
	prisoner = no
	min_age = 14
	ai = yes
	friends = yes
	in_command = no
	
	trigger = {
		can_use_dragon_abilities_trigger = yes
		OR = {
			can_be_commander_trigger = yes
			has_job_title = job_marshal
			has_minor_title = title_commander
		}
		any_friend = { 
			trait = dragon		
			is_alive = yes 
			NOT = { trait = maimed_dragon }
			OR = {
				martial = 20
				AND = {
					martial = 10
					ROOT = {
						OR = {
							has_job_title = job_marshal
							is_ruler = yes
							has_minor_title = title_commander
							martial = 16
							trait = skilled_warrior
							trait = master_warrior
						}
					}
				}
			}
		}
		OR = {
			AND = {
				war = yes
				OR = {
					is_primary_war_attacker = yes
					is_primary_war_defender = yes
					independent = yes
				}
			}	
			AND = {
				is_ruler = no
				liege = { 
					war = yes 
					ai = yes
					OR = {
						is_primary_war_attacker = yes
						is_primary_war_defender = yes
						independent = yes
					}
				}
			}
		}
		NOT = { has_severe_disability_trigger = yes }
		is_ill = no		
		OR = {
			NOT = { has_character_flag = sent_back_to_field }
			had_character_flag = { flag = sent_back_to_field days = 200 }
		}	
	}
	
	option = {
		name = "ai event" 
		set_character_flag = sent_back_to_field
		if = {
			limit = {
				NOT = { has_job_title = job_marshal }
				NOT = { has_minor_title = title_commander }
				is_ruler = no
			}
			give_minor_title = title_commander
		}
		cancel_job_action = yes
		if = { #If in an unknown location spawn in an existing army
			limit = {
				is_ruler = no
				liege = { NOT = { demesne_size = 1 } }
			}
			liege = {
				random_courtier = {
					limit = { in_command = yes }
					location = {
						ROOT = {
							spawn_unit = {
								province = PREV
								leader = ROOT
								scaled_by_biggest_garrison = 0.5
								troops = {
									archers = { 50 50 }
									heavy_infantry = { 160 160 }
									light_infantry = { 220 220 }	
									light_cavalry = { 40 40 }		
									knights = { 30 30 }						
								}
								match_min = 100
								match_max = 500
								attrition = 1.0
								earmark = dragon_unit
								disband_on_peace = yes
							}
							break = yes
						}
					}
				}
			}
		}	
		location = {
			ROOT = {
				spawn_unit = {
					province = PREV
					leader = ROOT
					scaled_by_biggest_garrison = 0.5
					troops = {
						archers = { 50 50 }
						heavy_infantry = { 160 160 }
						light_infantry = { 220 220 }	
						light_cavalry = { 40 40 }		
						knights = { 30 30 }						
					}
					match_min = 100
					match_max = 500
					attrition = 1.0
					earmark = dragon_unit
					disband_on_peace = yes
				}
			}	
		}
	}	
}
# #AI dragon rider goes home
# character_event = {
	# id = dragon.75
	# desc = "AI_dragon.75"

	# capable_only = yes
	# prisoner = no
	# hide_window = yes
	
	# trigger = {
		# can_use_dragon_abilities_trigger = yes
		# #ai = yes
		# has_character_flag = sent_back_to_field
		# NOT = {
			# OR = {
				# AND = {
					# war = yes
					# OR = {
						# is_primary_war_attacker = yes
						# is_primary_war_defender = yes
						# independent = yes
					# }
				# }	
				# AND = {
					# is_ruler = no
					# liege = { 
						# war = yes 
						# ai = yes
						# OR = {
							# is_primary_war_attacker = yes
							# is_primary_war_defender = yes
							# independent = yes
						# }
					# }
				# }
			# }
		# }		
	# }
	
	# option = {
		# name = "ai event" 
		# clr_character_flag = sent_back_to_field
		# if = {
			# limit = { is_ruler = yes }
			# disband_event_forces = dragon_unit
		# }	
		# if = {
			# limit = { is_ruler = no }
			# liege = { disband_event_forces = dragon_unit }
		# }		
	# }	
# }
###Age of dragons begins###
narrative_event = {
	id = dragon.76
	desc = "EVTDESCdragon.76"
	title = "EVTNAMEdragon.76"
	picture = "GFX_evt_dragons_flying"
	
	is_triggered_only = yes
	
	major = yes
	
	trigger = {
		dragon = {
			is_alive = yes
			NOT = { has_character_flag = shadow_lands_dragon }
			count = 4						
		}
	}
	
	option = {
		name = "EVTOPTAdragon.76"
		trigger = { can_use_dragon_abilities_trigger = yes }
	}	
	
	option = {
		name = "EVTOPTBdragon.76"
		trigger = { NOT = { can_use_dragon_abilities_trigger = yes } }
	}
}
#age of dragons ends
narrative_event = {
	id = dragon.77
	desc = "EVTDESCdragon.77"
	title = "EVTNAMEdragon.77"
	picture = "GFX_evt_dragon_skull"
	
	is_triggered_only = yes
	
	major = yes
	hide_from = yes
	
	option = {
		name = "OK"
	}
}
#Random dragon appears in shadowlands
province_event = { 
	id = dragon.78
	
	hide_window = yes
	has_global_flag = age_of_dragons
	
	trigger = {	
		OR = {
			province_id = 801
			province_id = 802
			province_id = 803
			province_id = 804
			province_id = 805
			province_id = 806
		}
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
		dragon = {
			is_alive = yes
			has_character_flag = shadow_lands_dragon
			count = 3						
		}
	}	
	
	mean_time_to_happen = {
		years = 500
		modifier = {
			factor = 3
			dragon = {
				location = { province_id = ROOT }
				is_alive = yes
				NOT = { any_friend = { always = yes } }
			}
		}
	}
	
	option = {
		name = "Ok"
		random_list = {
			50 = {
				create_character = {
					dynasty = actually_culture
					age = 5
					culture = dragon_culture
					religion = dragon_rel
					historical = yes
				}
			}
			50 = {
				create_character = {
					female = yes
					dynasty = actually_culture
					age = 5
					culture = dragon_culture
					religion = dragon_rel
					historical = yes
				}
			}
		}
		new_character = {
			#dynasty = mother_bastard
			add_trait = dragon
			add_trait = incapable_dragon
			character_event = { id = dragon.599 }
			change_martial = 5
			set_character_flag = shadow_lands_dragon
			random = {
				chance = 5
				add_trait = fair_dragon
			}
			random = {
				chance = 5
				if = {
					limit = { NOT = { trait = fair_dragon } }
					add_trait = ugly_dragon
				}	
			}
			random = {
				chance = 5
				add_trait = strong_dragon
			}
			random = {
				chance = 33
				add_trait = nimble_dragon
			}
			random = {
				chance = 15
				add_trait = fertile_dragon
			}
			random_list = {
				1 = { add_trait = dragon_1 }
				1 = { add_trait = dragon_2 }
				1 = { add_trait = dragon_3 }
				1 = { add_trait = dragon_4 }
				1 = { add_trait = dragon_5 }
				1 = { add_trait = dragon_6 }
				1 = { add_trait = dragon_7 }
				1 = { add_trait = dragon_8 }
				1 = { add_trait = dragon_9 }
				1 = { add_trait = dragon_10 }
				1 = { add_trait = dragon_11 }
				1 = { add_trait = dragon_12 }
				1 = { add_trait = dragon_13 }
				1 = { add_trait = dragon_14 }
				1 = { add_trait = dragon_15 }
				1 = { add_trait = dragon_16 }
				1 = { add_trait = dragon_17 }
				1 = { add_trait = dragon_18 }
				1 = { add_trait = dragon_19 }
				1 = { add_trait = dragon_20 }
				1 = { add_trait = dragon_21 }
				1 = { add_trait = dragon_22 }
				1 = { add_trait = dragon_23 }
				1 = { add_trait = dragon_24 }
				1 = { add_trait = dragon_25 }
				1 = { add_trait = dragon_26 }
				1 = { #Balerion
					modifier = {
						factor = 0.05
					}
					add_trait = dragon_27 
				}
			}
			character_event = { id = dragon.1599 }
		}
		# add_province_modifier = {
			# name = dragon_lair
			# duration = 75000
		# }
	}
}
#Storming of Dragonpit during Peasant Revolt
province_event = { 
	id = dragon.79
	title = EVTNAMEdragon.79
	desc = EVTDESCdragon.79
	picture = GFX_evt_dragonpit_storming
	border = GFX_event_normal_frame_war
	
	trigger = {
		owner = {
			top_liege = {
				war = yes					
				any_war = {
					defender = { character = PREV }
					AND = {
						using_cb = peasant_revolt
						war_title = ROOT # The county
					}
				}
			}
			NOT = { graphical_culture = dragongfx }
		}
		dragon = {
			is_alive = yes
			location = { province_id = ROOT }
			has_character_modifier = locked_in_dragonpit
			NOT = { any_friend = { in_command = yes } }
			NOT = { martial = 60 }
		}
		any_province_lord = {
			any_demesne_title = {
				tier = BARON
				OR = {
					AND = {
						has_building = ca_dragon_pit 
						location = { province_id = ROOT }
					}	
					AND = {
						has_building = fp_dragon_pit
						ROOT = { is_capital = yes }
					}	
				}	
			}
		}
	}	
	
	mean_time_to_happen = {
		years = 20
		modifier = {
			factor = 0.15
			any_province_lord = {
				any_demesne_title = {
					tier = BARON
					OR = {
						AND = {
							has_building = ca_dragon_pit 
							location = { province_id = ROOT }
						}	
						AND = {
							has_building = fp_dragon_pit
							ROOT = { is_capital = yes }
						}	
					}	
					controller = { trait = peasant_leader }
				}
			}
		}
	}
	
	option = {
		name = EVTOPTAdragon.79
		owner = {
			if = {
				limit = { ai = no }
				chronicle = {
					entry = CHRONICLE_DRAGON_PIT_STORMING
					picture = GFX_evt_peasants
				}
			}
		}
		any_province_character = {
			limit = { 
				trait = dragon 
				has_character_modifier = locked_in_dragonpit
				is_alive = yes
				NOT = { any_friend = { in_command = yes } }			
			}
			if = {
				limit = { NOT = { martial = 60 } }
				hidden_tooltip = { character_event = { id = dragon.80 } } 
				tooltip = { death = yes }
			}
			if = {
				limit = { martial = 60 }
				random = {
					chance = 50
					hidden_tooltip = { character_event = { id = dragon.80 } } 
					tooltip = { death = yes }
				}
			}
			random_friend = {
				if = {
					limit = { ROOT = { owner = { character = PREVPREV } } }
					random = {
						chance = 33
						add_trait = depressed
						hidden_tooltip = {
							character_event ={
								id = 38288 #Notify
							}
						}
					}
				}
			}			
		}
		county = {
			any_de_jure_vassal_title = {
				controller = {
					if = {
						limit = { NOT = { has_landed_title = PREV } }
						random_friend = {
							limit = { 
								trait = dragon 
								is_alive = yes
								has_character_modifier = locked_in_dragonpit
								NOT = { any_friend = { in_command = yes } }
							}
							if = {
								limit = { NOT = { martial = 60 } }
								hidden_tooltip = { character_event = { id = dragon.80 } } 
								tooltip = { death = yes }
							}
							if = {
								limit = { martial = 60 }
								random = {
									chance = 50
									hidden_tooltip = { character_event = { id = dragon.80 } } 
									tooltip = { death = yes }
								}
							}	
						}
						any_ward = {
							random_friend = {
								limit = { 
									trait = dragon 
									is_alive = yes
									has_character_modifier = locked_in_dragonpit
									NOT = { any_friend = { in_command = yes } }
								}
								if = {
									limit = { NOT = { martial = 60 } }
									hidden_tooltip = { character_event = { id = dragon.80 } } 
									tooltip = { death = yes }
								}
								if = {
									limit = { martial = 60 }
									random = {
										chance = 50
										hidden_tooltip = { character_event = { id = dragon.80 } } 
										tooltip = { death = yes }
									}
								}	
							}
						}
					}	
				}
			}
		}
	}
}
#Dragon is killed
character_event = {
	id = dragon.80

	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		hidden_tooltip = { 
			any_friend = {
				character_event = { id = dragon.81 } 
				remove_trait = dragon_rider
				if = { #Check dragon riding dynasty status
					limit = {
						NOT = { dynasty = 0 }
						has_dynasty_flag = dragon_riding_dynasty
						NOT = { any_dynasty_member = { can_use_dragon_abilities_trigger = yes	is_alive = yes } }
					}
					clr_dynasty_flag = dragon_riding_dynasty
				}
			} 
		}
		death = {
			death_reason = death_rabble
		}
	}
	
	option = {
		name = "OK"
	}
}
#Inform rider Dragon is killed
character_event = {
	id = dragon.81
	title = EVTNAMEdragon.79
	desc = EVTDESCdragon.81
	picture =GFX_evt_dragonpit_storming
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { any_demesne_province = { province_id = FROMFROM } }
	}
	
	option = {
		name = EVTOPTAdragon.79
		random = {
			chance = 33
			add_trait = depressed
			hidden_tooltip = {
				character_event ={
					id = 38288 #Notify
				}
			}
		}
	}
}
#Ruler Designer dragons
character_event = { 
	id = dragon.82
	desc = "EVTDESCdragon.82"
	picture = "GFX_evt_dragon_riding_2"
	
	ai = no
	
	trigger = {
		trait = dragon_rider
		NOT = {
			any_friend = {
				trait = dragon
				is_alive = yes
			}
		}
		had_global_flag = { flag = scenario_initialised days = 7 } #allow time for the 'friend' connection to be made
	}
	
	option = {
		name = EVTOPTAdragon.82 #Hatchling
		trigger = {
			NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
			NOT = { graphical_culture = dragongfx }
		}
		create_character = {
			dynasty = actually_culture
			age = 2
			culture = dragon_culture
			religion = dragon_rel
			female = 50
			historical = yes
		}
		new_character = {
			#dynasty = mother_bastard
			add_friend = ROOT
			add_trait = dragon
			add_trait = incapable_dragon
			change_martial = 1
			random = {
				chance = 5
				add_trait = fair_dragon
			}
			random = {
				chance = 5
				if = {
					limit = { NOT = { trait = fair_dragon } }
					add_trait = ugly_dragon
				}	
			}
			random = {
				chance = 5
				add_trait = strong_dragon
			}
			random = {
				chance = 33
				add_trait = nimble_dragon
			}
			random = {
				chance = 15
				add_trait = fertile_dragon
			}
			random_list = {
				1 = { add_trait = dragon_1 }
				1 = { add_trait = dragon_2 }
				1 = { add_trait = dragon_3 }
				1 = { add_trait = dragon_4 }
				1 = { add_trait = dragon_5 }
				1 = { add_trait = dragon_6 }
				1 = { add_trait = dragon_7 }
				1 = { add_trait = dragon_8 }
				1 = { add_trait = dragon_9 }
				1 = { add_trait = dragon_10 }
				1 = { add_trait = dragon_11 }
				1 = { add_trait = dragon_12 }
				1 = { add_trait = dragon_13 }
				1 = { add_trait = dragon_14 }
				1 = { add_trait = dragon_15 }
				1 = { add_trait = dragon_16 }
				1 = { add_trait = dragon_17 }
				1 = { add_trait = dragon_18 }
				1 = { add_trait = dragon_19 }
				1 = { add_trait = dragon_20 }
				1 = { add_trait = dragon_21 }
				1 = { add_trait = dragon_22 }
				1 = { add_trait = dragon_23 }
				1 = { add_trait = dragon_24 }
				1 = { add_trait = dragon_25 }
				1 = { add_trait = dragon_26 }
				1 = { #Balerion
					modifier = {
						factor = 0.05
					}
					add_trait = dragon_27 
				}
			}
			character_event = { id = dragon.599 }
		}
	}
	
	option = {
		name = EVTOPTBdragon.82 #Young Dragon
		trigger = {
			NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
			NOT = { graphical_culture = dragongfx }
		}
		create_character = {
			dynasty = actually_culture
			age = 40
			culture = dragon_culture
			religion = dragon_rel
			female = 50
			historical = yes
			attributes = {
				martial = 20
			}
		}
		new_character = {
			#dynasty = mother_bastard
			add_friend = ROOT
			add_trait = dragon
			add_trait = incapable_dragon
			random = {
				chance = 5
				add_trait = fair_dragon
			}
			random = {
				chance = 5
				if = {
					limit = { NOT = { trait = fair_dragon } }
					add_trait = ugly_dragon
				}	
			}
			random = {
				chance = 5
				add_trait = strong_dragon
			}
			random = {
				chance = 33
				add_trait = nimble_dragon
			}
			random = {
				chance = 15
				add_trait = fertile_dragon
			}
			random_list = {
				1 = { add_trait = dragon_1 }
				1 = { add_trait = dragon_2 }
				1 = { add_trait = dragon_3 }
				1 = { add_trait = dragon_4 }
				1 = { add_trait = dragon_5 }
				1 = { add_trait = dragon_6 }
				1 = { add_trait = dragon_7 }
				1 = { add_trait = dragon_8 }
				1 = { add_trait = dragon_9 }
				1 = { add_trait = dragon_10 }
				1 = { add_trait = dragon_11 }
				1 = { add_trait = dragon_12 }
				1 = { add_trait = dragon_13 }
				1 = { add_trait = dragon_14 }
				1 = { add_trait = dragon_15 }
				1 = { add_trait = dragon_16 }
				1 = { add_trait = dragon_17 }
				1 = { add_trait = dragon_18 }
				1 = { add_trait = dragon_19 }
				1 = { add_trait = dragon_20 }
				1 = { add_trait = dragon_21 }
				1 = { add_trait = dragon_22 }
				1 = { add_trait = dragon_23 }
				1 = { add_trait = dragon_24 }
				1 = { add_trait = dragon_25 }
				1 = { add_trait = dragon_26 }
				1 = { #Balerion
					modifier = {
						factor = 0.05
					}
					add_trait = dragon_27 
				}
			}
			character_event = { id = dragon.599 }
			character_event = { id = dragon.0 }
		}
	}
	
	option = {
		name = EVTOPTCdragon.82 #Adult Dragon
		trigger = {
			NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
			NOT = { graphical_culture = dragongfx }
		}
		create_character = {
			dynasty = actually_culture
			age = 85
			culture = dragon_culture
			religion = dragon_rel
			female = 50
			historical = yes
			attributes = {
				martial = 50
			}
		}
		new_character = {
			#dynasty = mother_bastard
			add_friend = ROOT
			add_trait = dragon
			add_trait = incapable_dragon
			random = {
				chance = 5
				add_trait = fair_dragon
			}
			random = {
				chance = 5
				add_trait = strong_dragon
			}
			random = {
				chance = 5
				if = {
					limit = { NOT = { trait = fair_dragon } }
					add_trait = ugly_dragon
				}	
			}
			random = {
				chance = 15
				add_trait = fertile_dragon
			}
			random_list = {
				1 = { add_trait = dragon_1 }
				1 = { add_trait = dragon_2 }
				1 = { add_trait = dragon_3 }
				1 = { add_trait = dragon_4 }
				1 = { add_trait = dragon_5 }
				1 = { add_trait = dragon_6 }
				1 = { add_trait = dragon_7 }
				1 = { add_trait = dragon_8 }
				1 = { add_trait = dragon_9 }
				1 = { add_trait = dragon_10 }
				1 = { add_trait = dragon_11 }
				1 = { add_trait = dragon_12 }
				1 = { add_trait = dragon_13 }
				1 = { add_trait = dragon_14 }
				1 = { add_trait = dragon_15 }
				1 = { add_trait = dragon_16 }
				1 = { add_trait = dragon_17 }
				1 = { add_trait = dragon_18 }
				1 = { add_trait = dragon_19 }
				1 = { add_trait = dragon_20 }
				1 = { add_trait = dragon_21 }
				1 = { add_trait = dragon_22 }
				1 = { add_trait = dragon_23 }
				1 = { add_trait = dragon_24 }
				1 = { add_trait = dragon_25 }
				1 = { add_trait = dragon_26 }
				1 = { #Balerion
					modifier = {
						factor = 0.05
					}
					add_trait = dragon_27 
				}
			}
			character_event = { id = dragon.599 }
			character_event = { id = dragon.0 }
		}
	}
	
	option = {
		name = EVTOPTDdragon.82 #Huge Dragon
		trigger = {
			NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
			NOT = { graphical_culture = dragongfx }
		}
		create_character = {
			dynasty = actually_culture
			age = 160
			culture = dragon_culture
			religion = dragon_rel
			female = 50
			historical = yes
			attributes = {
				martial = 90
			}
		}
		new_character = {
			#dynasty = mother_bastard
			add_trait = dragon
			add_trait = incapable_dragon
			add_friend = ROOT
			random = {
				chance = 5
				add_trait = fair_dragon
			}
			random = {
				chance = 5
				if = {
					limit = { NOT = { trait = fair_dragon } }
					add_trait = ugly_dragon
				}	
			}
			add_trait = strong_dragon
			random = {
				chance = 15
				add_trait = fertile_dragon
			}
			random_list = {
				1 = { add_trait = dragon_1 }
				1 = { add_trait = dragon_2 }
				1 = { add_trait = dragon_3 }
				1 = { add_trait = dragon_4 }
				1 = { add_trait = dragon_5 }
				1 = { add_trait = dragon_6 }
				1 = { add_trait = dragon_7 }
				1 = { add_trait = dragon_8 }
				1 = { add_trait = dragon_9 }
				1 = { add_trait = dragon_10 }
				1 = { add_trait = dragon_11 }
				1 = { add_trait = dragon_12 }
				1 = { add_trait = dragon_13 }
				1 = { add_trait = dragon_14 }
				1 = { add_trait = dragon_15 }
				1 = { add_trait = dragon_16 }
				1 = { add_trait = dragon_17 }
				1 = { add_trait = dragon_18 }
				1 = { add_trait = dragon_19 }
				1 = { add_trait = dragon_20 }
				1 = { add_trait = dragon_21 }
				1 = { add_trait = dragon_22 }
				1 = { add_trait = dragon_23 }
				1 = { add_trait = dragon_24 }
				1 = { add_trait = dragon_25 }
				1 = { add_trait = dragon_26 }
				1 = { #Balerion
					modifier = {
						factor = 0.05
					}
					add_trait = dragon_27 
				}
			}
			character_event = { id = dragon.599 }
			character_event = { id = dragon.0 }
		}
	}
	option = {
		name = EVTOPTEdragon.82 #disabled
		trigger = {
			OR = {
				graphical_culture = dragongfx
				has_game_rule = { name = dragon_hatching_taming value = off }
			}	
		}
		remove_trait = dragon_rider
	}	
}
###Random dragon flavour###
#Dragon is ravenous
# character_event = { #merged into yearly maintenance
	# id = dragon.83
	
	# is_triggered_only = yes
	
	# trigger = {
		# trait = dragon
		# NOT = { trait = ravenous_dragon }
		# NOT = { personality_traits = 2 }
	# }
	
	# immediate = {
		# add_trait = ravenous_dragon
		# random_friend = { character_event = { id = dragon.84 days = 2 } }
	# }
	
	# option = {
		# name = "OK" 
	# }
# }
#Inform dragon is ravenous
character_event = {
	id = dragon.84
	desc = "EVTDESCdragon.84"
	picture = "GFX_evt_drogon" 
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAdragon.84 #Good
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				trait = gluttonous
			}
			modifier = {
				factor = 5
				trait = slothful
			}
		}
		FROM = { 
			add_trait = ravenous_dragon
			change_martial = 2 
		}
	}
	
	option = {
		name = EVTOPTBdragon.84 #Beat and starve it
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				trait = temperate
			}
			modifier = {
				factor = 5
				trait = wroth
			}
		}
		FROM = { 
			remove_trait = ravenous_dragon
			random_list = {
				50 = {
					if = {
						limit = { 
							NOT = { trait = obedient_dragon } 
							NOT = { trait = wroth_dragon } 
						}
						add_trait = wroth_dragon
					}				
				}
				50 = {
					if = {
						limit = {
							NOT = { trait = shy_dragon }
						}
						add_trait = shy_dragon
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTCdragon.84 #soothe it
		trigger = { learning = 12 }
		ai_chance = {
			factor = 2
			modifier = {
				factor = 5
				trait = patient
			}
			modifier = {
				factor = 5
				trait = diligent
			}
		}
		tooltip_info = learning
		FROM = { 
			remove_trait = ravenous_dragon
			random_list = {
				50 = {
					if = {
						limit = { NOT = { trait = playful_dragon } }
						add_trait = playful_dragon
					}				
				}
				50 = {
					if = {
						limit = { 
							NOT = { trait = obedient_dragon } 
							NOT = { trait = wroth_dragon }
						}
						add_trait = obedient_dragon
					}
				}
			}
		}
	}
}
#Dragon is eating smallfolk's animals
character_event = {
	id = dragon.85
	
	is_triggered_only = yes
	
	trigger = { trait = dragon }
	
	immediate = {
		if = {
			limit = { any_friend = { is_ruler = yes } }
			random_friend = { character_event = { id = dragon.86 } }
			break = yes
		}
		location = { owner = { character_event = { id = dragon.87 } } }	
	}
	
	option = {
		name = "OK" 
	}
}
#My dragon is eating the smallfolk's livestock
character_event = {
	id = dragon.86
	desc = "EVTDESCdragon.86"
	picture = "GFX_evt_dragon_battle"
	
	is_triggered_only = yes
	
	trigger = { NOT = { FROM = { location = { has_province_modifier = peasants_upset } } } }

	option = {
		name = EVTOPTAdragon.86 #So?
		ai_chance = {
			factor = 1
			modifier = {
				factor = 4
				trait = greedy
			}
			modifier = {
				factor = 4
				trait = arbitrary
			}
			modifier = {
				factor = 4
				trait = ruthless
			}
			modifier = {
				factor = 4
				trait = cruel
			}
		}
		FROM = {
			location = {
				add_province_modifier = {
					name = peasants_upset
					duration = 365
				}
			}
		}	
	}
	
	option = {
		name = EVTOPTBdragon.86 #Recompense them
		ai_chance = {
			factor = 1
			modifier = {
				factor = 4
				trait = charitable
			}
			modifier = {
				factor = 4
				trait = just
			}
			modifier = {
				factor = 4
				trait = honorable
			}
			modifier = {
				factor = 4
				trait = kind
			}
		}
		wealth = -100
		piety = 50
	}
	
	option = {
		name = EVTOPTCdragon.86 #use diplomacy
		trigger = { diplomacy = 12 }
		ai_chance = {
			factor = 20
		}
		tooltip_info = diplomacy
		prestige = 25
	}
}

#A dragon in my province is eating the smallfolk's livestock
character_event = {
	id = dragon.87
	desc = "EVTDESCdragon.87"
	picture = "GFX_evt_dragon_battle"
	
	is_triggered_only = yes
	
	trigger = { NOT = { FROM = { location = { has_province_modifier = peasants_upset } } } }

	option = {
		name = EVTOPTAdragon.86 #So?
		ai_chance = {
			factor = 1
			modifier = {
				factor = 4
				trait = greedy
			}
			modifier = {
				factor = 4
				trait = arbitrary
			}
			modifier = {
				factor = 4
				trait = ruthless
			}
			modifier = {
				factor = 4
				trait = cruel
			}
		}
		FROM = {
			location = {
				add_province_modifier = {
					name = peasants_upset
					duration = 365
				}
			}
		}	
	}
	
	option = {
		name = EVTOPTBdragon.86 #Recompense them
		ai_chance = {
			factor = 1
			modifier = {
				factor = 4
				trait = charitable
			}
			modifier = {
				factor = 4
				trait = just
			}
			modifier = {
				factor = 4
				trait = honorable
			}
			modifier = {
				factor = 4
				trait = kind
			}
		}
		wealth = -75
		piety = 30
	}
	
	option = {
		name = EVTOPTCdragon.86 #use diplomacy
		trigger = { diplomacy = 12 }
		ai_chance = {
			factor = 20
		}
		tooltip_info = diplomacy
		prestige = 25
	}
	
	option = {
		name = EVTOPTDdragon.87 #I shall isolate it in the dragonpit
		trigger = {
			FROM = { 
				NOT = { any_friend = { can_use_dragon_abilities_trigger = yes } } 
				NOT = { has_character_modifier = locked_in_dragonpit }
			}
			OR = {
				is_adult = yes
				can_use_dragon_abilities_trigger = yes
			}
			NOT = { has_severe_disability_trigger = yes}
			in_command = no
			has_dragonpit_trigger = yes
		}
		ai_chance = {
			factor = 0.05
			modifier = {
				factor = 20
				can_use_dragon_abilities_trigger = yes
			}
			modifier = {
				factor = 0
				trait = craven
			}
			modifier = {
				factor = 2
				trait = brave
			}
		}	
		set_character_flag = capture_dragon
		FROM = { character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 days = 1 } }
	}
	option = {
		name = EVTOPTEdragon.87 #Send marshal to isolate it in the dragonpit
		trigger = {
			is_ruler = yes
			FROM = { 
				NOT = { any_friend = { can_use_dragon_abilities_trigger = yes } } 
				NOT = { has_character_modifier = locked_in_dragonpit }
			}
			job_marshal = {
				NOT = { has_severe_disability_trigger = yes}
			}	
			has_dragonpit_trigger = yes
		}
		ai_chance = {
			factor = 0.1
			modifier = {
				factor = 10
				job_marshal = { can_use_dragon_abilities_trigger = yes }
			}
		}	
		save_event_target_as = commanding_liege
		job_marshal = {
			character_event = { id = dragon.2398 tooltip = TOOLTIPdragon.2398 }
		}
	}
}
#Inform dragon is in pit
character_event = {
	id = dragon.88
	desc = EVTDESCdragon.88
	picture = "GFX_evt_dragon_angry"
	
	is_triggered_only = yes
	show_from_from = yes
	
	option = {
		name = EVTOPTAdragon.88
		prestige = 50
		FROM = {
			FROM = {
				add_character_modifier = {
					name = locked_in_dragonpit
					duration = -1
				}	
			}
		}
		event_target:commanding_liege = { character_event = { id = dragon.8899 } }
	}
}
character_event = {
	id = dragon.8899
	desc = EVTDESCdragon.8899
	picture = "GFX_evt_dragon_angry"
	
	is_triggered_only = yes

	option = {
		name = EVTOPTAdragon.88
		prestige = 50
		FROMFROMFROM = {
			add_character_modifier = {
				name = locked_in_dragonpit
				duration = -1
			}	
		}
	}
}
#Inform failed to put dragon in pit
character_event = {
	id = dragon.89
	desc = EVTDESCdragon.89
	picture = "GFX_evt_dragon_flame_death"
	
	is_triggered_only = yes
	show_from_from = yes

	option = {
		name = EVTOPTAdragon.89
		prestige = -25
		random_list = {
			5 = {
				add_maimed_trait_effect = yes
				hidden_tooltip = { remove_trait = wounded }
			}
			10 = {
				add_trait_silently_wounded_effect = yes
				hidden_tooltip = {
					character_event ={
						id = 38280 #Notify
					}
				}
			}	
			15 = {
				trigger = { NOT = { trait = burned } }
				add_trait = burned
				hidden_tooltip = { character_event = { id = trait_notification.23 } }					
			}
			70 = {
			}			
		}
		event_target:commanding_liege = { character_event = { id = dragon.8999 } }
	}
}
character_event = {
	id = dragon.8999
	desc = EVTDESCdragon.8999
	picture = "GFX_evt_dragon_flame_death"
	
	is_triggered_only = yes

	option = {
		name = EVTOPTAdragon.89
		prestige = -25
		FROMFROMFROM = { show_portrait = yes }
	}
}
###Dragon Nicknames###
#dragon.90
character_event = {
	id = dragon.90
	desc = "Much nickname very dragon wow" 
	
	min_age = 16
	is_triggered_only = yes
	hide_window = yes
	
	trigger = {	
		trait = dragon
		has_nickname = no
		martial = 50
	}
	
	option = {
		name = OK
		random_list = {
			50 = {
			}
			1 = {
				give_nickname = nick_colour
			}
			1 = {
				give_nickname = nick_colour_flame
			}
			1 = {
				give_nickname = nick_colour_fire
			}
			1 = {
				modifier = {
					factor = 0
					is_female = yes
				}
				give_nickname = nick_colour_king
			}
			1 = {
				modifier = {
					factor = 0
					is_female = no
				}
				give_nickname = nick_colour_queen
			}
			1 = {
				give_nickname = nick_colour_beast
			}
			1 = {
				give_nickname = nick_colour_whip
			}
			1 = {
				modifier = {
					factor = 0
					NOT = { prestige = 400 }
				}
				give_nickname = nick_colour_dread
			}
			1 = {
				give_nickname = nick_colour_scale
			}
			1 = {
				give_nickname = nick_colour_wing
			}
			1 = {
				modifier = {
					factor = 0
					NOR = {
						trait = wroth_dragon
						trait = lunatic_dragon
					}
				}
				give_nickname = nick_colour_fury
			}
			1 = {
				modifier = {
					factor = 0
					NOT = { trait = shy }
				}
				give_nickname = nick_colour_ghost
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_the_furious }
				}
				modifier = {
					factor = 0
					NOR = {
						trait = wroth_dragon
						trait = lunatic_dragon
					}
				}
				give_nickname = nick_the_furious
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_the_elusive }
				}
				modifier = {
					factor = 0
					NOT = { trait = shy_dragon }
				}
				give_nickname = nick_the_elusive
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_the_ghost }
				}
				modifier = {
					factor = 0
					NOT = { trait = shy_dragon }
				}
				give_nickname = nick_the_ghost
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_the_splendid }
				}
				modifier = {
					factor = 0
					NOT = { trait = fair_dragon }
				}
				give_nickname = nick_the_splendid
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_the_smouldering }
				}
				give_nickname = nick_the_smouldering
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_the_sly }
				}
				give_nickname = nick_the_sly
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_the_diabolical }
				}
				modifier = {
					factor = 0
					NOT = { prestige = 400 }
				}
				give_nickname = nick_the_diabolical
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_the_bloody }
				}
				modifier = {
					factor = 0
					NOT = { prestige = 400 }
				}
				give_nickname = nick_the_bloody
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_the_doombringer }
				}
				modifier = {
					factor = 0
					NOT = { prestige = 400 }
				}
				give_nickname = nick_the_doombringer
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_the_ravager }
				}
				modifier = {
					factor = 0
					NOT = { prestige = 400 }
				}
				give_nickname = nick_the_ravager
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_the_light_claw }
				}
				give_nickname = nick_the_light_claw
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_the_dark_eye }
				}
				give_nickname = nick_the_dark_eye
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_shadow }
				}
				modifier = {
					factor = 0
					NOR = {
						trait = dragon_1
						trait = dragon_7 
						trait = dragon_17
						trait = dragon_22
						trait = dragon_23
						trait = dragon_24
						trait = dragon_25
						trait = dragon_26
						trait = dragon_27
					}
				}
				give_nickname = nick_shadow
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_the_ravenous }
				}
				modifier = {
					factor = 0
					NOT = { trait = ravenous_dragon }
				}
				give_nickname = nick_the_ravenous
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_the_baleful }
				}
				modifier = {
					factor = 0
					NOT = { prestige = 400 }
				}
				give_nickname = nick_the_baleful
			}
			1 = {
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_the_lazy }
				}
				modifier = {
					factor = 0
					NOT = { trait = lazy_dragon }
				}
				give_nickname = nick_the_lazy
			}
			1 = { 
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_blazing_fire }
				}
				give_nickname = nick_blazing_fire 
			}
			1 = { 
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_shining_light}
				}
				modifier = {
					factor = 0
					NOR = {
						trait = dragon_3
						trait = dragon_5
						trait = dragon_6
						trait = dragon_9
						trait = dragon_10
						trait = dragon_11
						trait = dragon_12
						trait = dragon_14
						trait = dragon_16
						trait = dragon_19
						trait = dragon_21
					}
				}
				give_nickname = nick_shining_light 
			}
			1 = { 
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_shining_queen }
				}
				modifier = {
					factor = 0
					is_female = no
				}
				modifier = {
					factor = 0
					NOR = {
						trait = dragon_3
						trait = dragon_5
						trait = dragon_6
						trait = dragon_9
						trait = dragon_10
						trait = dragon_11
						trait = dragon_12
						trait = dragon_14
						trait = dragon_16
						trait = dragon_19
						trait = dragon_21
					}
				}
				give_nickname = nick_shining_queen 
			}
			1 = { 
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_destroyer }
				}
				modifier = {
					factor = 0
					NOT = { prestige = 400 }
				}
				give_nickname = nick_destroyer 
			}
			1 = { 
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_snake }
				}
				give_nickname = nick_snake 
			}
			1 = { 
				modifier = {
					factor = 0
					dragon = { is_alive = yes has_nickname = nick_blood_fire }
				}
				give_nickname = nick_blood_fire 
			}
		}
	}
}
#Inform dragon wounded
character_event = {
	id = dragon.91

	is_triggered_only = yes
	hide_window = yes
	
	trigger = {	
		trait = dragon
	}
	
	immediate = {
		FROM = { character_event = { id = dragon.92 } }
	}
	
	option = {
		name = OK
	}
}	
character_event = {
	id = dragon.92
	desc = "EVTDESCdragon.92"
	picture = "GFX_evt_dragon_angry" 
	
	is_triggered_only = yes

	option = {
		name = OK
		FROM = { add_trait = wounded_dragon }
	}
}
#Inform dragon maimed
character_event = {
	id = dragon.93

	is_triggered_only = yes
	hide_window = yes
	
	trigger = {	
		trait = dragon
	}
	
	immediate = {
		FROM = { character_event = { id = dragon.94 } }
	}
	
	option = {
		name = OK
	}
}	
character_event = {
	id = dragon.94
	desc = "EVTDESCdragon.94"
	picture = "GFX_evt_dragon_angry" 
	
	is_triggered_only = yes

	option = {
		name = EVTOPTAdragon.94
		FROM = { add_trait = maimed_dragon }
	}
}
#Special dragon egg location
province_event = {
	id = dragon.95

	hide_window = yes
	has_flag = special_dragon_egg
	
	trigger = {
		owner = { 
			NOT = { culture = ruin } 		
		}
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
	}
	
	mean_time_to_happen = {
		years = 1000
	}
	
	immediate = { owner = { narrative_event = { id = dragon.96 } } }

	option = {
		name = OK
	}
}
narrative_event = {
	id = dragon.96
	
	#Winterfell
	title = { 
		text = "EVTTITLEdragon.96"
		trigger = { FROM = { province_id = 47 } }
	}	
	desc = {
		text = "EVTDESCdragon.96"
		picture = "GFX_winterfell_crypt" 
		trigger = { FROM = { province_id = 47 } }
	}	
	#Sothoryos
	title = { 
		text = "EVTTITLEdragon.96B"
		trigger = { FROM = { province_id = 738 } }
	}	
	desc = {
		text = "EVTDESCdragon.96B"
		picture = "GFX_evt_dragon_riding_1"
		trigger = { FROM = { province_id = 738 } }
	}	
	#Red Lake
	title = { 
		text = "EVTTITLEdragon.96C"
		trigger = { FROM = { province_id = 236 } }
	}	
	desc = {
		text = "EVTDESCdragon.96C"
		picture = GFX_evt_fishing
		trigger = { FROM = { province_id = 236 } }
	}	
	
	is_triggered_only = yes
	
	trigger = {
		age = 8
		prisoner = no
		NOT = { trait = incapable }
		location = { province_id = FROM }
	}
	
	immediate = { FROM = { clr_province_flag = special_dragon_egg } }
	
	option = {
		name = "EVTOPTAdragon.96" 
		ai_chance = { 
			factor = 100
		}
		add_artifact = dragon_egg
		new_artifact = {
			save_event_target_as = new_dragon_egg
			set_artifact_flag = heirloom_@ROOT
		}
		prestige = 250
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_VERMAX_DRAGON_EGG
				picture = GFX_targaryen_eggs
			}
		}
		hidden_tooltip = {
			if = {
				limit = { FROM = { province_id = 47 } }
				dragon = { #Vermax
					limit = { character = 77990014 }
					event_target:new_dragon_egg = {
						set_artifact_flag = dragon_egg_mother_@PREV
						set_name = [Prev.GetDynamicDragonEggName]
					}
				}	
			}	
			if = {
				limit = { FROM = { province_id = 738 } }
				dragon = { #Terrax
					limit = { character = 77990500 }
					event_target:new_dragon_egg = {
						set_artifact_flag = dragon_egg_mother_@PREV
						set_name = [Prev.GetDynamicDragonEggName]
					}
				}	
			}
			if = {
				limit = { FROM = { province_id = 236 } }
				dragon = { #Silverwing
					limit = { character = 77990007 }
					event_target:new_dragon_egg = {
						set_artifact_flag = dragon_egg_mother_@PREV
						set_name = [Prev.GetDynamicDragonEggName]
					}
				}	
			}			
		}
		e_rebels = {
			persistent_event_target:chronicle_player = {
				if = {
					limit = {
						NOT = { character = ROOT }
						OR = {		
							dynasty = ROOT
							is_liege_or_above = ROOT
							is_close_relative = ROOT
							is_vassal_or_below = ROOT
						}
					}
					chronicle = {
						entry = CHRONICLE_VERMAX_DRAGON_EGG
						portrait = [Root.GetID]
					}
				}
			}
		}	
	}
	option = {
		name = "EVTOPTBdragon.96" #sell it
		ai_chance = { 
			factor = 1
			modifier = {
				factor = 0
				OR = {
					trait = proud
					trait = ambitious
					trait = envious
					trait = greedy
					any_owned_bloodline = { has_bloodline_flag = blood_of_the_dragon }
				}
			}
			modifier = {
				factor = 100
				NOT = { wealth = 0 }
			}
			modifier = {
				factor = 2
				NOT = { wealth = -100 }
			}
		}
		wealth = 750
	}
}

#Dany gets Eggs from Illyrio
character_event = {
	id = dragon.97
	desc = EVTDESCdragon.97
	picture = GFX_targaryen_eggs
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
	}
	
	option = {
		name = EVTOPTAdragon.97
		add_artifact = dragon_egg
		new_artifact = {
			set_artifact_flag = dany_dragon_eggs
			set_name = [Root.GetDanyDragonEggsName]
			set_artifact_flag = heirloom_@ROOT
		}
		prestige = 50
		FROM = { 
			opinion = { 
				who = ROOT 
				modifier = in_non_aggression_pact 
				years = 5 
			}
		}	
		hidden_tooltip = {
			if = {
				limit = { ai = no }
				chronicle = {
					entry = CHRONICLE_GIVEN_EGG
					picture = "GFX_targaryen_eggs"
				}
			}
		}
	}
}
character_event = { #Inform spouse
	id = dragon.98
	desc = EVTDESCdragon.98
	picture = GFX_targaryen_eggs
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAdragon.98
		FROM = { 
			opinion = { 
				who = ROOT 
				modifier = in_non_aggression_pact 
				years = 5 
			}
		}
		tooltip = {
			FROMFROMFROM = {
				tooltip = { show_portrait = yes }
				add_artifact = dragon_egg
			}
		}
	}
}
character_event = { #Illyrio chooses to give eggs, triggered from marriage
	id = dragon.99
	desc = EVTDESCdragon.99
	picture = GFX_targaryen_eggs
	
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = has_dany_dragon_eggs
		FROM = { character = 77041 }
	}
	
	option = {
		name = EVTOPTAdragon.99 #Yes
		ai_chance = {
			factor = 100
		}
		FROM = { 
			tooltip = { add_artifact = dragon_egg }
			opinion = {
				who = ROOT
				modifier = bestowed_dragon_egg
				years = 10
				multiplier = 3
			}
			opinion = { 
				who = ROOT 
				modifier = in_non_aggression_pact 
				years = 5 
			}
			hidden_tooltip = {
				character_event = { id = dragon.97 }
			}	
			spouse = { 
				if = {
					limit = { NOT = { character = ROOT } }
					opinion = { 
						who = ROOT 
						modifier = in_non_aggression_pact 
						years = 5 
					}
					hidden_tooltip = { character_event = { id = dragon.98 } }
				}	
			}		
		}
	}
	option = {
		name = EVTOPTBdragon.99 #Mine!
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				character = 600000040
			}
			modifier = {
				factor = 5
				trait = ambitious
			}
			modifier = {
				factor = 0
				trait = content
			}
			modifier = {
				factor = 0.2
				NOT = { trait = dragon_slayer }
				NOT = { trait = brave }
				NOT = { trait = genius }
				NOT = { trait = lunatic }
				NOT = { trait = ambitious }
				NOT = { trait = chosen_by_rhllor }
				NOR = {			
					culture = high_valyrian 
					graphical_culture = valyriangfx
				}
				NOT = { any_owned_bloodline = { has_bloodline_flag = blood_of_the_dragon } }
				NOT = { has_character_flag = demon_child_non_pagan }
				NOT = { 
					AND = {			
						OR = {
							culture_group = valyrian
							has_silver_hair_ethnicity_trigger = yes
						}
						OR = {
							religion_group = valyrian_rel_group
							has_character_modifier = abomination_of_incest
							location = { owner = { can_use_dragon_abilities_trigger = yes is_close_relative = ROOT } }
						}
					}
				}
			}
			modifier = {
				factor = 2
				NOT = { opinion = { who = FROM value = -80 } }
			}
			modifier = {
				factor = 1.5
				NOT = { opinion = { who = FROM value = -55 } }
			}
			modifier = {
				factor = 1.5
				NOT = { opinion = { who = FROM value = -30 } }
			}
			modifier = {
				factor = 0.66
				opinion = { who = FROM value = 0 }
			}
			modifier = {
				factor = 0.66
				opinion = { who = FROM value = 25 }
			}
			modifier = {
				factor = 0.66
				opinion = { who = FROM value = 50 }
			}
		}
		add_artifact = dragon_egg
		new_artifact = { set_artifact_flag = heirloom_@PREV }
		add_artifact = dragon_egg
		new_artifact = { set_artifact_flag = heirloom_@PREV }
		add_artifact = dragon_egg
		new_artifact = { set_artifact_flag = heirloom_@PREV }
	}
	
	after = { clr_character_flag = has_dany_dragon_eggs }
}

##Rename Dragon##
character_event = { #rename whip
	id = dragon.499
	desc = EVTDESCdragon.499
	
	is_triggered_only = yes
	hide_window = yes
	
	trigger = { trait = dragon }
	
	immediate = {
		persistent_event_target:whip = { set_name = [Root.GetDragonWhipName] }
	}
	
	option = {
		name = OK
	}
}	
# character_event = { #OLD EVENTS
	# id = dragon.499
	# desc = EVTDESCdragon.499
	# picture = GFX_valyria_dragon
	
	# is_triggered_only = yes
	
	# immediate = {
		# clear_event_target = new_dragon_name_1
		# clear_event_target = new_dragon_name_2
		# hidden_tooltip = { #create random dragons to get random names
			# e_rebels = {
				# holder_scope = {
					# if = {
						# limit = { FROM = { is_female = no } }
						# create_character = {
							# dynasty = actually_culture
							# age = 0
							# culture = dragon_culture
							# religion = dragon_rel
						# }
						# new_character = { 
							# save_event_target_as = new_dragon_name_1 
							# death = yes
						# }
						# # create_character = {
							# # dynasty = actually_culture
							# # age = 0
							# # culture = dragon_culture
							# # religion = dragon_rel
						# # }
						# # new_character = { 
							# # save_event_target_as = new_dragon_name_2 
							# # death = yes
						# # }
					# }
					# if = {
						# limit = { FROM = { is_female = yes } }
						# create_character = {
							# dynasty = actually_culture
							# age = 0
							# culture = dragon_culture
							# religion = dragon_rel
							# female = yes
						# }
						# new_character = { 
							# save_event_target_as = new_dragon_name_1 
							# death = yes
						# }
						# # create_character = {
							# # dynasty = actually_culture
							# # age = 0
							# # culture = dragon_culture
							# # religion = dragon_rel
							# # female = yes
						# # }
						# # new_character = { 
							# # save_event_target_as = new_dragon_name_2 
							# # death = yes
						# # }
					# }	
				# }
			# }	
		# }
	# }
	
	# option = {
		# name = EVTOPTAdragon.499
		# FROM = { 
			# copy_name = event_target:new_dragon_name_1
		# }
		# clr_character_flag = renaming_dragon
	# }
	# # option = {
		# # name = EVTOPTBdragon.499
		# # FROM = { 
			# # copy_name = event_target:new_dragon_name_2
		# # }
		# # clr_character_flag = renaming_dragon
	# # }
	# option = {
		# name = EVTOPTEdragon.499 #write own name
		# trigger = {
			# higher_tier_than = COUNT
		# }
		# custom_tooltip = {
			# text = TOOLTIPdragon.499OWNNAME
			# hidden_tooltip = {				
				# c_dragon_rename = { 
					# gain_title = ROOT
					# set_name = [From.GetFirstName] 
				# }
				# character_event = { id = dragon.498 days = 2 }
				# capital_scope = { province_event = { id = dragon.497 days = 3 } } #failsafe destroy title
			# }
		# }
	# }
	# option = {
		# name = EVTOPTCdragon.499
		# hidden_tooltip = { 
			# clear_event_target = new_dragon_name_1
			# clear_event_target = new_dragon_name_2
			# repeat_event = { id = dragon.499 } 
		# }
	# }
	# option = {
		# name = EVTOPTDdragon.499
		# clr_character_flag = renaming_dragon
	# }
# }
# character_event = {
	# id = dragon.498
	# desc = EVTDESCdragon.498
	# picture = GFX_valyria_dragon
	
	# is_triggered_only = yes
	# show_from_from = yes
	
	# immediate = { c_dragon_rename = { save_event_target_as = new_dragon_name } }
	
	# option = {
		# name = OK
		# FROMFROM = { set_name = [new_dragon_name.GetName] }
		# hidden_tooltip = { c_dragon_rename = { destroy_landed_title = yes } }
		# clr_character_flag = renaming_dragon
	# }
# }	
# province_event = { #failsafe destroy title
	# id = dragon.497
	
	# is_triggered_only = yes
	# hide_window = yes
	
	# immediate = { 
		# c_dragon_rename = {
			# activate_title = { title = THIS status = no }
			# unsafe_destroy_landed_title = THIS
			# destroy_landed_title = THIS
			# if = {
				# limit = { has_holder = yes }
				# create_character = {
					# random_traits = yes
					# dynasty = actually_culture
					# culture = ROOT
					# religion = ROOT
				# }
				# new_character = { 
					# gain_title = PREV
					# set_defacto_liege = THIS
					# death = yes
				# }
			# }	
			# if = {
				# limit = { has_holder = yes }
				# e_rebels = { holder_scope = { gain_title = PREVPREV } }
			# }	
		# }
	# }
	
	# option = {
		# name = OK
	# }
# }	
##Dragon trait events
#ravenous above dragon.84

#wroth
character_event = {
	id = dragon.100
	desc = "EVTDESCdragon.100"
	picture = "GFX_evt_dragon_angry" 
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAdragon.100 #Good
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				trait = wroth
			}
			modifier = {
				factor = 5
				trait = slothful
			}
		}
		FROM = { add_trait = wroth_dragon }
	}
	
	option = {
		name = EVTOPTBdragon.100 #Beat it
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				trait = cruel
			}
			modifier = {
				factor = 5
				trait = wroth
			}
			modifier = {
				factor = 0
				trait = kind
			}
		}
		FROM = { 
			random = {
				chance = 33
				remove_trait = wroth_dragon
				if = {
					limit = { NOT = { trait = shy_dragon } }
					random = {
						chance = 50
						add_trait = shy_dragon
					}	
				}				
			}
		}
	}
	
	option = {
		name = EVTOPTCdragon.100 #Try to calm it
		trigger = { NOT = { learning = 12 } }
		ai_chance = {
			factor = 1
			
			modifier = {
				factor = 5
				trait = patient
			}
			modifier = {
				factor = 5
				trait = diligent
			}
		}
		FROM = { 
			random = {
				chance = 33
				remove_trait = wroth_dragon
				if = {
					limit = { NOT = { trait = affectionate_dragon } }
					random = {
						chance = 50
						add_trait = affectionate_dragon
					}	
				}			
			}
		}
	}
	
	option = {
		name = EVTOPTDdragon.100 #soothe it
		trigger = { learning = 12 }
		ai_chance = {
			factor = 2
			modifier = {
				factor = 5
				trait = patient
			}
			modifier = {
				factor = 5
				trait = diligent
			}
		}
		tooltip_info = learning
		FROM = { 
			remove_trait = wroth_dragon
			random_list = {
				50 = {
					if = {
						limit = { NOT = { trait = playful_dragon } }
						add_trait = playful_dragon
					}				
				}
				50 = {
					if = {
						limit = { NOT = { trait = affectionate_dragon } }
						add_trait = affectionate_dragon
					}
				}
			}
		}
	}
}
#obedient
character_event = {
	id = dragon.105
	desc = "EVTDESCdragon.105"
	picture = "GFX_evt_dragon_riding_1" 
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAdragon.105 #Good
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				trait = patient
			}
			modifier = {
				factor = 5
				trait = diligent
			}
		}
		FROM = { add_trait = obedient_dragon }
	}
	
	option = {
		name = EVTOPTBdragon.105 #Beat it
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				trait = kind
			}
			modifier = {
				factor = 5
				trait = cruel
			}
			modifier = {
				factor = 5
				trait = wroth
			}
		}
		FROM = { 
			random = {
				chance = 33
				remove_trait = obedient_dragon
				random = {
					chance = 50
					add_trait = wroth_dragon
				}				
			}
		}
	}
}

#lazy
character_event = {
	id = dragon.110
	desc = "EVTDESCdragon.110"
	picture = "GFX_evt_dragon_angry" 
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAdragon.110 #IDC
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				trait = diligent
			}
			modifier = {
				factor = 5
				trait = slothful
			}
		}
		FROM = { add_trait = lazy_dragon }
	}
	
	option = {
		name = EVTOPTBdragon.110 #Beat it
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				trait = cruel
			}
			modifier = {
				factor = 5
				trait = wroth
			}
			modifier = {
				factor = 0
				trait = kind
			}
		}
		FROM = { 
			random = {
				chance = 33
				remove_trait = lazy_dragon
				if = {
					limit = { NOT = { trait = wroth_dragon } }
					random = {
						chance = 50
						add_trait = wroth_dragon
					}	
				}				
			}
		}
	}
	
	option = {
		name = EVTOPTCdragon.110 #Excercise it
		trigger = { 
			NOT = { learning = 12 } 
			NOT = { trait = wounded }
		}
		ai_chance = {
			factor = 1
			
			modifier = {
				factor = 5
				trait = patient
			}
			modifier = {
				factor = 5
				trait = diligent
			}
		}
		FROM = { 
			random = {
				chance = 33
				remove_trait = lazy_dragon
				change_martial = 2		
			}
		}
		random = {
			chance = 20
			add_trait_silently_wounded_effect = yes
			hidden_tooltip = {
				character_event ={
					id = 38280 #Notify
				}
			}
		}
	}
	
	option = {
		name = EVTOPTDdragon.110 #teach it
		trigger = { learning = 12 }
		ai_chance = {
			factor = 2
			modifier = {
				factor = 5
				trait = patient
			}
			modifier = {
				factor = 5
				trait = diligent
			}
		}
		tooltip_info = learning
		FROM = { 
			remove_trait = lazy_dragon
			change_martial = 1	
			if = {
				limit = { NOT = { trait = playful_dragon } }
				random = {
					chance = 50
					add_trait = playful_dragon					
				}
			}
		}
	}
}
#playful
character_event = {
	id = dragon.115	
	picture = "GFX_evt_dragons_flying" 
	
	desc = {
		text = "EVTDESCdragon.115"
		trigger = {
			dragon = {
				is_alive = yes
				same_realm = FROM
				NOT = { character = FROM }
			}
		}
	}	
	desc = {
		text = "EVTDESCdragon.115B"
		trigger = {
			NOT = {
				dragon = {
					is_alive = yes
					same_realm = FROM
					NOT = { character = FROM }
				}
			}	
		}
	}
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAdragon.115 #IDC
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.5
				trait = diligent
			}
			modifier = {
				factor = 5
				trait = gregarious
			}
			modifier = {
				factor = 5
				trait = trusting
			}
			modifier = {
				factor = 5
				trait = slothful
			}
			modifier = {
				factor = 5
				trait = content
			}
		}
		FROM = { add_trait = playful_dragon }
	}
	
	option = {
		name = EVTOPTBdragon.115 #Beat it
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				trait = cruel
			}
			modifier = {
				factor = 5
				trait = wroth
			}
			modifier = {
				factor = 5
				trait = ambitious
			}
			modifier = {
				factor = 0
				trait = kind
			}
		}
		FROM = { 
			random = {
				chance = 33
				remove_trait = playful_dragon				
			}
			if = {
				limit = { 
					NOT = { trait = wounded_dragon }
					NOT = { trait = maimed_dragon }
				}
				random = {
					chance = 25
					hidden_tooltip = { character_event = { id = dragon.91 } }
					add_trait = wounded_dragon
				}	
			}
		}
	}
	
	option = {
		name = EVTOPTCdragon.115 #Teach wariness
		trigger = { 
			NOT = { learning = 12 } 
		}
		ai_chance = {
			factor = 1
			
			modifier = {
				factor = 5
				trait = paranoid
			}
			modifier = {
				factor = 2
				trait = patient
			}
			modifier = {
				factor = 2
				trait = diligent
			}
		}
		FROM = { 
			random = {
				chance = 33
				remove_trait = playful_dragon
				if = {
					limit = { NOT = { trait = obedient_dragon } }
					random = {
						chance = 50
						add_trait = obedient_dragon					
					}
				}	
			}
		}
	}
	
	option = {
		name = EVTOPTDdragon.115 #teach it
		trigger = { learning = 12 }
		ai_chance = {
			factor = 2
			modifier = {
				factor = 5
				trait = paranoid
			}
			modifier = {
				factor = 2
				trait = patient
			}
			modifier = {
				factor = 2
				trait = diligent
			}
		}
		tooltip_info = learning
		FROM = { 
			remove_trait = playful_dragon
			if = {
				limit = { NOT = { trait = obedient_dragon } }
				random = {
					chance = 50
					add_trait = obedient_dragon			
				}
			}
		}
	}
}
#lunatic
character_event = {
	id = dragon.120
	desc = "EVTDESCdragon.120"
	picture = "GFX_evt_dragon_battle" 
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAdragon.120
		trigger = { NOT = { trait = lunatic } }
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				trait = wroth
			}
			modifier = {
				factor = 5
				trait = slothful
			}
			modifier = {
				factor = 5
				trait = content
			}
		}
		FROM = { add_trait = lunatic_dragon }
	}
	option = {
		name = EVTOPTBdragon.120 #soothe it
		trigger = { 
			learning = 12 
			NOT = { trait = lunatic }
		}
		ai_chance = {
			factor = 2
			modifier = {
				factor = 5
				trait = patient
			}
			modifier = {
				factor = 5
				trait = diligent
			}
		}
		tooltip_info = learning
		FROM = { 
			random = {
				chance = 50
				remove_trait = lunatic_dragon
				random_list = {
					50 = {
						if = {
							limit = { NOT = { trait = playful_dragon } }
							add_trait = playful_dragon
						}				
					}
					50 = {
						if = {
							limit = { NOT = { trait = affectionate_dragon } }
							add_trait = affectionate_dragon
						}
					}
				}
			}	
		}
	}
	option = {
		name = EVTOPTCdragon.120
		trigger = { trait = lunatic } 
		tooltip_info = lunatic
		prestige = 50
		FROM = { 
			add_trait = lunatic_dragon
			prestige = 50
		}
	}
}	
#affectionate
character_event = {
	id = dragon.125
	desc = "EVTDESCdragon.125"
	picture = "GFX_evt_dragon_riding_1" 
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAdragon.125 #IDC
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				trait = kind
			}
			modifier = {
				factor = 5
				trait = trusting
			}
			modifier = {
				factor = 5
				trait = patient
			}
			modifier = {
				factor = 5
				trait = content
			}
		}
		FROM = { add_trait = affectionate_dragon }
	}
	
	option = {
		name = EVTOPTBdragon.125 #Beat it
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				trait = cruel
			}
			modifier = {
				factor = 5
				trait = wroth
			}
			modifier = {
				factor = 5
				trait = ambitious
			}
			modifier = {
				factor = 5
				trait = paranoid
			}
			modifier = {
				factor = 0
				trait = kind
			}
		}
		FROM = { 
			random = {
				chance = 33
				remove_trait = affectionate_dragon	
				if = {
					limit = { NOT = { trait = wroth_dragon } }
					add_trait = wroth_dragon
				}				
			}
			
			if = {
				limit = { 
					NOT = { trait = wounded_dragon }
					NOT = { trait = maimed_dragon }
				}
				random = {
					chance = 25
					hidden_tooltip = { character_event = { id = dragon.91 } }
					add_trait = wounded_dragon
				}	
			}
		}
	}
}
#shy
character_event = {
	id = dragon.130
	desc = "EVTDESCdragon.130"
	picture = "GFX_valyria_dragon" 
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAdragon.130 #IDC
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.5
				trait = diligent
			}
			modifier = {
				factor = 5
				trait = shy
			}
			modifier = {
				factor = 5
				trait = paranoid
			}
			modifier = {
				factor = 5
				trait = slothful
			}
			modifier = {
				factor = 5
				trait = content
			}
		}
		FROM = { add_trait = shy_dragon }
	}
	
	option = {
		name = EVTOPTBdragon.130 #Beat it
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				trait = cruel
			}
			modifier = {
				factor = 5
				trait = wroth
			}
			modifier = {
				factor = 5
				trait = ambitious
			}
			modifier = {
				factor = 0
				trait = kind
			}
		}
		FROM = { 
			random = {
				chance = 33
				remove_trait = shy_dragon	
				if = {
					limit = { NOT = { trait = wroth_dragon } }
					random = {
						chance = 50
						add_trait = wroth_dragon				
					}
				}				
			}
			if = {
				limit = { 
					NOT = { trait = wounded_dragon }
					NOT = { trait = maimed_dragon }
				}
				random = {
					chance = 25
					hidden_tooltip = { character_event = { id = dragon.91 } }
					add_trait = wounded_dragon
				}	
			}
		}
	}
	
	option = {
		name = EVTOPTCdragon.130 #teach it
		trigger = { 
			NOT = { learning = 12 } 
		}
		ai_chance = {
			factor = 1
			
			modifier = {
				factor = 5
				trait = diligent
			}
			modifier = {
				factor = 5
				trait = gregarious
			}
			modifier = {
				factor = 5
				trait = patient
			}
		}
		FROM = { 
			random = {
				chance = 33
				remove_trait = shy_dragon
				if = {
					limit = { NOT = { trait = playful_dragon } }
					random = {
						chance = 50
						add_trait = playful_dragon			
					}
				}	
			}
		}
	}
	
	option = {
		name = EVTOPTDdragon.130 #teach it
		trigger = { learning = 12 }
		ai_chance = {
			factor = 2
			modifier = {
				factor = 5
				trait = diligent
			}
			modifier = {
				factor = 5
				trait = gregarious
			}
			modifier = {
				factor = 5
				trait = patient
			}
		}
		tooltip_info = learning
		FROM = { 
			remove_trait = shy_dragon
			if = {
				limit = { NOT = { trait = playful_dragon } }
				random = {
					chance = 50
					add_trait = playful_dragon			
				}
			}
		}
	}
}
#lose nimble
character_event = {
	id = dragon.135
	desc = "EVTDESCdragon.135"
	picture = "GFX_evt_dragon_riding_2" 
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAdragon.135
		FROM = { remove_trait = nimble_dragon }
	}
}	
#Wild dragon attacks another dragon
character_event = { #ping to dragon, attacker is FROM
	id = dragon.140

	is_triggered_only = yes
	
	option = {
		name = "FROM WINS"
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0.81
				attribute_diff = { character = FROM attribute = martial value = 5 }
			}			
			modifier = {
				factor = 1.5
				FROM = { attribute_diff = { character = ROOT attribute = martial value = 10 } }
			}
			modifier = {
				factor = 1.5
				FROM = { attribute_diff = { character = ROOT attribute = martial value = 20 } }
			}
			modifier = {
				factor = 1.5
				FROM = { attribute_diff = { character = ROOT attribute = martial value = 30 } }
			}
			modifier = {
				factor = 1.5
				FROM = { attribute_diff = { character = ROOT attribute = martial value = 40 } }
			}
			modifier = {
				factor = 1.5
				FROM = { attribute_diff = { character = ROOT attribute = martial value = 50 } }
			}
			modifier = {
				factor = 1.5
				FROM = { attribute_diff = { character = ROOT attribute = martial value = 60 } }
			}
			modifier = {
				factor = 1.5
				FROM = { attribute_diff = { character = ROOT attribute = martial value = 70 } }
			}
			modifier = {
				factor = 1.5
				FROM = { attribute_diff = { character = ROOT attribute = martial value = 80 } }
			}
			modifier = {
				factor = 1.5
				FROM = { attribute_diff = { character = ROOT attribute = martial value = 90 } }
			}
			
			modifier = {
				factor = 0.66
				trait = wroth_dragon
			}
			modifier = {
				factor = 0.66
				trait = lunatic_dragon
			}
			modifier = {
				factor = 0.66
				trait = nimble_dragon
			}
			modifier = {
				factor = 1.25
				trait = ravenous_dragon
			}
			modifier = {
				factor = 1.5
				trait = playful_dragon
			}
			
			modifier = {
				factor = 1.5
				FROM = { trait = wroth_dragon }
			}
			modifier = {
				factor = 1.5
				FROM = { trait = lunatic_dragon }
			}
			modifier = {
				factor = 1.5
				FROM = { trait = nimble_dragon }
			}
			modifier = {
				factor = 0.8
				FROM = { trait = ravenous_dragon }
			}
			modifier = {
				factor = 0.66
				FROM = { trait = playful_dragon }
			}
		}
		random_list = {
			50 = {
				modifier = {
					factor = 0
					OR = {
						trait = wounded_dragon
						trait = maimed_dragon
					}					
				}				
				add_trait = wounded_dragon
				hidden_tooltip = { 
					character_event = { id = dragon.91 } 
					any_player = {
						limit = {
							OR = {
								is_friend = ROOT
								is_vassal_or_below = ROOT
								is_friend = FROM
								is_vassal_or_below = FROM
							}
						}
						character_event = { id = dragon.141 } 
					}
				}
			}
			25 = {
				modifier = {
					factor = 0
					trait = maimed_dragon				
				}			
				add_trait = maimed_dragon
				hidden_tooltip = { 
					remove_trait = wounded_dragon
					character_event = { id = dragon.93 }
					any_player = {
						limit = {
							OR = {
								is_friend = ROOT
								is_vassal_or_below = ROOT
								is_friend = FROM
								is_vassal_or_below = FROM
							}
						}
						character_event = { id = dragon.141 } 
					}
				}
			}
			25 = {
				hidden_tooltip = { 
					any_player = {
						character_event = { id = dragon.142 } 
					}
				}
				FROM = {
					location = {
						add_province_modifier = {
							name = peasants_scared_of_dragon
							duration = 365
						}
					}
				}	
				death = {
					death_reason = death_dragon
					killer = FROM
				}
			}
		}
		FROM = {
			random_list = {
				70 = {
				}
				25 = {
					modifier = {
						factor = 0
						OR = {
							trait = wounded_dragon
							trait = maimed_dragon
						}					
					}
					hidden_tooltip = { character_event = { id = dragon.91 } }
					add_trait = wounded_dragon
				}
				5 = {
					modifier = {
						factor = 0
						trait = maimed_dragon				
					}
					hidden_tooltip = { 
						remove_trait = wounded_dragon
						character_event = { id = dragon.93 }
					}
					add_trait = maimed_dragon
				}				
			}
		}
	}
	option = {
		name = "ROOT WINS"
		ai_chance = {
			factor = 75
		}
		random_list = {
			70 = {
			}
			25 = {
				modifier = {
					factor = 0
					OR = {
						trait = wounded_dragon
						trait = maimed_dragon
					}					
				}
				hidden_tooltip = { character_event = { id = dragon.91 } }
				add_trait = wounded_dragon
			}
			5 = {
				modifier = {
					factor = 0
					trait = maimed_dragon				
				}
				hidden_tooltip = { 
					remove_trait = wounded_dragon
					character_event = { id = dragon.93 }
				}
				add_trait = maimed_dragon
			}				
		}
		FROM = {
			random_list = {
				70 = {
				}
				25 = {
					modifier = {
						factor = 0
						OR = {
							trait = wounded_dragon
							trait = maimed_dragon
						}					
					}
					hidden_tooltip = { character_event = { id = dragon.91 } }
					add_trait = wounded_dragon
				}
				5 = {
					modifier = {
						factor = 0
						trait = maimed_dragon				
					}
					hidden_tooltip = { 
						remove_trait = wounded_dragon
						character_event = { id = dragon.93 }
					}
					add_trait = maimed_dragon
				}				
			}
		}
		any_player = {
			limit = {
				OR = {
					is_friend = ROOT
					is_vassal_or_below = ROOT
					is_friend = FROM
					is_vassal_or_below = FROM
				}
			}
			character_event = { id = dragon.143 } 
		}
	}
}	
#Inform attacker injured dragon
character_event = {
	id = dragon.141
	desc = "EVTDESCdragon.141"
	picture = "GFX_evt_dragon_duel" 
	
	is_triggered_only = yes
	show_from_from = yes
	
	option = {
		name = EVTOPTAdragon.141
		ai_chance = {
			factor = 2
		}
		tooltip = {
			FROM = { 
				if = {
					limit = { trait = wounded_dragon }
					add_trait = wounded_dragon
				}
				if = {
					limit = { trait = maimed_dragon }
					add_trait = maimed_dragon
				}
			}
		}	
		FROM = { 
			tooltip = { show_portrait = yes } 
		}
	}
	
	option = {
		name = EVTOPTBdragon.141 #I shall isolate it in the dragonpit
		trigger = {
			is_ruler = yes
			FROMFROM = { 
				NOT = { any_friend = { can_use_dragon_abilities_trigger = yes } } 
				location = { owner = { character = ROOT } }
			}
			OR = {
				is_adult = yes
				can_use_dragon_abilities_trigger = yes
			}
			NOT = { has_severe_disability_trigger = yes }
			in_command = no
			has_dragonpit_trigger = yes
		}
		ai_chance = {
			factor = 0.05
			modifier = {
				factor = 20
				can_use_dragon_abilities_trigger = yes
			}
			modifier = {
				factor = 0
				trait = craven
			}
			modifier = {
				factor = 2
				trait = brave
			}
		}	
		set_character_flag = capture_dragon
		FROMFROM = { character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 days = 1 } }
	}
}	
#Inform attacker killed dragon
character_event = {
	id = dragon.142
	desc = "EVTDESCdragon.142"
	picture = "GFX_evt_dragon_duel_death" 
	
	is_triggered_only = yes
	show_from_from = yes
	
	option = {
		name = EVTOPTAdragon.142
		ai_chance = {
			factor = 2
		}
		tooltip = {
			FROMFROM = {
				location = {
					add_province_modifier = {
						name = peasants_scared_of_dragon
						duration = 365
					}
				}
			}
		}
		FROM = { 
			tooltip = { show_portrait = yes } 
		}
	}
	option = {
		name = EVTOPTBdragon.142 #I shall isolate it in the dragonpit
		trigger = {
			is_ruler = yes
			FROMFROM = { 
				NOT = { any_friend = { can_use_dragon_abilities_trigger = yes } } 
				location = { owner = { character = ROOT } }
			}
			OR = {
				is_adult = yes
				can_use_dragon_abilities_trigger = yes
			}
			NOT = { has_severe_disability_trigger = yes }
			in_command = no
			has_dragonpit_trigger = yes
		}
		ai_chance = {
			factor = 0.05
			modifier = {
				factor = 20
				can_use_dragon_abilities_trigger = yes
			}
			modifier = {
				factor = 0
				trait = craven
			}
			modifier = {
				factor = 2
				trait = brave
			}
		}	
		set_character_flag = capture_dragon
		FROMFROM = { character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 days = 1 } }
	}
}	
#Inform attacker failed to beat dragon
character_event = {
	id = dragon.143
	desc = "EVTDESCdragon.143"
	picture = "GFX_evt_dragon_duel" 
	
	is_triggered_only = yes
	show_from_from = yes
	
	option = {
		name = EVTOPTAdragon.143
		ai_chance = {
			factor = 2
		}
		FROM = { 
			tooltip = { show_portrait = yes } 
		}
	}
	option = {
		name = EVTOPTBdragon.143 #I shall isolate it in the dragonpit
		trigger = {
			is_ruler = yes
			FROMFROM = { 
				NOT = { any_friend = { can_use_dragon_abilities_trigger = yes } } 
				location = { owner = { character = ROOT } }
			}
			OR = {
				is_adult = yes
				can_use_dragon_abilities_trigger = yes
			}
			NOT = { has_severe_disability_trigger = yes }
			in_command = no
			has_dragonpit_trigger = yes
		}
		ai_chance = {
			factor = 0.05
			modifier = {
				factor = 20
				can_use_dragon_abilities_trigger = yes
			}
			modifier = {
				factor = 0
				trait = craven
			}
			modifier = {
				factor = 2
				trait = brave
			}
		}	
		set_character_flag = capture_dragon
		FROMFROM = { character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 days = 1 } }
	}
}	
#Dragons become lovers
character_event = {
	id = dragon.145

	is_triggered_only = yes
	
	option = {
		name = OK
		add_lover = FROM
		any_player = {
			limit = {
				OR = {
					is_friend = ROOT
					is_vassal_or_below = ROOT
					is_friend = FROM
					is_vassal_or_below = FROM
				}
			}
			character_event = { id = dragon.146 } 
		}
	}
}	
character_event = { #inform
	id = dragon.146
	desc = "EVTDESCdragon.146"
	picture = "GFX_evt_dragons_flying" 
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAdragon.146
		FROMFROM = { 
			tooltip = { show_portrait = yes } 
			tooltip = { add_lover = ROOT_FROM }
		}
	}
}	
#Dragon released from dragonpit (triggered from dragon.8 and decision)
character_event = { 
	id = dragon.150
	desc = "EVTDESCdragon.150"
	picture = "GFX_evt_dragons_flying" 
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAdragon.150
		FROM = {
			location = {
				add_province_modifier = {
					name = peasants_scared_of_dragon
					duration = 365
				}
				hidden_tooltip = {
					any_province_lord = {
						limit = { 
							ai = no 
							NOT = { character = ROOT } 
						}
						character_event = { id = dragon.151 }
					}
				}
			}
		}	
	}
}
character_event = { #inform
	id = dragon.151
	desc = "EVTDESCdragon.151"
	picture = "GFX_evt_dragons_flying" 
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAdragon.151
		tooltip = {
			FROMFROM = { 
				remove_character_modifier = locked_in_dragonpit	
				location = {
					add_province_modifier = {
						name = peasants_scared_of_dragon
						duration = 365
					}
				}	
			}
		}	
	}
}	
#Dragon is enraged locked in dragonpit
character_event = {
	id = dragon.155
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { any_friend = { always = yes } }
			random_friend = { character_event = { id = dragon.156 } }
			break = yes
		}
		location = { owner = { character_event = { id = dragon.156 } } }	
	}
	
	option = {
		name = "OK" 
	}
}
character_event = {
	id = dragon.156
	desc = "EVTDESCdragon.156"
	picture = "GFX_evt_dragon_battle"
	
	is_triggered_only = yes
	capable_only = yes
	prisoner = no
	min_age = 8
	
	option = {
		name = EVTOPTAdragon.156 #nothing we can do
		ai_chance = {
			factor = 3
			
			modifier = {
				factor = 4
				trait = just
			}
			modifier = {
				factor = 4
				trait = diligent
			}
			modifier = {
				factor = 4
				trait = cruel
			}
		}
		FROM = {
			if = {
				limit = { trait = wounded_dragon }
				random = {
					chance = 33
					hidden_tooltip = { 
						remove_trait = wounded_dragon
						character_event = { id = dragon.93 }
					}
					add_trait = maimed_dragon
				}	
			}
			if = {
				limit = { 
					NOT = { trait = wounded_dragon }
					NOT = { trait = maimed_dragon }
				}
				hidden_tooltip = { character_event = { id = dragon.91 } }
				add_trait = wounded_dragon
			}
		}	
	}
	
	option = {
		name = EVTOPTBdragon.156 #Release
		ai_chance = {
			factor = 1
			modifier = {
				factor = 4
				trait = arbitrary
			}
			modifier = {
				factor = 4
				trait = lunatic
			}
			modifier = {
				factor = 4
				trait = kind
			}
			modifier = {
				factor = 4
				trait = erudite
			}
		}
		FROM = {
			remove_character_modifier = locked_in_dragonpit	
			location = {
				add_province_modifier = {
					name = peasants_scared_of_dragon
					duration = 365
				}
			}
		}
	}
	
	option = {
		name = EVTOPTCdragon.156 #soothe it
		trigger = { learning = 10 }
		ai_chance = {
			factor = 50
		}
		tooltip_info = learning
		prestige = 25
	}
}
#Dragon added to child's crib/bed
character_event = {
	id = dragon.160
	desc = "EVTDESCdragon.160"
	picture = "GFX_targaryen_eggs" 
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTdragon.160"	
		hidden_tooltip = {
			FROM = {
				random_list = { #chance of hatching within 2 years
					95 = {
						character_event = { id = dragon.162 days = 470 random = 250 }
					}			
					5 = {
						modifier = { #wait for stronger dragon?
							factor = 0.1
							has_global_flag = age_of_dragons
							OR = {
								is_primary_heir = yes
								trait = ambitious
								trait = willful
							}	
							NOT = { trait = content }
							NOT = { trait = timid }
						}
						modifier = {
							factor = 6
							OR = {
								culture_group = valyrian
								has_silver_hair_ethnicity_trigger = yes
								high_valyrian_dynasty_trigger = yes
								has_character_flag = demon_child_non_pagan
							}	
						}
						modifier = {
							factor = 2
							religion_group = valyrian_rel_group 
						}
						modifier = {
							factor = 5
							has_global_flag = age_of_dragons
						}
						modifier = {
							factor = 2
							trait = genius
						}
						modifier = {
							factor = 1.5
							is_smart_trigger = yes
						}
						modifier = {
							factor = 0.33
							trait = imbecile
						}
						modifier = {
							factor = 0.66
							is_dumb_trigger = yes
						}
						character_event = { id = dragon.161 days = 470 random = 250 }
					}
				}	
			}	
		}
	}
}
character_event = { #hatched
	id = dragon.161
	desc = "EVTDESCdragon.161"
	picture = "GFX_targaryen_eggs" 
	
	is_triggered_only = yes
	
	trigger = {
		has_artifact = dragon_egg
		prisoner = no
		is_incapable = no
		NOT = { any_friend = { trait = dragon } }
	}
	
	immediate = {
		random_list = {
			50 = {
				create_character = {
					dynasty = actually_culture
					age = 0
					culture = dragon_culture
					religion = dragon_rel
					historical = yes
				}
			}
			50 = {
				create_character = {
					female = yes
					dynasty = actually_culture
					age = 0
					culture = dragon_culture
					religion = dragon_rel
					historical = yes
				}
			}
		}
		new_character = {
			add_friend = ROOT
			add_trait = dragon
			add_trait = incapable_dragon
			character_event = { id = dragon.599 }
			save_event_target_as = new_dragon
			set_character_flag = tamed_dragon #easier to tame
			random = {
				chance = 5
				modifier = {
					factor = 5
					ROOT = { trait = fair }
				}
				add_trait = fair_dragon
			}
			random = {
				chance = 5
				modifier = {
					factor = 10
					ROOT = { trait = ugly }
				}
				if = {
					limit = { NOT = { trait = fair_dragon } }
					add_trait = ugly_dragon
				}	
			}
			if = {
				limit = {
					ROOT = { 
						has_dragonpit_trigger = yes	
					} 
				}
				add_character_modifier = { name = locked_in_dragonpit duration = -1 }
				random = {
					chance = 8
					modifier = {
						factor = 5
						ROOT = { trait = sickly }
					}
					add_trait = sickly_dragon
				}
				if = {
					limit = { NOT = { trait = sickly_dragon } }
					random = {
						chance = 2
						modifier = {
							factor = 20
							ROOT = { trait = strong }
						}
						add_trait = strong_dragon
					}
					random = {
						chance = 15
						add_trait = fertile_dragon
					}
				}
			}
			if = {
				limit = {
					NOT = { has_character_modifier = locked_in_dragonpit }
				}
				random = {
					chance = 2
					add_trait = sickly_dragon
				}
				if = {
					limit = { NOT = { trait = sickly_dragon } }
					random = {
						chance = 5
						add_trait = strong_dragon
					}
					random = {
						chance = 15
						add_trait = fertile_dragon
					}
				}
			}
			random = {
				chance = 33
				add_trait = nimble_dragon
			}
			random_list = {
				1 = { add_trait = dragon_1 }
				1 = { add_trait = dragon_2 }
				1 = { add_trait = dragon_3 }
				1 = { add_trait = dragon_4 }
				1 = { add_trait = dragon_5 }
				1 = { add_trait = dragon_6 }
				1 = { add_trait = dragon_7 }
				1 = { add_trait = dragon_8 }
				1 = { add_trait = dragon_9 }
				1 = { add_trait = dragon_10 }
				1 = { add_trait = dragon_11 }
				1 = { add_trait = dragon_12 }
				1 = { add_trait = dragon_13 }
				1 = { add_trait = dragon_14 }
				1 = { add_trait = dragon_15 }
				1 = { add_trait = dragon_16 }
				1 = { add_trait = dragon_17 }
				1 = { add_trait = dragon_18 }
				1 = { add_trait = dragon_19 }
				1 = { add_trait = dragon_20 }
				1 = { add_trait = dragon_21 }
				1 = { add_trait = dragon_22 }
				1 = { add_trait = dragon_23 }
				1 = { add_trait = dragon_24 }
				1 = { add_trait = dragon_25 }
				1 = { add_trait = dragon_26 }
				1 = { #Balerion
					modifier = {
						factor = 0.05
					}
					add_trait = dragon_27 
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTdragon.161"	
		random_friend = {
			limit = { trait = dragon }
			tooltip = { show_portrait = yes }
		}
		if = {
			limit = {
				NAND = {
					age = 12
					NOT = { has_dynasty_flag = dragon_riding_dynasty }
				}	
			}
			prestige = 250
		}
		if = {
			limit = {
				age = 12
				NOT = { has_dynasty_flag = dragon_riding_dynasty }
			}
			prestige = 1000
			random = {
				chance = 50
				hidden_tooltip = { remove_trait = content }
				add_trait = ambitious
				hidden_tooltip = {
					character_event = {
						id = 38278 #Notify Ambitious
					}
				}
			}	
		}
		set_character_flag = dragon_intel_eggs
	}
}
character_event = { #no hatch
	id = dragon.162
	desc = "EVTDESCdragon.162"
	picture = "GFX_targaryen_eggs" 
	
	is_triggered_only = yes
	
	trigger = {
		has_artifact = dragon_egg
		NOT = { any_friend = { trait = dragon } }
	}
	
	option = {
		name = "EVTOPTdragon.162" #bad omen
		prestige = -50
		hidden_tooltip = {
			any_playable_ruler = {
				limit = {
					ai = no
					NOT = { character = ROOT }
					is_close_relative = ROOT
				}
				character_event = { id = dragon.163 }
			}
		}
	}	
}	
character_event = { #no hatch
	id = dragon.163
	desc = "EVTDESCdragon.163"
	picture = "GFX_targaryen_eggs" 
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTdragon.163" #bad omen
		tooltip = { FROM = { prestige = -50 } }
	}	
}	
##Ruler calls for dragon riders
character_event = { 
	id = dragon.170
	desc = "EVTDESCdragon.170"
	picture = "GFX_evt_dragons_flying" 
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTdragon.170"
		hidden_tooltip = {
			any_realm_lord = {
				limit = { 
					OR = {
						ai = no 
						liege = { character = ROOT }
					}							
				}
				character_event = { id = dragon.171 }
			}
			any_current_enemy = {
				limit = { ai = no }
				character_event = { id = dragon.171 }
			}
			#chance of previously unknowns taming dragons
			random = {
				chance = 15
				modifier = {
					factor = 5
					capital_scope = { culture_group = valyrian }
				}
				character_event = { id = dragon.172 days = 10 random = 5 }
			}
			random = {
				chance = 15
				modifier = {
					factor = 5
					capital_scope = { culture_group = valyrian }
				}
				character_event = { id = dragon.172 days = 40 random = 20 }
			}
		}
	}	
}	
character_event = { #inform
	id = dragon.171
	desc = "EVTDESCdragon.171"
	picture = "GFX_evt_dragons_flying" 
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTdragon.171"
	}
}
#Unknown tames dragon
character_event = {
	id = dragon.172	
	picture = "GFX_evt_dragon_riding_1"
	
	is_triggered_only = yes
	only_rulers = yes
	
	desc = {
		text = "EVTDESCdragon.172"
		trigger = { capital_scope = { NOT = { culture_group = valyrian } } }
	}	
	desc = {
		text = "EVTDESCdragon.172B"
		trigger = { capital_scope = { culture_group = valyrian } }
	}
	
	trigger = {
		dragon = {
			is_alive = yes
			location = { 
				owner = { character = ROOT } 
				OR = {
					culture_group = valyrian
					NOT = { has_game_rule = { name = dragon_hatching_taming value = valyrian_only } }
				}
			}
			OR = {
				NOT = { educator = { always = yes } } 
				location = { any_province_lord = { is_liege_of = PREVPREV } }
			}
			NOT = { any_friend = { always = yes is_alive = yes } }
			NOT = { has_character_flag = dany_dragon }
			NOT = { trait = shy_dragon }
			NOT = { trait = lunatic_dragon }
			NOT = { has_character_flag = shadow_lands_dragon }
			OR = {
				NOT = { has_character_flag = found_wild_dragon }
				had_character_flag = { flag = found_wild_dragon days = 30 }
			}	
			is_ruler = no
			NOT = { liege = { graphical_culture = dragongfx } }			
		}
	}
	
	immediate = {
		dragon = {
			limit = {
				is_alive = yes
				location = { 
					owner = { character = ROOT } 
					OR = {
						culture_group = valyrian
						NOT = { has_game_rule = { name = dragon_hatching_taming value = valyrian_only } }
					}
				}
				OR = {
					NOT = { educator = { always = yes } } 
					location = { any_province_lord = { is_liege_of = PREVPREV } }
				}
				NOT = { any_friend = { always = yes is_alive = yes } }
				NOT = { has_character_flag = dany_dragon }
				NOT = { trait = shy_dragon }
				NOT = { trait = lunatic_dragon }
				NOT = { has_character_flag = shadow_lands_dragon }
				OR = {
					NOT = { has_character_flag = found_wild_dragon }
					had_character_flag = { flag = found_wild_dragon days = 30 }
				}
				is_ruler = no
				NOT = { liege = { graphical_culture = dragongfx } }				
			}	
			set_character_flag = found_wild_dragon
			save_event_target_as = dragon_seed_dragon
			location = {
				ROOT = {
					random_list = {
						20 = {
							create_character = {
								random_traits = yes
								dynasty = none
								female = no
								culture = PREV
								religion = PREV
							}						
						}
						10 = {
							create_character = {
								random_traits = yes
								dynasty = none
								female = no
								culture = PREV
								religion = PREV
								age = 70
							}						
						}
						10 = {
							create_character = {
								random_traits = yes
								dynasty = none
								female = no
								culture = PREV
								religion = PREV
								age = 64
							}						
						}
						10 = {
							create_character = {
								random_traits = yes
								dynasty = none
								female = no
								culture = PREV
								religion = PREV
								age = 26
							}						
						}
						10 = {
							create_character = {
								random_traits = yes
								dynasty = none
								female = no
								culture = PREV
								religion = PREV
								age = 22
							}						
						}
						10 = {
							create_character = {
								random_traits = yes
								dynasty = none
								female = no
								culture = PREV
								religion = PREV
								age = 18
							}						
						}
						10 = {
							create_character = {
								random_traits = yes
								dynasty = none
								female = no
								culture = PREV
								religion = PREV
								age = 14
							}						
						}
						
						#female
						8 = {
							create_character = {
								random_traits = yes
								dynasty = none
								female = yes
								culture = PREV
								religion = PREV
							}						
						}
						2 = {
							create_character = {
								random_traits = yes
								dynasty = none
								female = no
								culture = PREV
								religion = PREV
								age = 71
							}						
						}
						2 = {
							create_character = {
								random_traits = yes
								dynasty = none
								female = no
								culture = PREV
								religion = PREV
								age = 52
							}						
						}
						2 = {
							create_character = {
								random_traits = yes
								dynasty = none
								female = no
								culture = PREV
								religion = PREV
								age = 35
							}						
						}
						2 = {
							create_character = {
								random_traits = yes
								dynasty = none
								female = no
								culture = PREV
								religion = PREV
								age = 17
							}						
						}
						2 = {
							create_character = {
								random_traits = yes
								dynasty = none
								female = no
								culture = PREV
								religion = PREV
								age = 13
							}						
						}
						2 = {
							create_character = {
								random_traits = yes
								dynasty = none
								female = no
								culture = PREV
								religion = PREV
								age = 11
							}						
						}
					}
					new_character = {
						save_event_target_as = dragon_seed
						set_character_flag = found_wild_dragon
						remove_trait = slow
						remove_trait = imbecile
						remove_trait = dull
						
						remove_trait = socializer
						remove_trait = gamer
						remove_trait = hunter
						remove_trait = strategist
						remove_trait = administrator
						remove_trait = architect
						remove_trait = gardener
						remove_trait = schemer
						remove_trait = seducer
						remove_trait = seductress
						remove_trait = theologian
						
						random_list = {
							5 = {
								modifier = {
									factor = 0
									is_smart_incl_genius_trigger = yes
								}
								add_trait = quick
							}
							5 = {
								modifier = {
									factor = 0
									is_smart_incl_genius_trigger = yes
								}
								add_trait = shrewd
							}
							5 = {
								add_trait = genius
							}
							10 = {
								add_trait = strong
							}
							10 = {
								add_trait = tall
							}
							10 = {
								add_trait = mystic
							}
							
						}
						random_list = {
							10 = {
								remove_trait = craven
								add_trait = brave
							}
							10 = {
								remove_trait = content
								add_trait = ambitious
							}
							10 = {
								remove_trait = slothful
								add_trait = diligent
							}
							10 = {
								add_trait = authoritative
							}
							10 = {
								remove_trait = cynical
								add_trait = zealous
							}
						}
						random_list = {
							20 = { }
							20 = { add_trait = poor_warrior }
							40 = { add_trait = trained_warrior }
							20 = { add_trait = skilled_warrior }
						}
						if = {
							limit = { 
								culture_group = hyrkoon_group	
							}
							add_trait = eunuch
						}
						if = {
							limit = { 
								ROOT = { trait = nightswatch }
							}
							add_trait = nightswatch
						}	
						if = {
							limit = { 
								has_knighthood_religion_trigger = yes
								is_female = no
							}
							random = {
								chance = 25
								knight_character_effect = yes
							}
						}
					}
				}
			}
			
		}
	}
	
	option = {
		name = "EVTOPTdragon.172"
		event_target:dragon_seed = {
			add_trait = dragon_rider
			add_friend = event_target:dragon_seed_dragon
			move_character = ROOT
			tooltip = { show_portrait = yes }
			if = {
				limit = { 
					is_female = no
					OR = {
						has_knighthood_religion_trigger = yes
						culture_group = andal
					}	
					NOT = { trait = knight }
				}
				knight_character_effect = yes
			}
			prestige = 200
		}
		event_target:dragon_seed_dragon = {
			tooltip = { show_portrait = yes }
			hidden_tooltip = {
				character_event = { id = dragon.173 }
			}
		}
	}	
}
character_event = { #dragon must be in FROMFROM scope
	id = dragon.173
	
	is_triggered_only = yes
	hide_window = yes
	
	immediate = { character_event = { id = dragon.174 } }
	
	option = {
		name = OK
	}	
}
character_event = {
	id = dragon.174
	
	is_triggered_only = yes
	hide_window = yes
	
	immediate = { 
		event_target:dragon_seed = {
			set_character_flag = tamed_dragon
			character_event = { id = dragon.14 } 
		}	
	}
	
	option = {
		name = OK
	}	
}
#Dragon rider forced concubine escapes
character_event = {
	id = dragon.180
	
	is_triggered_only = yes
	hide_window = yes
	only_women = yes
	prisoner = no
	min_age = 14
	capable_only = yes
	
	trigger = {
		is_consort = yes
		can_use_dragon_abilities_trigger = yes
		any_friend = {
			trait = dragon
			NOT = { trait = maimed_dragon }
		}
		consort = { 
			reverse_has_opinion_modifier = { who = ROOT modifier = opinion_forced_consort } 
			NAND = { #do not escape if lovers and not ambitious
				is_lover = ROOT
				ROOT = { NOT = { trait = ambitious } }
			}
		}
		NOT = { trait = slave } #can escpae via plot
	}
	
	weight_multiplier = {
		factor = 1
		modifier = {
			factor = 3
			wealth = 100
		}
		modifier = {
			factor = 6
			trait = ambitious
		}
		modifier = {
			factor = 4
			trait = brave
		}
		modifier = {
			factor = 4
			trait = proud
		}
		modifier = {
			factor = 4
			trait = chosen_by_rhllor
		}
		modifier = {
			factor = 4
			has_character_flag = demon_child_non_pagan
		}
		
		modifier = {
			factor = 0.05
			trait = content
		}
		modifier = {
			factor = 0.2
			trait = craven
		}
		modifier = {
			factor = 0.2
			trait = humble
		}
		modifier = {
			factor = 0.15
			has_severe_disability_trigger = yes
		}
		
		modifier = {
			factor = 0.5
			consort = { reverse_opinion = { who = ROOT value = 50 }	}	
		}
		modifier = {
			factor = 0.65
			consort = { reverse_opinion = { who = ROOT value = 40 }	}
		}
		modifier = {
			factor = 0.65
			consort = { reverse_opinion = { who = ROOT value = 20 }	}
		}
		modifier = {
			factor = 1.5
			consort = { NOT = { reverse_opinion = { who = ROOT value = -19 } } }
		}
		modifier = {
			factor = 1.5
			consort = { NOT = { reverse_opinion = { who = ROOT value = -39 } } }
		}
		modifier = {
			factor = 1.5
			consort = { NOT = { reverse_opinion = { who = ROOT value = -59 } } }
		}
		modifier = {
			factor = 1.5
			consort = { NOT = { reverse_opinion = { who = ROOT value = -79 } } }
		}
		modifier = {
			factor = 1.5
			consort = { NOT = { reverse_opinion = { who = ROOT value = -99 } } }
		}
	}
	
	immediate = {
		remove_trait = salt_wife
		clr_character_flag = no_court_invites
		consort = { 
			save_event_target_as = old_consort
			remove_consort = ROOT
			character_event = { id = dragon.181 days = 1 } 
		}
		any_playable_ruler = {
			limit = { 
				ai = no 
				is_close_relative = ROOT
				NOT = { character = event_target:old_consort }
			}
			character_event = { id = slavery.182 days = 1 }
		}	
		##Escape##
		random_friend = { #try to move to dragons location
			limit = {
				trait = dragon
				liege = {
					higher_tier_than = BARON
					valid_exile_destination_ROOT_trigger = yes
				}
			}
			liege = {
				ROOT = { move_character = PREV }
				character_event = { id = slavery.183 days = 1 }	
				break = yes	
			}
		}
		random_playable_ruler = {
			limit = { #Try and find closely related dynast
				dynasty = ROOT
				is_close_relative = ROOT
				valid_exile_destination_ROOT_trigger = yes
			}
			ROOT = { move_character = PREV }
			character_event = { id = slavery.183 days = 1 }	
			break = yes			
		}
		random_playable_ruler = {
			limit = { #Try and find dynast
				dynasty = ROOT
				NOT = { dynasty = 0 }
				valid_exile_destination_ROOT_trigger = yes
			}
			ROOT = { move_character = PREV }
			character_event = { id = slavery.183 days = 1 }	
			break = yes		
		}	
		random_playable_ruler = {
			limit = { #Try and find same culture/religion
				culture_group = ROOT
				religion = ROOT
				valid_exile_destination_ROOT_trigger = yes
			}
			ROOT = { move_character = PREV }
			character_event = { id = slavery.183 days = 1 }	
			break = yes	
		}
		random_playable_ruler = {
			limit = { #If still havent found destination move somewhere random
				valid_exile_destination_ROOT_trigger = yes
			}
			ROOT = { move_character = PREV }
			character_event = { id = slavery.183 days = 1 }	
			break = yes	
		}
	}
	
	option = {
		name = OK
	}
}	
character_event = { #inform consort
	id = dragon.181
	desc = EVTDESCdragon.181
	picture = "GFX_evt_dragon_riding_1"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTdragon.181"
		prestige = -50
	}
}
character_event = { #inform family
	id = dragon.182
	desc = EVTDESCdragon.182
	picture = "GFX_evt_dragon_riding_1"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTdragon.182"
		event_target:old_consort = { show_portrait = yes }
	}
}
character_event = { #inform new liege
	id = dragon.183
	desc = EVTDESCdragon.183
	picture = "GFX_evt_dragon_riding_1"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTdragon.183"
		event_target:old_consort = { show_portrait = yes }
	}
}
#Unlanded dragon rider/KG ambition seeks new liege? (triggered from dragon.8 and obj_become_kingsguard)
character_event = {
	id = dragon.190

	is_triggered_only = yes
	#hide_window = yes
	capable_only = yes
	prisoner = no
	
	trigger = {
		is_ruler = no
		in_command = no
		is_ill = no
		
		can_press_claims_trigger = yes
		NOT = { trait = infirm }
		NOT_mythical_creature_trigger = yes
		
		NOT = { trait = content }
		NOT = { liege = { regent = { character = PREVPREV } } }
		is_primary_heir = no
		liege = {
			NOT = { is_friend = ROOT }
			NOT = { is_married = ROOT }
			NOT = { any_consort = { character = ROOT } }
			NOT = { is_lover = ROOT }
			NAND = {
				leads_faction = faction_claimant
				supported_claimant = { character = ROOT }
			}
			NAND = {
				OR = {
					is_close_relative = ROOT
					dynasty = ROOT
				}	
				OR = {
					ROOT = { trait = familyperson }
					reverse_opinion = { who = ROOT value = -25 }
				}	
				ROOT = { 
					NOT = { trait = ambitious } 
					NOT = { has_ambition = obj_become_kingsguard }
				}
			}
			NAND = {
				reverse_opinion = { who = ROOT value = 30 }
				ROOT = { 
					OR = {
						is_voter = yes
						is_councillor = yes
						trait = honorable
					}
					NOT = { trait = ambitious } 
				}
			}
		}	
		NOT = { has_character_modifier = planning_claimant_adventure }
		NOT = { is_inaccessible_trigger = yes }
		OR = {
			NOT = { has_character_flag = promoted_to_new_court }
			had_character_flag = { flag = promoted_to_new_court days = 1825 }
		}		
	}
	
	immediate = {
		if = {
			limit = {
				has_ambition = obj_become_kingsguard 
			}
			e_iron_throne = {
				holder_scope = {
					if = {
						limit = {
							NAND = {
								ROOT = { trait = zealous }
								NOT = { religion = ROOT }
							}
							NOT = { is_liege_of = ROOT }
							reverse_opinion = { who = ROOT value = -50 }
							NOT = { is_rival = ROOT }
							NOT = { is_foe = ROOT }
							NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_rejected_service } }
							is_within_diplo_range = ROOT
						}
						save_event_target_as = prospective_new_liege
					}	
				}
			}
		}
		else = {		
			random_playable_ruler = {
				limit = {
					age = 16
					prisoner = no
					is_incapable = no
					demesne_size = 1
					NAND = {
						ROOT = { trait = zealous }
						NOT = { religion = ROOT }
					}
					OR = {
						tier = KING
						ROOT = { liege = { NOT = { higher_tier_than = PREVPREV } } }
					}
					NOT = { is_liege_of = ROOT }
					reverse_opinion = { who = ROOT value = -25 }
					NOT = { is_rival = ROOT }
					NOT = { is_foe = ROOT }
					NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_rejected_service } }
					wealth = 25
					is_within_diplo_range = ROOT
					
					OR = {
						is_close_relative = ROOT
						is_friend = ROOT
						is_married = ROOT
						is_lover = ROOT
						AND = {
							reverse_opinion = { who = ROOT value = 30 }
							OR = {
								religion = ROOT
								culture_group = ROOT
								higher_tier_than = DUKE
							}
						}	
					}
				}
				save_event_target_as = prospective_new_liege
			}
		}	
	}
	
	option = {
		name = MOVE
		trigger = { event_target:prospective_new_liege = { always = yes } }
		ai_chance = {
			factor = 15
			modifier = {
				factor = 0.5
				liege = { is_nomadic = yes culture = ROOT } #clan loyalty
			}
			modifier = {
				factor = 2
				liege = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_unrewarded } }
			}		
			modifier = {
				factor = 5
				trait = ambitious
			}
			modifier = {
				factor = 2
				is_councillor = no
				NOT = { is_voter = yes }
			}
			modifier = {
				factor = 2
				OR = {
					has_ambition = obj_become_castellan
					has_ambition = obj_become_chancellor
					has_ambition = obj_become_marshal
					has_ambition = obj_become_treasurer
					has_ambition = obj_become_spymaster
				}
			}
			modifier = {
				factor = 0.33
				liege = { religion_group = ROOT }
				NOT = { religion_group = event_target:prospective_new_liege }
			}
			modifier = {
				factor = 0.33
				liege = { culture_group = ROOT }
				NOT = { culture_group = event_target:prospective_new_liege }
			}
			
			modifier = {
				factor = 0.66
				liege = { ROOT = { is_child_of = PREV } }
			}
			modifier = {
				factor = 0.66
				liege = { is_close_relative = ROOT }
			}
			modifier = {
				factor = 0.66
				liege = { dynasty = ROOT }
			}
			modifier = {
				factor = 1.5
				is_child_of = event_target:prospective_new_liege
			}
			modifier = {
				factor = 1.5
				is_close_relative = event_target:prospective_new_liege
			}
			modifier = {
				factor = 1.5
				dynasty = event_target:prospective_new_liege
			}
			
			modifier = {
				factor = 2
				trait = envious
			}	
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 2
				trait = wroth
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 0.5
				trait = patient
			}
			modifier = {
				factor = 1.5
				NOT = { opinion = { who = liege value = -99 } }
			}
			modifier = {
				factor = 1.5
				NOT = { opinion = { who = liege value = -74 } }
			}
			modifier = {
				factor = 1.5
				NOT = { opinion = { who = liege value = -49 } }
			}
			modifier = {
				factor = 1.5
				NOT = { opinion = { who = liege value = -24 } }
			}
			modifier = {
				factor = 0.66
				opinion = { who = liege value = 25 }
			}
			modifier = {
				factor = 0.66
				opinion = { who = liege value = 50 }
			}
			modifier = {
				factor = 0.66
				opinion = { who = liege value = 75 }
			}
			modifier = {
				factor = 0.66
				opinion = { who = liege value = 100 }
			}
			
			modifier = {
				factor = 1.5
				opinion = { who = event_target:prospective_new_liege value = 25 }
			}
			modifier = {
				factor = 1.5
				opinion = { who = event_target:prospective_new_liege value = 50 }
			}
			modifier = {
				factor = 1.5
				opinion = { who = event_target:prospective_new_liege value = 75 }
			}
			modifier = {
				factor = 1.5
				opinion = { who = event_target:prospective_new_liege value = 100 }
			}
		}
		event_target:prospective_new_liege = { letter_event = { id = 73558 } }
	}
	option = {
		name = NO
		ai_chance = {
			factor = 85
		}
	}
}
#Use dragonhorn to tame dragon
character_event = { 
	id = dragon.195
	desc = EVTDESCdragon.195
	picture = "GFX_evt_dragonhorn"
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { FROMFROM = { trait = dragon } }
			FROMFROM = { save_event_target_as = tamed_dragon }
		}
		else = {
			random_friend = {
				limit = {
					trait = dragon
					age = 2
				}
				save_event_target_as = tamed_dragon
			}
		}	
		random_artifact = {
			limit = {
				has_artifact_flag = dragonhorn
				is_artifact_active = yes
			}
			save_event_target_as = my_dragonhorn
		}
		if = {
			limit = { is_ruler = yes }
			random_courtier_or_vassal = { #volunteer
				limit = { 
					ai = yes
					liege = { character = ROOT }
					is_adult = yes
					prisoner = no
					is_incapable = no
					NOT = { is_inaccessible_trigger = yes }
					opinion = { who = ROOT value = 50 }
					NOT = { any_heir_title = { always = yes } }
					OR = {
						trait = lunatic
						trait = brave
						trait = zealous
						trait = depressed
					}
					NOT = { trait = craven }
					NOT = { trait = cynical }
					NOT = { trait = ambitious }
					NOT = { can_use_dragon_abilities_trigger = yes }
					NOT_mythical_creature_trigger = yes
				}
				save_event_target_as = dragonhorn_volunteer
			}
			random_courtier = { #prisoner
				limit = { 
					host = { character = ROOT }
					age = 12
					prisoner = yes
					is_incapable = no
					NOT = { is_close_relative = ROOT }
					NOT = { reverse_opinion = { who = ROOT value = 0 } }
					NOT_mythical_creature_trigger = yes
				}
				save_event_target_as = dragonhorn_prisoner
			}
			random_courtier = { #slave
				limit = { 
					ai = yes
					liege = { character = ROOT }
					age = 12
					trait = slave
					is_incapable = no
					NOT = { reverse_opinion = { who = ROOT value = 25 } }
					NOT_mythical_creature_trigger = yes
				}
				save_event_target_as = dragonhorn_slave
			}
		}
		if = {
			limit = { intrigue = 10 }
			random_courtier = { #trick victim
				limit = { 
					age = 14
					NOT = { learning = 4 }
					OR = {											
						is_dumb_trigger = yes
						trait = imbecile
						trait = inbred
						trait = trusting
					}
					NOT = { trait = paranoid }
					prisoner = no
					is_incapable = no
					NOT = { is_inaccessible_trigger = yes }
					NOT = { is_close_relative = ROOT }
					NOT = { reverse_opinion = { who = ROOT value = 0 } }
					NOT_mythical_creature_trigger = yes
				}
				save_event_target_as = dragonhorn_trick
			}
		}	
	}
	
	option = {
		name = "EVTOPTAdragon.195" #Loyal courtier
		trigger = {
			event_target:dragonhorn_volunteer = { always = yes }
		}
		show_portrait = event_target:dragonhorn_volunteer
		set_character_flag = dragonhorn_volunteer
		event_target:dragonhorn_volunteer = { 			
			character_event = { id = dragon.196 tooltip = TOOLTIPdragon.196A }
		}
	}
	option = {
		name = "EVTOPTBdragon.195" #Prisoner
		trigger = {
			event_target:dragonhorn_prisoner = { always = yes }
		}
		show_portrait = event_target:dragonhorn_prisoner
		set_character_flag = dragonhorn_prisoner
		event_target:dragonhorn_prisoner = { 		
			character_event = { id = dragon.196 tooltip = TOOLTIPdragon.196B }
		}
	}
	option = {
		name = "EVTOPTCdragon.195" #Slave
		trigger = {
			event_target:dragonhorn_slave = { always = yes }
		}
		show_portrait = event_target:dragonhorn_slave
		set_character_flag = dragonhorn_slave
		event_target:dragonhorn_slave = { 		
			character_event = { id = dragon.196 tooltip = TOOLTIPdragon.196C }
		}
	}
	option = {
		name = "EVTOPTDdragon.195" #Self
		trigger = {
			immortal = yes
		}
		tooltip_info = yes
		set_character_flag = dragonhorn_self
		character_event = { id = dragon.197 tooltip = TOOLTIPdragon.197B }
	}
	option = {
		name = "EVTOPTEdragon.195" #Trick someone
		trigger = {
			event_target:dragonhorn_trick = { always = yes }
		}
		tooltip_info = intrigue
		show_portrait = event_target:dragonhorn_trick
		set_character_flag = dragonhorn_trick
		event_target:dragonhorn_trick = { 			
			character_event = { id = dragon.196 tooltip = TOOLTIPdragon.196D }
		}
	}
	option = {
		name = "EVTOPTFdragon.195" #Pay for a captive
		if = {
			limit = { is_ruler = yes }
			scaled_wealth = { value = -0.25 min = -25 max = -150 }
		}
		else = { wealth = -25 }
		prestige = -50
		set_character_flag = dragonhorn_captive
		character_event = { id = dragon.197 tooltip = TOOLTIPdragon.197C }
	}
}
long_character_event = { #ping to horn blower
	id = dragon.196	
	picture = "GFX_evt_dragonhorn"
	
	desc = {
		text = EVTDESCdragon.196A
		trigger = { prisoner = yes }
	}	
	desc = {
		text = EVTDESCdragon.196B #tricked
		trigger = { prisoner = no }
	}	
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.196"
		show_portrait = event_target:tamed_dragon
		hidden_tooltip = { FROM = { character_event = { id = dragon.197 } } } 
		tooltip = {
			FROM = { add_trait = dragon_rider }
			death = yes
		}
	}	
}	
long_character_event = { #horn blowed
	id = dragon.197
	picture = "GFX_evt_dragonhorn"
	
	desc = {
		text = EVTDESCdragon.197A
		trigger = { has_character_flag = dragonhorn_volunteer }
	}	
	desc = {
		text = EVTDESCdragon.197B
		trigger = { has_character_flag = dragonhorn_prisoner }
	}
	desc = {
		text = EVTDESCdragon.197C
		trigger = { has_character_flag = dragonhorn_slave }
	}
	desc = {
		text = EVTDESCdragon.197D
		trigger = { has_character_flag = dragonhorn_self }
	}
	desc = {
		text = EVTDESCdragon.197E
		trigger = { has_character_flag = dragonhorn_trick }
	}
	desc = {
		text = EVTDESCdragon.197F
		trigger = { has_character_flag = dragonhorn_captive }
	}
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.197"
		if = {
			limit = { has_character_flag = dragonhorn_prisoner }
			if = { #execution consequences
				limit = {
					NOR = {
						FROM = { just_execution_reason_PREV_trigger = yes }
						war_with = FROM
						FROM = { any_liege = { war_with = ROOT } }
						NOT = { same_realm = FROM }
						FROM = { #excludes owned slaves
							trait = slave
							has_opinion_modifier = { who = ROOT modifier = opinion_my_owner }
						}
					}
				}
				set_character_flag = unjust_execution					
				if = {
					limit = { FROM = { is_ruler = no } }	
					change_variable = { which = "tyrant" value = 5 }
				}
				if = {
					limit = { FROM = { is_ruler = yes } }
					change_variable = { which = "tyrant" value = 10 } 						
				}
				hidden_tooltip = { character_event = { id = maintenance.1 } }#tyrant trait	
			}
			if = { #If this was a just execution remove all loans
				limit = { 
					NOT = { has_character_flag = unjust_execution } 
					FROM = {
						has_character_flag = given_personal_loan
						persistent_event_target:loan_title = {
							holder_scope = {
								character = ROOT
							}
						}
					}
				}
				FROM = { 
					clr_character_flag = given_personal_loan
					remove_opinion = { who = ROOT modifier = opinion_liege_loan }
					remove_character_modifier = liege_loan
				}
			}
			FROM = { 
				add_fear_execution_effect = yes
				hidden_tooltip = { character_event = { id = 154 } } #On executed				
			}
		}	
		FROM = {
			if = {
				limit = { NOT = { character = ROOT } }
				death = {
					death_reason = death_dragonhorn
					killer = ROOT
				}
			}	
		}
		if = {
			limit = { has_character_flag = dragonhorn_self }
			random_list = {
				50 = { }
				25 = {
					trigger = { NOT = { trait = stressed } }
					add_trait = stressed
					hidden_tooltip = { character_event = { id = 38282 } }
				}
				15 = {
					trigger = { NOT = { trait = fire_obsessed } }
					add_trait = fire_obsessed
					hidden_tooltip = { character_event = { id = trait_notification.2 } }
				}
				10 = {
					trigger = { NOT = { trait = lunatic } }
					add_trait = lunatic 
					hidden_tooltip = { character_event = { id = 38304 }  }
				}
			}				
		}
		add_trait = dragon_rider
		if = { #Check for new dragon riding dynasty
			limit = {
				NOT = { dynasty = 0 }
				NOT = { has_dynasty_flag = dragon_riding_dynasty }
				dynasty_head = { character = ROOT }
			}
			set_dynasty_flag = dragon_riding_dynasty
		}
		show_portrait = event_target:tamed_dragon
		top_liege = {		
			if = {
				limit = { #If same culture as top liege give weak claim on that title		
					culture_group = ROOT
					NOT = { character = ROOT }
					primary_title = { NOT = { ROOT = { has_claim = PREV } } }
				}
				primary_title = { add_weak_claim = ROOT }
			}		
		}
		if = {
			limit = {
				NOT = { 
					any_liege = { 
						OR = {
							tier = EMPEROR
							can_use_dragon_abilities_trigger = yes 
						}	
					} 
				}
				demesne_size = 1
				NOT = { tier = BARON }
				independent = no
				is_patrician = no
			}
			set_defacto_liege = ROOT
			#set_character_flag = new_dragon_lord
		}	
		set_immune_to_pruning = yes
		hidden_tooltip = { event_target:tamed_dragon = { character_event = { id = dragon.1499 } } }
	}	
	after = {
		clr_character_flag = dragonhorn_volunteer
		clr_character_flag = dragonhorn_prisoner
		clr_character_flag = dragonhorn_slave
		clr_character_flag = dragonhorn_self
		clr_character_flag = dragonhorn_trick 
		clr_character_flag = dragonhorn_captive
	}
}	
#Ai character with tame dragon ambition searches for dragon to tame
character_event = {
	id = dragon.200

	is_triggered_only = yes
	hide_window = yes
	ai = yes
	min_age = 14
	capable_only = yes
	prisoner = no
	
	trigger = {
		has_ambition = obj_tame_a_dragon
		NOT = { any_friend = { trait = dragon } }
		wealth = 0
		NOT = { is_inaccessible_trigger = yes }
		NOT = { has_character_flag = dany_no_tame_dragon }
		NOT = { in_battle = yes }
		NOT = { has_severe_disability_trigger = yes }
		is_ill = no
		NOT = { has_game_rule = { name = dragon_hatching_taming value = off } }
	}
	
	immediate = {
		dragon = {
			limit = {
				is_alive = yes
				NOT = { distance = { who = ROOT value = 750 } }
				NOT = { num_of_friends = 1 }
				NOT = { has_character_flag = dany_dragon }
				OR = {
					AND = {
						NOT = { trait = shy_dragon }
						NOT = { has_character_flag = shadow_lands_dragon }
					}
					has_character_modifier = locked_in_dragonpit
				}
				OR = {
					NOT = { has_character_flag = found_wild_dragon }
					had_character_flag = { flag = found_wild_dragon days = 30 }
				}	
				is_ruler = no
				NOT = { liege = { graphical_culture = dragongfx } }
				location = {
					owner = {
						OR = {
							same_realm = ROOT
							ROOT = { intrigue = 10 }
						}
						OR = {
							character = ROOT
							custom_tooltip = {
								text = TOOLTIPface_dragon_decOWNER
								hidden_tooltip = {
									NOR = { 
										can_use_dragon_abilities_trigger = yes
										has_dynasty_flag = dragon_riding_dynasty
										PREVPREV = { has_character_modifier = locked_in_dragonpit }
									}
								}	
							}	
							AND = {
								NOT = { dynasty = 0 }
								dynasty = ROOT
							}	
							is_close_relative = ROOT
							is_liege_or_above = ROOT
							AND = {
								has_character_modifier = calling_for_dragon_riders
								is_liege_of = ROOT
								ROOT = { NOT = { tier = KING } }
								opinion = { who = ROOT value = -24 }
								reverse_opinion = { who = ROOT value = -24 }
							}
							ROOT = {
								show_scope_change = no
								custom_tooltip = {
									text = TOOLTIPface_dragon_decDRAGONHORN
									hidden_tooltip = {							
										any_artifact = {
											has_artifact_flag = dragonhorn
											is_artifact_active = yes
										}
									}
								}	
							}
						}
					}
				}
			}	
			ROOT = { 
				set_character_flag = found_wild_dragon 
				wealth = -10
			}
			set_character_flag = found_wild_dragon
			character_event = { id = dragon.2698 tooltip = TOOLTIPdragon.2698 }
		}	
	}
	
	option = {
		name = OK
	}
}	